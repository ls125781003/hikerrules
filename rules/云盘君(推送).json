{"last_chapter_rule":"","pageList":[{"col_type":"movie_3","name":"规则列表","path":"data","rule":"var wrapu = (u) => {\n    if (config.mode == \"本地转码\") {\n        return 'hiker://page/push?url=hiker://empty##' + encodeURIComponent(u) + '???fypage'\n    }\n    if (/aliyundrive/.test(u)) {\n        const [link, _share_pwd] = u.split('?share_pwd=');\n        const [_link, _folderID] = link.split('/folder/');\n        let share_pwd = (_share_pwd || '').split('#name=')[0] || '';\n        let shareId = _link.split('com/s/')[1];\n        return 'smartdrive://share/browse?shareId=' + shareId + '&sharePwd=' + share_pwd;\n    }\n    return \"web://\" + u;\n};\n\nvar checkali = (realurl) => {\n    try {\n        let shareId = realurl.split(\"com/s/\")[1].substring(0, 11);\n        if (realurl.includes(\"com/s/\") && realurl != \"\") {\n            let share = fetch(\"https://api.aliyundrive.com/adrive/v3/share_link/get_share_by_anonymous\", {\n                headers: {\n                    'content-type': 'application/json',\n                    \"User-Agent\": PC_UA,\n                    \"Referer\": \"https://www.aliyundrive.com/\"\n                },\n                body: {\n                    \"share_id\": shareId\n                },\n                method: 'POST'\n            });\n            if (share.includes(\"share_link is\") || share.includes(\"share_link cannot\")) return false;\n        }\n    } catch (e) {}\n    return true;\n}\n\nlet rules = [{\n        name: \"云盘资源\",\n        page: true,\n        find: function(s, page) {\n            let url = \"https://res.yunpan.win/?PageIndex=\" + page + \"&PageSize=12&Keyword=\" + s + \"&Type=&Tag=\";\n            let html = request(url, {\n                headers: {\n                    \"Referer\": \"https://res.yunpan.win/\"\n                }\n            });\n\n            let arr = pdfa(html, \"main&&.card\");\n            //log(arr);\n            let d = [];\n            for (let i = 0; i < arr.length; i++) {\n                let it = arr[i];\n                let u = pdfh(it, \".card-link,1&&onclick\").match(/https:\\/\\/(www\\.aliyundrive\\.com\\/s|alywp\\.net|www\\.alipan\\.com\\/s)\\/\\w*/g) || [];\n                u = u.length > 0 ? u[0] : url;\n                d.push({\n                    title: pdfh(it, \".card-title&&Text\"),\n                    pic_url: pd(it, \"img&&src\", url),\n                    //url: 'hiker://page/detail?rule=云盘汇影&url=' + u + '??fypage',\n                    //url: 'hiker://page/push?url=hiker://empty##' + encodeURIComponent(u) + '???fypage',\n                    url: wrapu(u),\n                    desc: \"““””<font color=#f13b66a>云盘资源</font>&nbsp;\" + (pdfh(it, \".card-text,-1&&Text\")) + \"\\n\" + (u),\n                });\n            }\n            return d;\n        }\n    }, {\n        name: \"UP云搜\",\n        page: true,\n        find: function(s, page) {\n            let url = \"https://upapi.juapp9.com/search?keyword=\" + s + \"&page=\" + page + \"&s_type=1\";\n            let html = request(url, {\n                headers: {\n                    \"Accept\": \"*//*\",\n                    \"Referer\": \"https://www.upyunso.com/\",\n                    \"Origin\": \"https://www.upyunso.com\"\n                }\n            });\n            //log(base64Decode(html));\n            let arr = JSON.parse(base64Decode(html)).result.items;\n            //log(arr);\n            let d = [];\n            for (let i = 0; i < arr.length; i++) {\n                let it = arr[i];\n                let u = it.page_url;\n                //u = u.length > 0 ? u[0] : url;\n                if (!/aliyundrive|alipan/.test(u)) {\n                    continue;\n                }\n                d.push({\n                    title: it.title,\n                    //url: 'hiker://page/detail?rule=云盘汇影&url=' + u + '??fypage',\n                    //url: 'hiker://page/push?url=hiker://empty##' + encodeURIComponent(u) + '???fypage',\n                    url: wrapu(u),\n                    desc: \"““””<font color=#f13b66a>UP云搜</font>&nbsp;\" + \"\\n\" + (u),\n                });\n\n            }\n            return d;\n        }\n    }, {\n        name: \"猫狸盘搜\",\n        page: false,\n        find: function(s, page) {\n            let html = request(\"https://www.alipansou.com/search?k=\" + s, {\n                headers: {\n                    \"Referer\": \"https://www.alipansou.com/search?k=\" + s\n                }\n            });\n            let arr = pdfa(html, \"#app&&a\");\n            //log(arr);\n            let d = [];\n            for (let i = 0; i < arr.length; i++) {\n                let it = \"<div>\" + arr[i] + \"</div>\";\n                let u = pdfh(it, \"a&&href\");\n                //log(u);\n                if (!u.includes(\"/s/\")) {\n                    continue;\n                }\n                u = \"https://www.alipansou.com\" + u.replace(\"/s/\", \"/cv/\");\n                d.push({\n                    title: pdfh(it, \"template&&Text\"),\n                    url: $(u).lazyRule((wrapu) => {\n                        let html = request(input, {\n                            headers: {\n                                \"Cookie\": \"no_show_donate=1\",\n                                \"Referer\": input.replace(\"/cv/\", \"/s/\")\n                            },\n                            redirect: false\n                        });\n                        html = parseDomForHtml(html, 'a&&href');\n                        //var _links = html.match(/https:\\/\\/(www\\.aliyundrive\\.com\\/s|alywp\\.net)\\/\\w*/g) || [];\n                        //log(_links);\n                        if (html.length > 0) {\n                            //return 'hiker://page/detail?rule=云盘汇影&url=' + _links[0] + '??fypage';\n                            //return 'hiker://page/push?url=hiker://empty##' + encodeURIComponent(html) + '???fypage';\n                            return wrapu(html);\n                        } else {\n                            return input;\n                        }\n                    }, wrapu),\n                    desc: \"““””<font color=#f13b66a>猫狸盘搜</font>&nbsp;\" + pdfh(it, \"template,1&&Text\"),\n                });\n            }\n            return d;\n        }\n    }, {\n        name: \"易搜\",\n        page: true,\n        find: function(s, page) {\n            eval(getCryptoJS());\n\n            function keyen(str) {\n                var key = CryptoJS.enc.Utf8.parse(\"4OToScUFOaeVTrHE\"),\n                    iv = CryptoJS.enc.Utf8.parse(\"9CLGao1vHKqm17Oz\");\n                var encrypted = CryptoJS.AES.decrypt({\n                    ciphertext: CryptoJS.enc.Base64.parse(str)\n                }, key, {\n                    iv: iv,\n                    mode: CryptoJS.mode.CBC,\n                    padding: CryptoJS.pad.Pkcs7\n                }).toString(CryptoJS.enc.Utf8);\n                return encrypted;\n            }\n            let html = request(\"https://yiso.fun/api/search?name=\" + s + \"&pageNo=\" + page, {\n                headers: {\n                    \"Referer\": \"https://yiso.fun/info?searchKey=\" + s,\n                    \"Cookie\": getItem('yisoucooke', '')\n                }\n            });\n            //log(html);\n            if (html.includes('登录用户无限制')) {\n                var i = 0;\n                do {\n                    var tyimglin = 'https://yiso.fun/api/user/login/captcha?t=' + parseInt(new Date().getTime()) + '';\n                    let img = convertBase64Image(tyimglin).split(',')[1];\n                    let cod = request('https://api.nn.ci/ocr/b64/text', {\n                        headers: {\n                            'Content-Type': 'text/plain'\n                        },\n                        body: img,\n                        method: 'POST'\n                    });\n                    var ver = JSON.parse(request('https://yiso.fun/api/user/login', {\n                        headers: {\n                            'content-type': 'application/json',\n                            'referer': 'https://yiso.fun/login',\n                            'Cookie': getCookie(tyimglin)\n                        },\n                        body: {\n                            \"userName\": \"tvbox2023\",\n                            \"password\": \"Tvbox2023\",\n                            \"code\": cod\n                        },\n                        method: 'POST'\n                    }));\n                    if (ver.code == 200) {\n                        log('易搜登入验证成功');\n                        setItem('yisoucooke', getCookie('https://yiso.fun'));\n                        html = request(\"https://yiso.fun/api/search?name=\" + s + \"&pageNo=\" + page, {\n                            headers: {\n                                \"Referer\": \"https://yiso.fun/info?searchKey=\" + s,\n                                \"Cookie\": getItem('yisoucooke', '')\n                            }\n                        });\n                        break;\n                    }\n                    i++;\n                } while (i < 4);\n\n            }\n            let arr = JSON.parse(html).data.list;\n            //log(arr);\n            let d = [];\n            for (let i = 0; i < arr.length; i++) {\n                let it = arr[i];\n                let u = keyen(it.url);\n                //log(u);\n                if (u == null || !u.includes(\"ali\")) {\n                    continue;\n                }\n                d.push({\n                    title: \"““””\" + it.name,\n                    //url: 'hiker://page/detail?rule=云盘汇影&url=' + u + '??fypage',\n                    //url: 'hiker://page/push?url=hiker://empty##' + encodeURIComponent(u) + '???fypage',\n                    url: wrapu(u),\n                    desc: \"““””<font color=#f13b66a>易搜</font>&nbsp;\" + (it.gmtShare || it.gmtCreate) + \"\\n\" + (u),\n                });\n\n            }\n            return d;\n        }\n    }, {\n        name: \"找资源\",\n        page: true,\n        find: function(s, page) {\n            function gethtml() {\n                let html = request(\"http://zhaoziyuan.pw/so?filename=\" + s + \"&page=\" + page, {\n                    headers: {\n                        \"Referer\": \"http://zhaoziyuan.pw/stop.html\",\n                        \"origin\": \"http://zhaoziyuan.pw\",\n                        \"Cookie\": getItem(\"zzycooke\", \"\"),\n                        \"upgrade-insecure-requests\": \"1\",\n                        \"content-type\": \"application/x-www-form-urlencoded\"\n                    }\n                });\n                return html;\n            };\n            var html = gethtml();\n            if (!html.includes(\"search_box\")) {\n                let 账号 = 'fanty';\n                let 密码 = 'qqq111';\n                let user = 'username=' + 账号 + '&password=' + 密码;\n                let cook = JSON.parse(fetchCookie('http://zhaoziyuan.pw/logiu.html', {\n                    headers: {\n                        'User-Agent': MOBILE_UA,\n                        'Content-Type': 'application/x-www-form-urlencoded',\n                        'Origin': 'http://zhaoziyuan.pw',\n                        'Referer': 'http://zhaoziyuan.pw/login.html',\n                        \"upgrade-insecure-requests\": \"1\"\n                    },\n                    body: user,\n                    method: 'POST',\n                    onlyHeaders: true,\n                    withHeaders: true\n                })).join(';');\n                setItem(\"zzycooke\", cook);\n                log(\"找资源登入\");\n                html = gethtml();\n            }\n\n            let arr = pdfa(html, \"body&&.newsList&&li:not(:first-child)\");\n            //log(arr);\n            let d = [];\n            for (let i = 0; i < arr.length; i++) {\n                let it = arr[i];\n                let u = pdfh(it, \"a&&href\");\n                if (u == null) {\n                    continue;\n                }\n                u = \"http://zhaoziyuan.pw/\" + u;\n                //log(u);\n                let title = pdfh(it, \".news_text&&h3&&Text\");\n                d.push({\n                    title: title,\n                    desc: \"““””<font color=#f13b66a>找资源</font>&nbsp;\" + (pdfh(it, \".news_text&&p&&Text\")),\n                    url: $(u).lazyRule((wrapu) => {\n                        let html = request(input);\n                        var _links = html.match(/https:\\/\\/(www\\.aliyundrive\\.com\\/s|www\\.alipan\\.com\\/s|alywp\\.net)\\/\\w*/g) || [];\n                        //log(_links);\n                        if (_links.length > 0) {\n                            //return 'hiker://page/detail?rule=云盘汇影&url=' + _links[0] + '??fypage';\n                            //return 'hiker://page/push?url=hiker://empty##' + encodeURIComponent(_links[0]) + '???fypage';\n                            return wrapu(_links[0]);\n                        } else {\n                            return input;\n                        }\n                    }, wrapu)\n                });\n            }\n            return d;\n        }\n    }, {\n        name: \"小纸条\",\n        page: false,\n        find: function(s, page) {\n            function gettoken() {\n                if (getMyVar('xzytoken', '').length == 0) {\n                    let token = JSON.parse(post('https://gitcafe.net/tool/alipaper/', {\n                        headers: {\n                            'Referer': 'https://u.gitcafe.net/'\n                        },\n                        body: {\n                            action: 'get_token'\n                        }\n                    })).data;\n                    putMyVar('xzttoken', token);\n                }\n                return getMyVar('xzttoken', '');\n            }\n\n            function cat_code(a) {\n                var d, e, b = [\"华语电视\", \"日韩电视\", \"欧美电视\", \"其他电视\", \"华语电影\", \"日韩电影\", \"欧美电影\", \"其他电影\", \"华语动漫\", \"日韩动漫\", \"欧美动漫\", \"纪录片\", \"综艺片\", \"教育培训\", \"其他视频\", \"华语音乐\", \"日韩音乐\", \"欧美音乐\", \"其他音乐\", \"娱乐软件\", \"系统软件\", \"网络软件\", \"办公软件\", \"其他软件\", \"漫画\", \"小说\", \"出版书\", \"知识培训\", \"其他文档\", \"壁纸\", \"人物\", \"风景\", \"其他图片\", \"其他\"],\n                    c = [\"hyds\", \"rhds\", \"omds\", \"qtds\", \"hydy\", \"rhdy\", \"omdy\", \"qtdy\", \"hydm\", \"rhdm\", \"omdm\", \"jlp\", \"zyp\", \"jypx\", \"qtsp\", \"hyyy\", \"rhyy\", \"omyy\", \"qtyy\", \"kfrj\", \"xtrj\", \"wlrj\", \"bgrj\", \"qtrj\", \"mh\", \"xs\", \"cbs\", \"zspx\", \"qtwd\", \"bz\", \"rw\", \"fj\", \"qttp\", \"qt\"];\n                for (d = 0, e = c.length; e > d; d++)\n                    if (c[d] == a) return b[d];\n            }\n            let d = [];\n            let html = post(\"https://gitcafe.net/tool/alipaper/\", {\n                headers: {\n                    'Referer': 'https://u.gitcafe.net/'\n                },\n                body: {\n                    action: \"search\",\n                    from: \"web\",\n                    token: gettoken(),\n                    keyword: s\n                }\n            })\n            let list = JSON.parse(html);\n            if (list.data) {\n                list = list.data;\n            }\n            for (let i = 0; i < list.length; i++) {\n                let it = list[i]\n                let title = it.title;\n                let u = it.alikey;\n                if (u == null) {\n                    continue;\n                }\n                let murl = 'https://www.aliyundrive.com/s/' + u;\n\n                if (!checkali(murl)) {\n                    continue;\n                }\n                if (title.includes(s)) {\n                    d.push({\n                        title: \"√ \" + title,\n                        desc: \"““””<font color=#f13b66a>小纸条</font>&nbsp;\" + cat_code(it.cat),\n                        extra: {\n                            des: it.des\n                        },\n                        //url: 'hiker://page/detail?rule=云盘汇影&url=https://www.aliyundrive.com/s/' + murl + '??fypage',\n                        url: wrapu(murl)\n                        //url: 'hiker://page/push?url=hiker://empty##' + encodeURIComponent('https://www.aliyundrive.com/s/' + murl) + '???fypage',\n                    });\n\n                }\n            }\n            return d;\n        }\n    }, {\n        name: \"玩偶哥哥\",\n        page: true,\n        find: function(s, page) {\n            let url = \"http://wogg.link/index.php/vodsearch/\" + s + \"----------\" + page + \"---.html\";\n            let html = request(url, {});\n            let arr = parseDomForArray(html, '.module-items&&.module-search-item');\n            //log(arr);\n            let d = [];\n            let bet = [];\n            for (let i = 0; i < arr.length; i++) {\n                let it = arr[i];\n                let utitle = parseDomForHtml(it, 'h3&&a&&Text');\n                let userial = parseDomForHtml(it, '.video-serial&&Text');\n                let uimage = parseDom(it, '.lazyload&&data-src', 'http://wogg.link/');\n                let u = parseDom(it, 'h3&&a&&href', 'http://wogg.link/');\n                //let det = request(u, {});\n                bet.push({\n                    title: utitle,\n                    url: u,\n                    image: uimage,\n                    desc: userial\n                });\n            }\n            if (bet.length > 0) {\n                let beth = batchFetch(bet);\n                for (let i = 0; i < beth.length; i++) {\n                    let list = parseDomForArray(beth[i], '.module-player-list&&p')\n                    for (let j = 0; j < list.length; j++) {\n                        let u = parseDomForHtml(list[j], 'p&&Text');\n                        if (!u.includes(\"/s/\")) {\n                            continue;\n                        }\n                        d.push({\n                            title: bet[i].title,\n                            pic_url: bet[i].image,\n                            //url: 'hiker://page/detail?rule=云盘汇影&url=' + u + '??fypage',\n                            //url: 'hiker://page/push?url=hiker://empty##' + encodeURIComponent(u) + '???fypage',\n                            url: wrapu(u),\n                            desc: \"““””<font color=#f13b66a>玩偶哥哥</font>&nbsp;\" + (bet[i].desc) + '\\n' + u,\n                        });\n\n                    }\n                }\n            }\n            return d;\n        }\n    }, {\n        name: \"玩偶妹妹\",\n        page: true,\n        find: function(s, page) {\n            let url = \"https://www.weixine.net/vodsearch/\" + s + \"----------\" + page + \"---.html\";\n            let html = request(url, {});\n            let arr = parseDomForArray(html, '.module-items&&.module-search-item');\n            //log(arr);\n            let d = [];\n            let bet = [];\n            for (let i = 0; i < arr.length; i++) {\n                let it = arr[i];\n                let utitle = parseDomForHtml(it, 'h3&&a&&Text');\n                let userial = parseDomForHtml(it, '.video-serial&&Text');\n                let uimage = parseDom(it, '.lazyload&&data-src', 'https://www.weixine.net/');\n                let u = parseDom(it, 'h3&&a&&href', 'https://www.weixine.net/');\n                //let det = request(u, {});\n                bet.push({\n                    title: utitle,\n                    url: u,\n                    image: uimage,\n                    desc: userial\n                });\n            }\n            if (bet.length > 0) {\n                let beth = batchFetch(bet);\n                for (let i = 0; i < beth.length; i++) {\n                    let list = parseDomForArray(beth[i], '.module-player-list&&p')\n                    for (let j = 0; j < list.length; j++) {\n                        let u = parseDomForHtml(list[j], 'p&&Text');\n                        if (!/aliyundrive|alipan/.test(u)) {\n                            continue;\n                        }\n                        d.push({\n                            title: bet[i].title,\n                            pic_url: bet[i].image,\n                            //url: 'hiker://page/detail?rule=云盘汇影&url=' + u + '??fypage',\n                            //url: 'hiker://page/push?url=hiker://empty##' + encodeURIComponent(u) + '???fypage',\n                            url: wrapu(u),\n                            desc: \"““””<font color=#f13b66a>玩偶妹妹</font>&nbsp;\" + (bet[i].desc) + '\\n' + u,\n                        });\n\n                    }\n                }\n            }\n            return d;\n        }\n    }, {\n        name: \"阿里云盘网\",\n        page: true,\n        find: function(s, page) {\n            let url = \"https://www.alypw.cn/search.php?q=\" + s + \"&page=\" + page;\n            let html = request(url, {});\n            let arr = parseDomForArray(html, '.list&&li');\n            //log(arr);\n            let d = [];\n            let bet = [];\n            for (let i = 0; i < arr.length; i++) {\n                let it = arr[i];\n                let utitle = parseDomForHtml(it, 'a&&title');\n                let userial = parseDomForHtml(it, '.fa-clock-o&&Text');\n                let uimage = parseDom(it, 'img&&src', 'https://www.alypw.cn/');\n                let u = parseDom(it, 'a&&href', 'https://www.alypw.cn/');\n                //let det = request(u, {});\n                if (!utitle.includes(s)) {\n                    continue;\n                }\n                bet.push({\n                    title: utitle,\n                    url: u,\n                    image: uimage,\n                    desc: userial\n                });\n            }\n            //log(bet);\n            if (bet.length > 0) {\n                let beth = batchFetch(bet);\n                for (let i = 0; i < beth.length; i++) {\n                    let list = parseDomForArray(beth[i], 'body&&a[href^=https://www.aliyundrive.com/s/]')\n                    //log(list);\n                    for (let j = 0; j < list.length; j++) {\n                        let u = parseDomForHtml(list[j], 'a&&href');\n                        d.push({\n                            title: bet[i].title,\n                            pic_url: bet[i].image,\n                            //url: 'hiker://page/detail?rule=云盘汇影&url=' + u + '??fypage',\n                            //url: 'hiker://page/push?url=hiker://empty##' + encodeURIComponent(u) + '???fypage',\n                            url: wrapu(u),\n                            desc: \"““””<font color=#f13b66a>阿里云盘网</font>&nbsp;\" + (bet[i].desc) + '\\n' + u,\n                        });\n\n                    }\n                }\n            }\n            return d;\n        }\n    },\n    {\n        name: \"小云搜索\",\n        page: false,\n        find: function(s, page) {\n            let ur = 'https://www.yunso.net/api/validate/search?wd=' + s + '&mode=90002&stype=20100&uk=&page=' + page + '&limit=20&screen_filetype=undefined';\n            let bod = 'data=/api/validate/search?wd=' + s + '&mode=90002&stype=20100&uk=&page=' + page + '&limit=20&screen_filetype=undefined';\n            let html = fetch(ur, {\n                headers: {\n                    \"User-Agent\": PC_UA,\n                    \"Referer\": \"https://www.yunso.net\",\n                    \"x-requested-with\": \"XMLHttpRequest\"\n                },\n                body: bod,\n                method: \"POST\"\n            });\n\n            let arr = parseDomForArray(JSON.parse(html).data, 'body&&a[url^=aHR0c]');\n            let d = [];\n            for (let i = 0; i < arr.length; i++) {\n                let it = arr[i];\n                //log(it);\n                let u = base64Decode(parseDomForHtml(it, 'a&&url'));\n                let tit = parseDomForHtml(it, 'a&&Text');\n                if (!tit.includes(s)) {\n                    continue;\n                }\n                if (!/aliyundrive|alipan/.test(u)) {\n                    continue;\n                }\n                //log(u);\n                d.push({\n                    title: tit,\n                    //url: 'hiker://page/detail?rule=云盘汇影&url=' + u + '??fypage',\n                    //url: 'hiker://page/push?url=hiker://empty##' + encodeURIComponent(u) + '???fypage',\n                    url: wrapu(u),\n                    desc: \"““””<font color=#f13b66a>小云搜索</font>&nbsp;\" + \"\\n\" + u,\n                });\n            }\n            return d;\n        }\n    },\n    {\n        name: \"阿里搜\",\n        page: true,\n        find: function(s, page) {\n            let d = [];\n            let html = request('https://aliso.cc/s/' + s + '-' + page + '-0.html', {});\n\n            let list = parseDomForArray(html, '.search-result&&.resource-item');\n            for (let j = 0; j < list.length; j++) {\n                let u = list[j];\n                let tit = parseDomForHtml(u, 'h3&&Text');\n                if (!tit.includes(s)) {\n                    continue;\n                }\n                d.push({\n                    title: tit,\n                    url: $(parseDom(u, 'h3&&a&&href', 'https://aliso.cc/')).lazyRule((wrapu) => {\n                        eval(getCryptoJS());\n\n                        function decry(str) {\n                            var key = CryptoJS.enc.Utf8.parse(\"9EB20DDFD6AFBD68\");\n                            var encrypted = CryptoJS.AES.decrypt(str, key, {\n                                iv: key,\n                                mode: CryptoJS.mode.CBC,\n                                padding: CryptoJS.pad.Pkcs7\n                            }).toString(CryptoJS.enc.Utf8);\n                            return encrypted;\n                        }\n\n                        let html = request(input);\n                        let but = parseDom(html, '.button&&href', 'https://aliso.cc/');\n                        //log(but);\n                        let got = request(but);\n                        //log(got);\n                        eval(parseDomForHtml(got, 'head&&script,1&&Html'));\n                        return wrapu(decry(base64.split('!')[0]));\n\n                    }, wrapu),\n                    desc: \"““””<font color=#f13b66a>阿里搜</font>&nbsp;\" + parseDomForHtml(u, '.time&&Text'),\n                });\n\n            }\n            return d;\n        }\n    },\n    {\n        name: \"土拨鼠搜\",\n        page: false,\n        find: function(s, page) {\n            /*let html = request('https://www.tugousou.com/search', {\n                body: 'keyword=' + s,\n                method: 'POST'\n            });*/\n            var ee = getMyVar(\"tgskey\", \"\");\n\n            function getkey() {\n                let aa = request('https://www.tbsdy.com/service/mrs/token.json', {\n                    headers: {\n                        'content-type': 'application/json',\n                        'USER-KEY-ID': 'ukey:e26a05575d3c4a80856bf9b63f99529f'\n                    },\n                    body: {\n                        \"app_key\": \"86b9fb4c32b5f832fdf39e17c8\"\n                    },\n                    method: 'POST'\n                });\n                let bb = JSON.parse(aa).data;\n                putMyVar(\"tgskey\", bb);\n                return bb;\n            }\n\n            function tencode(e, t) {\n                e += \"\";\n                for (var o = \"\", n = 0; n < e.length; n++) {\n                    var r = e.charCodeAt(n);\n                    r += t,\n                        r > 127 && (r = 127),\n                        o += String.fromCharCode(r)\n                }\n                return o\n            }\n            //log(tencode(ee, 10));\n\n            let html = request('https://www.tbsdy.com/service/search/wap.json?paged=' + page + '&page_size=10', {\n                headers: {\n                    'content-type': 'application/json',\n                    'USER-KEY-ID': 'ukey:e26a05575d3c4a80856bf9b63f99529f'\n                },\n                body: {\n                    \"keyword\": s,\n                    \"data_type\": 987910,\n                    \"category\": 983920,\n                    \"mrs_token\": tencode(ee == '' ? getkey() : ee, 10),\n                    \"app_key\": \"86b9fb4c32b5f832fdf39e17c8\"\n                },\n                method: 'POST'\n            });\n            //log(ee);\n            let arr = JSON.parse(html).cloud_list;\n            let d = [];\n            for (let i = 0; i < arr.length; i++) {\n                let it = arr[i];\n                let u = it.url;\n                if (!u.includes(\"/s/\")) {\n                    continue;\n                }\n                //log(u);\n                d.push({\n                    title: it.name,\n                    //url: 'hiker://page/detail?rule=云盘汇影&url=' + u + '??fypage',\n                    //url: 'hiker://page/push?url=hiker://empty##' + encodeURIComponent(u) + '???fypage',\n                    url: wrapu(u),\n                    desc: \"““””<font color=#f13b66a>土拨鼠搜</font>&nbsp;\" + \"\\n\" + u,\n                });\n            }\n            return d;\n        }\n    },\n    {\n        name: \"云盘分享社\",\n        page: false,\n        find: function(s, page) {\n            eval(getCryptoJS());\n\n            function decry(str) {\n                var key = CryptoJS.enc.Utf8.parse(\"5F6B2AK33DASD123\");\n                var encrypted = CryptoJS.AES.decrypt(str, key, {\n                    mode: CryptoJS.mode.ECB,\n                    padding: CryptoJS.pad.Pkcs7\n                }).toString(CryptoJS.enc.Utf8);\n                return encrypted;\n            }\n            let html = fetch('https://www.yunpanfenxiang.cn/api/bbs/api/getdata?key=' + s, {\n                headers: {\n                    'user-agent': 'Mozilla/5.0 (Linux; Android 13; V2049A Build/TP1A.220624.014; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/118.0.0.0 Mobile Safari/537.36',\n                    \"referer\": \"https://www.yunpanfenxiang.cn/search?key=\" + s\n                }\n            });\n            let aa = JSON.parse(html).data;\n\n            let json = decry(aa);\n            //log(json);\n            let arr = JSON.parse(json); //[0].result.items;\n            //log(arr);\n\n            let d = [];\n            let bet = [];\n            for (let i = 0; i < arr.length; i++) {\n                let it = arr[i];\n                let url = it.pid;\n                bet.push({\n                    url: 'https://www.yunpanfenxiang.cn/api/bbs/api/getarticle?id=' + url,\n                    options: {\n                        headers: {\n                            \"Referer\": \"https://www.yunpanfenxiang.cn/\"\n                        }\n                    }\n                });\n            }\n            //log(u);\n            let beth = batchFetch(bet);\n\n            //log(article);\n            for (let i = 0; i < beth.length; i++) {\n                let json = JSON.parse(beth[i]).data;\n                //log(json);\n                let list = json.download.split('@');\n                for (let j = 0; j < list.length; j++) {\n                    let u = list[j];\n                    d.push({\n                        title: json.title,\n                        //url: 'hiker://page/detail?rule=云盘汇影&url=' + u + '??fypage',\n                        //url: 'hiker://page/push?url=hiker://empty##' + encodeURIComponent(u) + '???fypage',\n                        url: wrapu('https://www.aliyundrive.com/s/' + u),\n                        desc: \"““””<font color=#f13b66a>云盘分享社</font>&nbsp;\" + (json.createtime) + \"\\n\" + ('https://www.aliyundrive.com/s/' + u),\n                    });\n                }\n            }\n\n            return d;\n        }\n    }, {\n        name: \"盘搜\",\n        page: true,\n        find: function(s, page) {\n            page = (page - 1) * 10;\n            let url = \"https://www.pansearch.me/search?keyword=\" + s + \"&offset=\" + page + \"&pan=aliyundrive\";\n            let html = request(url, {});\n\n            let arr = parseDomForArray(html, '.grid&&.shadow:has(a[href^=https://www.aliyundrive.com/s/])');\n            //log(arr);\n            let d = [];\n            for (let i = 0; i < arr.length; i++) {\n                let it = arr[i];\n                let u = parseDomForHtml(it, 'a[href^=https://www.aliyundrive.com/s/]&&href');\n                //log(u);\n                d.push({\n                    title: parseDomForHtml(it, '.break-all&&Text').split('http')[0],\n                    pic_url: parseDomForHtml(it, 'img&&src'),\n                    //url: 'hiker://page/detail?rule=云盘汇影&url=' + u + '??fypage',\n                    //url: 'hiker://page/push?url=hiker://empty##' + encodeURIComponent(u) + '???fypage',\n                    url: wrapu(u),\n                    desc: \"““””<font color=#f13b66a>盘搜</font>&nbsp;\" + (parseDomForHtml(it, 'p&&Text')) + \"\\n\" + (u),\n                });\n\n            }\n            return d;\n        }\n    },\n    {\n        name: \"DOVX搜\",\n        page: false,\n        find: function(s, page) {\n            let url = \"https://api.dovx.tk/ali/search?wd=\" + s;\n            let html = request(url, {});\n            //log(base64Decode(html));\n            let arr = JSON.parse(html).list;\n            //log(arr);\n            let d = [];\n            for (let i = 0; i < arr.length; i++) {\n                let it = arr[i];\n                let u = it.vod_content;\n                //u = u.length > 0 ? u[0] : url;\n                if (!/aliyundrive|alipan/.test(u)) {\n                    continue;\n                }\n                if (!checkali(u)) {\n                    continue;\n                }\n                d.push({\n                    title: \"√ \" + it.vod_name,\n                    pic_url: it.vod_pic,\n                    //url: 'hiker://page/detail?rule=云盘汇影&url=' + u + '??fypage',\n                    //url: 'hiker://page/push?url=hiker://empty##' + encodeURIComponent(u) + '???fypage',\n                    url: wrapu(u),\n                    desc: \"““””<font color=#f13b66a>DOVX搜</font>&nbsp;\" + \"\\n\" + (u),\n                });\n            }\n            return d;\n        }\n    },\n    {\n        name: \"必应\",\n        page: true,\n        find: function(s, page) {\n            let url = \"https://cn.bing.com/search?q=\" + s + \"+aliyundrive&qs=ds&form=QBRE\";\n            if (page != 1) {\n                url = getMyVar(\"bing\", url);\n            }\n            let html = request(url, {\n                headers: {\n                    \"Referer\": \"https://cn.bing.com/\",\n                    //\"X-Requested-With\": \"com.example.hikerview\",\n                    \"Accept\": \"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9\"\n                }\n            });\n            let arr = pdfa(html, \"body&&a\");\n            //log(arr);\n            let d = [];\n            for (let i = 0; i < arr.length; i++) {\n                let it = arr[i];\n                let u = pd(it, \"a&&href\", url);\n                let t = pdfh(it, \"a&&Text\");\n                if (it.includes(\"Next page\") || it.includes(\"下一页\")) {\n                    let u2 = pd(it, \"a&&href\", url);\n                    //log(\"next page\");\n                    //log(u2);\n                    putMyVar(\"bing\", u2);\n                }\n                if (u == null || t == null || !it.includes(s)) {\n                    continue;\n                }\n                if (!it.includes(\"网盘\") && !it.includes(\"云盘\") &&\n                    !it.includes(\"aliyundrive\") && !it.includes(\"yunpan\") && !it.includes(\"alipan\")) {\n                    continue;\n                }\n                if (u.startsWith(\"https://cn.bing.com/\")) {\n                    continue;\n                }\n                let dom = getHome(u).replace(\"http://\", \"\").replace(\"https://\", \"\");\n                let _links = t.match(/https:\\/\\/(www\\.aliyundrive\\.com\\/s|alywp\\.net|www\\.alipan\\.com\\/s)\\/\\w*/g) || [];\n                //log(_links);\n                let c = null;\n                //log(_links);\n                //if (_links.length > 0) {\n                //c = 'hiker://page/push?url=hiker://empty##' + encodeURIComponent(_links[0]) + '???fypage';\n                //c=wrapu(_links[0])\n                //}\n                if (_links.length > 1 && _links[1].replace(_links[0], \"\").replace(/[a-zA-Z0-9]+/g, \"\") == \"\") {\n                    c = wrapu(_links[1]);\n                } else if (_links.length > 0) {\n                    c = wrapu(_links[0]);\n                }\n                d.push({\n                    title: t,\n                    desc: \"““””<font color=#f13b66a>必应</font>&nbsp;\" + dom,\n                    url: c != null ? c : $(u).lazyRule((wrapu, mode) => {\n                        let html = request(input);\n                        var _links = html.match(/https:\\/\\/(www\\.aliyundrive\\.com\\/s|alywp\\.net)\\/\\w*/g) || [];\n                        //log(_links);\n                        //if (_links.length > 0) {\n                        //return 'hiker://page/detail?rule=云盘汇影&url=' + _links[0] + '??fypage';\n                        //return 'hiker://page/push?url=hiker://empty##' + encodeURIComponent(_links[0]) + '???fypage';\n                        if (_links.length > 1 && _links[1].replace(_links[0], \"\").replace(/[a-zA-Z0-9]+/g, \"\") == \"\") {\n                            return wrapu(_links[1]);\n                        } else if (_links.length > 0) {\n                            return wrapu(_links[0]);\n                        } else {\n                            let rule = MY_RULE.title;\n                            return \"hiker://page/ysfx?rule=\" + rule + \"&r=\" + rule + \"&mode=\" + mode + \"##\" + input;\n                        }\n                    }, wrapu, config.mode)\n                });\n            }\n            return d;\n        }\n    }\n];\n\n/*\nlet ccof = $.require('hiker://page/ccof')\nrules.push(ccof)\n*/\n//并发规则数\nlet size = 10;\n\n$.exports = function(page, rule) {\n    if (!page && !rule) {\n        return rules.map(it => it.name);\n    }\n    if (rule != null) {\n        if (page != null && page > 1) {\n            return rules.filter(i => i.name == rule && i.page);\n        }\n        return rules.filter(i => i.name == rule);\n    }\n    let start = (page - 1) * size;\n    if (rules.length < start + 1) {\n        return [];\n    }\n    let len = size;\n    if (rules.length < page * size) {\n        len = rules.length - start\n    }\n    return rules.slice(start, start + len);\n}"},{"col_type":"movie_3","name":"搜索","path":"sou","rule":"let r = getItem(\"r\", \"\");\nif (MY_PAGE == 1) {\n    let r1 = fetch(\"hiker://home@XYQ推送\");\n    let ntoken = JSON.parse(fetch('hiker://files/rules/icy/icy-ali-token.json', {}));\n\n    if (!r1 || r1.length <= 5) {\n        let ru = $.toString(() => {\n            return \"海阔视界规则分享，当前分享的是：小程序￥home_rule_v2￥base64://@XYQ推送@eyJsYXN0X2NoYXB0ZXJfcnVsZSI6IiIsInRpdGxlIjoiWFlR5o6o6YCBIiwiYXV0aG9yIjoi6aaZ6ZuF5oOFIiwidXJsIjoiaGlrZXI6Ly9lbXB0eSIsInZlcnNpb24iOjEsImNvbF90eXBlIjoibW92aWVfMyIsImNsYXNzX25hbWUiOiIiLCJ0eXBlIjoidG9vbCIsImNsYXNzX3VybCI6IiIsImFyZWFfbmFtZSI6IiIsImFyZWFfdXJsIjoiIiwic29ydF9uYW1lIjoiIiwieWVhcl9uYW1lIjoiIiwic29ydF91cmwiOiIiLCJ5ZWFyX3VybCI6IiIsImZpbmRfcnVsZSI6ImpzOlxubGV0IGQgPSBbXTtcbmQucHVzaCh7XG4gICAgdGl0bGU6ICforr7nva7nlLXop4ZJUCcsXG4gICAgdXJsOiBcImlucHV0Oi8vXCIgKyBnZXRJdGVtKCdoaWtlcnR2Ym94c2V0JywgJ2h0dHA6Ly8nICsgZ2V0SVAoKSArICc6OTk3OCcpICsgXCIvLy8v6K+36L6T5YWldHZib3jmjqjpgIFJUOWcsOWdgO+8jOWmgmh0dHA6Ly9cIiArIGdldElQKCkgKyBcIjo5OTc4LmpzOnNldEl0ZW0oJ2hpa2VydHZib3hzZXQnLGlucHV0KTtyZWZyZXNoUGFnZSgpXCIsXG4gICAgY29sX3R5cGU6ICdzY3JvbGxfYnV0dG9uJ1xufSk7XG5kLnB1c2goe1xuICAgIHRpdGxlOiBnZXRJdGVtKCdoaWtlcnR2Ym94c2V0JywgJycpLFxuICAgIC8vdXJsOiAnaGlrZXI6Ly9lbXB0eScsXG4gICAgdXJsOiBcImlucHV0Oi8vXCIgKyBnZXRJdGVtKCdoaWtlcnR2Ym94c2V0JywgJ2h0dHA6Ly8nICsgZ2V0SVAoKSArICc6OTk3OCcpICsgXCIvLy8v6K+36L6T5YWldHZib3jmjqjpgIFJUOWcsOWdgO+8jOWmgmh0dHA6Ly9cIiArIGdldElQKCkgKyBcIjo5OTc4LmpzOnNldEl0ZW0oJ2hpa2VydHZib3hzZXQnLGlucHV0KTtyZWZyZXNoUGFnZSgpXCIsXG4gICAgY29sX3R5cGU6ICdzY3JvbGxfYnV0dG9uJ1xufSk7XG5cbmQucHVzaCh7XG4gICAgdGl0bGU6IFwi5o6o6YCBXCIsXG4gICAgdXJsOiAkLnRvU3RyaW5nKCgpID0+IHtcbiAgICAgICAgY2xlYXJNeVZhcignbmFtZScpO1xuICAgICAgICAvL3ZhciBsaW5rID0gJ2hpa2VyOi8vcGFnZS9wdXNoLmh0bWw/dXJsPScgKyBlbmNvZGVVUklDb21wb25lbnQoaW5wdXQucmVwbGFjZShcIiNpc011c2ljPXRydWUjXCIsICcnKS5yZXBsYWNlKCcjaXNWaWRlbz10cnVlIycsICcnKSk7XG4gICAgICAgIHZhciBsaW5rID0gXCJoaWtlcjovL3BhZ2UvcHVzaD9wdXNodXJsPVwiICsgZW5jb2RlVVJJQ29tcG9uZW50KGlucHV0KTtcblxuICAgICAgICBpZiAoaW5wdXQuc3RhcnRzV2l0aCgnaHR0cCcpIHx8IGlucHV0LnN0YXJ0c1dpdGgoJ21hZ25ldDonKSB8fCAoaW5wdXQuaW5jbHVkZXMoXCJcXG5cIikgJiYgIWlucHV0LnN0YXJ0c1dpdGgoXCJ7XCIpKSkge1xuICAgICAgICAgICAgcmV0dXJuIGxpbms7XG4gICAgICAgIH0gZWxzZSBpZiAoaW5wdXQuc3RhcnRzV2l0aChcIntcIikgJiYgaW5wdXQuZW5kc1dpdGgoXCJ9XCIpKSB7XG4gICAgICAgICAgICByZXR1cm4gbGluaztcbiAgICAgICAgfSBlbHNlIGlmICgvXFwudG9ycmVudHxlZDJrXFw6Ly50ZXN0KGlucHV0KSkge1xuICAgICAgICAgICAgcmV0dXJuICd0b2FzdDovL+S4jeaUr+aMgeaOqOmAgei/meenjemTvuaOpeOAgidcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiAndG9hc3Q6Ly/or7fovpPlhaXmraPnoa7nmoTpk77mjqXjgIInXG4gICAgICAgIH1cbiAgICB9KSxcbiAgICBleHRyYToge1xuICAgICAgICB0aXRsZVZpc2libGU6IHRydWVcbiAgICB9LFxuICAgIGNvbF90eXBlOiAnaW5wdXQnXG59KTtcbmQucHVzaCh7XG4gICAgdGl0bGU6IFwiVFZC5pCc57SiXCIsXG4gICAgdXJsOiAkLnRvU3RyaW5nKCgpID0+IHtcbiAgICAgICAgbGV0IHR2aXAgPSBnZXRJdGVtKCdoaWtlcnR2Ym94c2V0JywgJycpO1xuICAgICAgICBsZXQgc3RhdGUgPSAnZmFsc2UnO1xuICAgICAgICBpZiAodHZpcCAhPSAnJyAmJiB0dmlwLmluY2x1ZGVzKCc6OTk3JykpIHtcbiAgICAgICAgICAgIHZhciBzdGF0ZSA9IHJlcXVlc3QodHZpcCArICcvYWN0aW9uJywge1xuICAgICAgICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQnLFxuICAgICAgICAgICAgICAgICAgICAvLydYLVJlcXVlc3RlZC1XaXRoJzogJ1hNTEh0dHBSZXF1ZXN0JyxcbiAgICAgICAgICAgICAgICAgICAgJ1JlZmVyZXInOiB0dmlwXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB0aW1lb3V0OiAyMDAwLFxuICAgICAgICAgICAgICAgIGJvZHk6ICdkbz1zZWFyY2gmd29yZD0nICsgaW5wdXQsXG4gICAgICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCdcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIC8vbG9nKHN0YXRlKTtcbiAgICAgICAgaWYgKHN0YXRlID09ICdvaycpIHtcbiAgICAgICAgICAgIHJldHVybiAndG9hc3Q6Ly/mkJzntKLmjqjpgIHmiJDlip/vvIzor7fms6jmhI/op4LnnIvnlLXop4bnq690dmJveOeVjOmdoic7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gJ3RvYXN0Oi8v5pCc57Si5o6o6YCB5aSx6LSlJ1xuICAgICAgICB9XG4gICAgfSksXG4gICAgZXh0cmE6IHtcbiAgICAgICAgdGl0bGVWaXNpYmxlOiB0cnVlXG4gICAgfSxcbiAgICBjb2xfdHlwZTogJ2lucHV0J1xufSk7XG4vL+iwg+eUqOS7o+eggeekuuS+i1xuLy9yZXR1cm4gJ2hpa2VyOi8vcGFnZS9wdXNoP3J1bGU9WFlR5o6o6YCBJnB1c2h1cmw9JyArIGVuY29kZVVSSUNvbXBvbmVudChpbnB1dCk7XG4vL3VybDogJ2hpa2VyOi8vcGFnZS9wdXNoP3J1bGU9WFlR5o6o6YCBJnB1c2h1cmw9JytlbmNvZGVVUklDb21wb25lbnQodXJsKTtcbmQucHVzaCh7XG4gICAgdGl0bGU6ICfkuIvovb1UVkJveOaOqOmAgeaPkuS7ticsXG4gICAgdXJsOiAnaHR0cHM6Ly9mcmFtYWdpdC5vcmcvbHprMjM1NTkvdHZib3gvLS90cmVlL21haW4nLFxuICAgIGNvbF90eXBlOiAndGV4dF8yJ1xufSk7XG5kLnB1c2goe1xuICAgIHRpdGxlOiAn5p+l55yLVFborr7nva7mlZnnqIsnLFxuICAgIHVybDogJ2h0dHBzOi8vZnJhbWFnaXQub3JnL2x6azIzNTU5L3R2Ym94Ly0vYmxvYi9tYWluLyVFNCVCRCVCRiVFNyU5NCVBOCVFOCVBRiVCNCVFNiU5OCU4RS0lRTUlQkYlODUlRTclOUMlOEIvWFlRVFZCb3glRTYlQUQlQTUlRTklQUElQTQlRTYlOTMlOEQlRTQlQkQlOUMlRTglQUYlQjQlRTYlOTglOEUucGRmJyxcbiAgICBjb2xfdHlwZTogJ3RleHRfMidcbn0pO1xuZC5wdXNoKHtcbiAgICB0aXRsZTogXCLmjqjpgIHlpKflrrbml49cIixcbiAgICB1cmw6ICdodHRwczovL3BkLnFxLmNvbS9zLzU1M3NmbHdqZT9zaGFyZVNvdXJjZT01JyxcbiAgICBjb2xfdHlwZTogXCJ0ZXh0XzFcIlxufSk7XG52YXIganVtcCA9IFsndHZib3jkupHnm5jmjqjpgIEnLCAn5LqR55uY5ZCbKOaOqOmAgSknLCAnQUnlvbHmkJwo5o6o6YCBKScsICdNWemYv+mHjOS6keebmCcsICfpppnmg4XlvbHop4YnLCfomY7niZnnm7Tmkq0o5o6o6YCBKSddO1xuZm9yICh2YXIgaiBpbiBqdW1wKSB7XG4gICAgZC5wdXNoKHtcbiAgICAgICAgdGl0bGU6IGp1bXBbal0sXG4gICAgICAgIHVybDogJ2hpa2VyOi8vaG9tZUAnICsganVtcFtqXSxcbiAgICAgICAgY29sX3R5cGU6IFwidGV4dF8zXCJcbiAgICB9KTtcbn1cbnNldFJlc3VsdChkKTsiLCJzZWFyY2hfdXJsIjoiIiwiZ3JvdXAiOiLikaHpppnpm4Xmg4UiLCJzZWFyY2hGaW5kIjoiIiwiZGV0YWlsX2NvbF90eXBlIjoibW92aWVfMSIsImRldGFpbF9maW5kX3J1bGUiOiIiLCJzZGV0YWlsX2NvbF90eXBlIjoibW92aWVfMSIsInNkZXRhaWxfZmluZF9ydWxlIjoiIiwidWEiOiJtb2JpbGUiLCJwcmVSdWxlIjoiIiwicGFnZXMiOiJbe1wiY29sX3R5cGVcIjpcIm1vdmllXzNcIixcIm5hbWVcIjpcIuaOqOmAgVwiLFwicGF0aFwiOlwicHVzaFwiLFwicnVsZVwiOlwianM6XFxubGV0IGl0ZW1zID0gW107XFxubGV0IHB1c2hpbiA9IGRlY29kZVVSSUNvbXBvbmVudChnZXRQYXJhbShcXFwicHVzaHVybFxcXCIpKTtcXG5sZXQgdHZpcCA9IGdldEl0ZW0oJ2hpa2VydHZib3hzZXQnLCAnJyk7XFxuXFxuaXRlbXMucHVzaCh7XFxuICAgIHRpdGxlOiAn55S16KeGSVDvvJonICsgdHZpcCxcXG4gICAgdXJsOiBcXFwiaW5wdXQ6Ly9cXFwiICsgZ2V0SXRlbSgnaGlrZXJ0dmJveHNldCcsICdodHRwOi8vJyArIGdldElQKCkgKyAnOjk5NzgnKSArIFxcXCIvLy8v6K+36L6T5YWlVFZCb3jnq6/nmoRJUOWcsOWdgO+8jOWmgmh0dHA6Ly9cXFwiICsgZ2V0SVAoKSArIFxcXCI6OTk3OC5qczpzZXRJdGVtKCdoaWtlcnR2Ym94c2V0JyxpbnB1dCk7cmVmcmVzaFBhZ2UoKVxcXCIsXFxuICAgIGNvbF90eXBlOiAnZmxleF9idXR0b24nXFxufSk7XFxudmFyIHB1cmwgPSBwdXNoaW47XFxuXFxuaWYgKHB1c2hpbi5pbmNsdWRlcygnXFxcXG4nKSAmJiAhcHVzaGluLnN0YXJ0c1dpdGgoJ3snKSkge1xcbiAgICBwdXJsID0gcHVzaGluLnJlcGxhY2UoXFxcIlxcXFxuXFxcIiwgJyQnKTtcXG59XFxuaWYgKHB1c2hpbi5zdGFydHNXaXRoKCdodHRwJykgJiYgcHVzaGluLmluY2x1ZGVzKCc7eycpKSB7XFxuICAgIHB1cmwgPSBKU09OLnN0cmluZ2lmeSh7XFxuICAgICAgICBcXFwibmFtZVxcXCI6IFxcXCLmtbfpmJTnm7Tpk77mjqjpgIFcXFwiLFxcbiAgICAgICAgXFxcInVybFxcXCI6IHB1c2hpblxcbiAgICB9KVxcbn1cXG5pZiAocHVzaGluLnN0YXJ0c1dpdGgoJ2h0dHBzOi8vd3d3LmFsaXl1bmRyaXZlLmNvbS9zLycpKSB7XFxuICAgIGxldCByZWZ0b2tlbiA9IEpTT04ucGFyc2UoZmV0Y2goJ2hpa2VyOi8vZmlsZXMvcnVsZXMvaWN5L2ljeS1hbGktdG9rZW4uanNvbicsIHt9KSlbMF0ucmVmcmVzaF90b2tlbjtcXG4gICAgcHVybCA9IEpTT04uc3RyaW5naWZ5KHtcXG4gICAgICAgIFxcXCJ1cmxcXFwiOiBwdXNoaW4sXFxuICAgICAgICBcXFwicmVmcmVzaF90b2tlblxcXCI6IHJlZnRva2VuXFxuICAgIH0pXFxufVxcbmlmIChwdXNoaW4uaW5jbHVkZXMoJzo1MjAyMCcpKSB7XFxuICAgIGlmIChwdXNoaW4uaW5jbHVkZXMoJ3JlZGlyZWN0UGxheVVybCcpKSB7XFxuICAgICAgICBwdXJsID0gSlNPTi5zdHJpbmdpZnkoe1xcbiAgICAgICAgICAgIFxcXCJuYW1lXFxcIjogXFxcIua1t+mYlOaKleWxj+ebtOmTvlxcXCIsXFxuICAgICAgICAgICAgXFxcInVybFxcXCI6IHB1c2hpblxcbiAgICAgICAgfSlcXG4gICAgfSBlbHNlIHtcXG4gICAgICAgIHB1cmwgPSBKU09OLnN0cmluZ2lmeSh7XFxuICAgICAgICAgICAgXFxcIm5hbWVcXFwiOiBcXFwi5rW36ZiU572R6aG15oqV5bGPXFxcIixcXG4gICAgICAgICAgICBcXFwidXJsXFxcIjogcHVzaGluXFxuICAgICAgICB9KVxcbiAgICB9XFxufVxcblxcbi8vbG9nKCfmjqjpgIEnK3B1cmwpO1xcbnZhciBzdGF0ZSA9IHJlcXVlc3QodHZpcCArICcvYWN0aW9uJywge1xcbiAgICBoZWFkZXJzOiB7XFxuICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCcsXFxuICAgICAgICAvLydYLVJlcXVlc3RlZC1XaXRoJzogJ1hNTEh0dHBSZXF1ZXN0JyxcXG4gICAgICAgICdSZWZlcmVyJzogdHZpcFxcbiAgICB9LFxcbiAgICB0aW1lb3V0OiAyMDAwLFxcbiAgICBib2R5OiAnZG89cHVzaCZ1cmw9JyArIHB1cmwucmVwbGFjZSgvXFxcXCYvZywgJ++8hu+8hicpLnJlcGxhY2UoL3ZpZGVvXFxcXDpcXFxcL1xcXFwvL2csJycpLFxcbiAgICBtZXRob2Q6ICdQT1NUJ1xcbn0pO1xcbi8vbG9nKHN0YXRlKTtcXG5pZiAoc3RhdGUgPT0gJ29rJykge1xcbiAgICAvL2xvZyhzdGF0ZSk7XFxuICAgIGl0ZW1zLnB1c2goe1xcbiAgICAgICAgdGl0bGU6IFxcXCLiiJpcXFwiICsgc3RhdGUsXFxuICAgICAgICB1cmw6IFxcXCJoaWtlcjovL2VtcHR5XFxcIixcXG4gICAgICAgIGNvbF90eXBlOiBcXFwidGV4dF9jZW50ZXJfMVxcXCJcXG4gICAgfSk7XFxufSBlbHNlIHtcXG4gICAgLy9sb2coc3RhdGUpO1xcbiAgICBpdGVtcy5wdXNoKHtcXG4gICAgICAgIHRpdGxlOiBcXFwi4pWzXFxcIiArIHN0YXRlLFxcbiAgICAgICAgdXJsOiBcXFwiaGlrZXI6Ly9lbXB0eVxcXCIsXFxuICAgICAgICBjb2xfdHlwZTogXFxcInRleHRfY2VudGVyXzFcXFwiXFxuICAgIH0pO1xcblxcbn1cXG5zZXRSZXN1bHQoaXRlbXMpO1wifV0iLCJpY29uIjoiIiwicHJveHkiOiIifQ==\"\n        });\n        confirm({\n            title: MY_RULE.title + '提示',\n            content: '本规则依赖XYQ推送规则，点击下面的确定按钮导入XYQ推送，注意导入后一定要在XYQ推送里设置好TV端IP，否则推送功能不能用',\n            confirm: ru,\n            cancel: ru\n        })\n    }\n    addListener(\"onClose\", $.toString(() => {\n        clearMyVar(\"s\");\n    }));\n\n    let tip = \"📽XYQ推送\";\n    d.push({\n        title: tip,\n        url: $(\"#noLoading#\").lazyRule((tip) => {\n            return 'hiker://home@XYQ推送'\n        }, tip),\n        col_type: \"text_3\",\n        desc: \"\",\n        pic_url: \"hiker://images/account\"\n    });\n    let dmode = getItem(\"dmode\", \"本地转码\");\n    initConfig({\n        mode: dmode\n    });\n\n    d.push({\n        title: \"🛠\" + dmode,\n        url: \"select://\" + JSON.stringify({\n            title: \"选择模式\",\n            options: [\"本地转码\", \"官方APP\"],\n            col: 1,\n            js: $.toString(() => {\n                setItem(\"dmode\", input);\n                refreshPage();\n                if (input == \"官方APP\") {\n                    return \"toast://修改成功，请确保手机有安装阿里云盘官方APP\";\n                } else {\n                    return \"toast://修改成功。\"\n                }\n            })\n        }),\n        col_type: \"text_3\",\n        desc: \"\",\n        pic_url: \"hiker://images/icon1\"\n    });\n    d.push({\n        title: '☁️我的云盘',\n        url: 'hiker://home@MY阿里云盘',\n        col_type: \"text_3\",\n        desc: \"\",\n        pic_url: \"\"\n    });\n\n    d.push({\n        title: '当前用户：' + ntoken[0].nick_name + ' ' + ntoken[0].user_name,\n        url: $('hiker://empty#noRecordHistory#').rule(() => {\n            let d = [];\n            d.push({\n                title: \"退出登录\",\n                url: $('hiker://empty#noRecordHistory#').lazyRule(() => {\n                    let ntoken = JSON.parse(fetch('hiker://files/rules/icy/icy-ali-token.json', {}));\n                    //ntoken.splice(0, 1);\n                    //ntoken.shift();\n                    ntoken[0] = {};\n                    writeFile(\"hiker://files/rules/icy/icy-ali-token.json\", JSON.stringify(ntoken));\n                    back(true);\n                    return \"hiker://empty\";\n                }),\n                col_type: \"text_center_1\"\n            });\n            setHomeResult(d);\n        }),\n        col_type: \"avatar\",\n        pic_url: ntoken[0].avatar\n    });\n    d.push({\n        title: '搜索',\n        desc: '请输入关键词',\n        col_type: 'input',\n        url: $.toString(() => {\n            if (/https\\:\\/\\/www.ali(pan|yundrive)\\.com\\/s\\//.test(input)) {\n                return 'hiker://page/push?url=hiker://empty##' + encodeURIComponent(input) + '???fypage';\n            } else {\n                putMyVar('s', input);\n                refreshPage();\n                return 'hiker://empty'\n            }\n        }),\n        extra: {\n            defaultValue: getMyVar('s', '')\n        }\n    });\n    let rules = $.require(\"hiker://page/data\")();\n    d.push({\n        title: \"\" == r ? \"““全部””\" : \"全部\",\n        url: $(\"#noLoading#\").lazyRule(() => {\n            clearItem(\"r\");\n            refreshPage();\n            return \"hiker://empty\"\n        }),\n        col_type: \"scroll_button\",\n        desc: \"\",\n        pic_url: \"\"\n    });\n    for (let it of rules) {\n        d.push({\n            title: it == r ? \"““\" + it + \"””\" : it,\n            url: $(\"#noLoading#\").lazyRule((r) => {\n                setItem(\"r\", r);\n                refreshPage();\n                return \"hiker://empty\"\n            }, it),\n            col_type: \"scroll_button\",\n            desc: \"\",\n            pic_url: \"\"\n        });\n    }\n    d.push({\n        col_type: 'line',\n        extra: {\n            id: 'ypj-l'\n        }\n    });\n}\nlet s = getMyVar('s', '');\nif (s != \"\") {\n    let p = MY_PAGE;\n    let data = $.require(\"hiker://page/data\")(p, r != \"\" ? r : null);\n\n    let pageid = \"ypj-page\" + p;\n    if (data.length > 0) {\n        d.push({\n            title: \"加载第\" + p + \"页中，进度：1/\" + data.length,\n            url: \"\",\n            col_type: \"text_center_1\",\n            desc: \"\",\n            pic_url: \"\",\n            extra: {\n                id: pageid\n            }\n        });\n    }\n    setResult(d);\n    //log(data.length);\n\n    if (data.length > 0) {\n        //多线程加载        \n        let realPage = \"\" == r ? 1 : p;\n        let tasks = data.map(it => {\n            return {\n                func: function(rule) {\n                    return rule.find(s, realPage);\n                },\n                param: it,\n                id: \"rule@\" + it.name\n            }\n        });\n\n        batchExecute(tasks, {\n            func: function(param, id, error, result) {\n                //log(\"listener: \" + (result || []).length)\n                param.i = param.i + 1;\n                if (result) {\n                    try {\n                        for (let it of result) {\n                            param.j = param.j + 1;\n                            addItemBefore(pageid, {\n                                title: it.title.includes(\"““””\") ? it.title : \"““””\" + it.title.replace(new RegExp(\"<em>|</em>\", \"g\"), \"\").replace(new RegExp(s, \"g\"), \"<strong><span style=\\\"color: #1E90FF\\\">\" + s + \"</span></strong>\"),\n                                desc: it.desc,\n                                url: it.url,\n                                pic_url: it.pic_url,\n                                col_type: it.pic_url ? 'movie_1_vertical_pic' : \"text_1\",\n                                extra: {\n                                    id: \"__app\" + MY_PAGE + \"@\" + param.j,\n                                    inheritTitle: false\n                                }\n                            })\n                        }\n                    } catch (e) {}\n\n                }\n                if (param.i >= param.all) {\n                    deleteItem(pageid)\n                } else {\n                    updateItem({\n                        title: \"加载第\" + MY_PAGE + \"页中，进度：\" + (param.i + 1) + \"/\" + param.all,\n                        url: \"\",\n                        col_type: \"text_center_1\",\n                        desc: \"\",\n                        pic_url: \"\",\n                        extra: {\n                            id: pageid\n                        }\n                    })\n                }\n            },\n            param: {\n                all: data.length,\n                i: 0,\n                j: -1\n            }\n        })\n    }\n}"},{"col_type":"movie_3","name":"搜索页面","path":"soup","rule":"js:\nvar d = [];\nif (MY_PARAMS.key) {\n    putMyVar(\"s\", MY_PARAMS.key);\n}\neval(JSON.parse(fetch(\"hiker://page/sou\")).rule);"},{"col_type":"movie_3","name":"CCOF","path":"ccof","rule":"var wrapu = (u) => {\n    if(config.mode == \"本地转码\"){\n        return 'hiker://page/push?url=hiker://empty##' + encodeURIComponent(u) + '???fypage'\n    }\n    if (/aliyundrive/.test(u)) {\n        const [link, _share_pwd] = u.split('?share_pwd=');\n        const [_link, _folderID] = link.split('/folder/');\n        let share_pwd = (_share_pwd || '').split('#name=')[0] || '';\n        let shareId = _link.split('com/s/')[1];\n        return 'smartdrive://share/browse?shareId=' + shareId + '&sharePwd=' + share_pwd;\n    }\n    return \"web://\" + u;\n};\n\n$.exports = {\n    name: 'CCOF',\n    page: true,\n    find: function(s, page) {\n        let d = []\n        const {\n            bytesToSize,\n            color\n        } = $.require('hiker://page/tools');\n        let html = fetch('https://pan.ccof.cc/api/search', {\n            headers: {\n                \"content-type\": 'application/json',\n                'Referer': 'https://pan.ccof.cc/search?keyword=' + s\n            },\n            body: {\n                \"pageSize\": 20,\n                \"pageNum\": page,\n                \"keyword\": s,\n                \"fromMobile\": true\n            },\n            method: 'POST'\n        })\n        let list = JSON.parse(html)\n            .data.rows\n        for (let i = 0; i < list.length; i++) {\n            let it = list[i]\n            let title = it.fileName\n            let murl = it.url\n            let type = it.type.replace(/folder/, '文件夹').replace(/file/, '文件')\n            if (title.includes(s)) {\n                d.push({\n                    title: title,\n                    desc: '““””<font color=#f13b66a>CCOF</font>&nbsp;' + '文件类型：' + type + '，文件大小：' + bytesToSize(it.size),\n                    //url: 'hiker://page/detail?rule=云盘汇影&url=' + murl + '??fypage'\n                    //url: 'hiker://page/push?url=hiker://empty##' + encodeURIComponent(murl) + '???fypage'\n                    url: wrapu(murl)\n                })\n            }\n        }\n        return d\n    }\n}"},{"col_type":"movie_3","name":"工具","path":"tools","rule":"function bytesToSize(size) {\n    if (size < 0.1 * 1024) {\n        //小于0.1KB，则转化成B\n        size = size.toFixed(2) + \"B\";\n    } else if (size < 0.1 * 1024 * 1024) {\n        // 小于0.1MB，则转化成KB\n        size = (size / 1024).toFixed(2) + \"KB\";\n    } else if (size < 0.1 * 1024 * 1024 * 1024) {\n        // 小于0.1GB，则转化成MB\n        size = (size / (1024 * 1024)).toFixed(2) + \"MB\";\n    } else {\n        // 其他转化成GB\n        size = (size / (1024 * 1024 * 1024)).toFixed(2) + \"GB\";\n    }\n    // 转成字符串\n    let sizeStr = size + \"\",\n        // 获取小数点处的索引\n        index = sizeStr.indexOf(\".\"),\n        // 获取小数点后两位的值\n        dou = sizeStr.substr(index + 1, 2);\n    // 判断后两位是否为00，如果是则删除00\n    if (dou === \"00\") return sizeStr.substring(0, index) + sizeStr.substr(index + 3, 2);\n    return size;\n}\n$.exports.bytesToSize = bytesToSize;\n$.exports.color = function(text, color) {\n    text += \"\";\n    if (text.indexOf(\"““””\") === 0) {\n        text.replace(\"““””\", \"\");\n    }\n    return \"““””<font color='\" + color + \"'>\" + text + \"</font>\";\n}\n\n$.exports.sleep = function(timeout) {\n    java.lang.Thread.sleep(timeout);\n}\n\nfunction htmlTag(tag, text) {\n    text += \"\";\n    if (text.indexOf(\"““””\") === 0) {\n        text.replace(\"““””\", \"\");\n    }\n    return \"““””\" + \"<\" + tag + \">\" + text + \"</\" + tag + \">\";\n\n}\n$.exports.htmlTag = htmlTag;\n$.exports.small = function(text) {\n    return htmlTag(\"small\", text);\n}\n\nfunction getTime(file,isStandard) {\n    isStandard = isStandard||false;\n    let tTime = file.updated_at || file.time_str || \"\";\n    tTime = tTime.split(\"T\");\n    let date = tTime[0];\n    if(isStandard){\n        date = date.replace(/-/g,\"/\");\n    }\n    tTime = tTime[1].split(/Z|\\./);\n    date += \" \" + tTime[0];\n    return date;\n}\nfunction getTimeInt(timeStr){\n    return (new Date(timeStr)).getTime()\n}\n$.exports.getTime = getTime;\n\nlet chnNumChar = {\n    零: 0,\n    一: 1,\n    二: 2,\n    三: 3,\n    四: 4,\n    五: 5,\n    六: 6,\n    七: 7,\n    八: 8,\n    九: 9\n};\n\nlet chnNameValue = {\n    十: {\n        value: 10,\n        secUnit: false\n    },\n    百: {\n        value: 100,\n        secUnit: false\n    },\n    千: {\n        value: 1000,\n        secUnit: false\n    },\n    万: {\n        value: 10000,\n        secUnit: true\n    },\n    亿: {\n        value: 100000000,\n        secUnit: true\n    }\n}\n\nfunction ChineseToNumber(chnStr) {\n    let rtn = 0;\n    let section = 0;\n    let number = 0;\n    let secUnit = false;\n    let str = chnStr.split('');\n\n    for (let i = 0; i < str.length; i++) {\n        let num = chnNumChar[str[i]];\n        if (typeof num !== 'undefined') {\n            number = num;\n            if (i === str.length - 1) {\n                section += number;\n            }\n        } else {\n            let unit = chnNameValue[str[i]].value;\n            secUnit = chnNameValue[str[i]].secUnit;\n            if (secUnit) {\n                section = (section + number) * unit;\n                rtn += section;\n                section = 0;\n            } else {\n                section += (number * unit);\n            }\n            number = 0;\n        }\n    }\n    return rtn + section;\n}\n\nfunction nameCompare(a, b) {\n    if (a == null || b == null)\n        return a == null ? b == null ? 0 : -1 : 1;\n\n    a = a.replace(/([零一二三四五六七八九十百千万亿])/g, function(match, p1, p2, p3, offset, string) {\n        // p1 is nondigits, p2 digits, and p3 non-alphanumerics\n        return ChineseToNumber(p1);\n    })\n    b = b.replace(/([零一二三四五六七八九十百千万亿])/g, function(match, p1, p2, p3, offset, string) {\n        // p1 is nondigits, p2 digits, and p3 non-alphanumerics\n        return ChineseToNumber(p1);\n    })\n\n    let NUMBERS = java.util.regex.Pattern.compile(\"(?<=\\\\D)(?=\\\\d)|(?<=\\\\d)(?=\\\\D)\")\n    let split1 = NUMBERS.split(new java.lang.String(a));\n    let split2 = NUMBERS.split(new java.lang.String(b));\n\n    for (let i = 0; i < Math.min(split1.length, split2.length); i++) {\n        let c1 = split1[i].charCodeAt(0);\n        let c2 = split2[i].charCodeAt(0);\n        let cmp = 0;\n        let zeroCharCode = '0'.charCodeAt(0);\n        let nineCharCode = '9'.charCodeAt(0);\n\n        if (c1 >= zeroCharCode && c1 <= nineCharCode && c2 >= zeroCharCode && c2 <= nineCharCode) {\n            cmp = new java.math.BigInteger(split1[i]).compareTo(new java.math.BigInteger(split2[i]));\n        }\n\n        if (cmp === 0) {\n            let regex = /[a-zA-Z0-9]/\n            let s1 = String(split1[i])\n            let s2 = String(split2[i])\n            if (regex.test(s1) || regex.test(s2)) {\n                cmp = new java.lang.String(split1[i]).compareTo(new java.lang.String(split2[i]));\n                // cmp = s1.localeCompare(s2, 'en')\n            } else {\n                cmp = s1.localeCompare(s2, 'zh')\n            }\n        }\n\n        if (cmp !== 0) {\n            return cmp;\n        }\n    }\n    let lengthCmp = split1.length - split2.length;\n    // if (lengthCmp !== 0) lengthCmp = lengthCmp > 0 ? -1 : 1;\n    return lengthCmp;\n}\n\n$.exports.sorts = function(list, sort) {\n    if (sort === \"类型\") {\n        // log(\"类型排序\");\n        list.sort(function(a, b) {\n            return a.type - b.type\n        });\n    } else if (sort === \"名称\") {\n        // log(\"名称排序\");\n        // list.sort(function(a, b) {\n        //     return a.name.localeCompare(b.name, \"zh\")\n        // });\n        list.sort(function(a, b) {\n            return nameCompare(a.name||a.title, b.name||b.title);\n        });\n    } else if (sort === \"大小\") {\n        // log(\"大小排序\");\n        list.sort(function(a, b) {\n            return (a.size || Number(a.size_str) || 0) - (b.size || Number(b.size_str) || 0);\n        });\n    }else if (sort === \"时间\") {\n        // log(\"时间排序\");\n        list.sort(function(a, b) {\n            return getTimeInt(getTime(a,true)) - getTimeInt(getTime(b,true))\n        });\n    }\n    return list\n}\n\nfunction similar(s, t, f) {//判断两个字符串之间的相似度\n    if (!s || !t) {\n        return 0\n    }\n    if(s === t){\n        return 100;\n    }\n    var l = s.length > t.length ? s.length : t.length\n    var n = s.length\n    var m = t.length\n    var d = []\n    f = f || 2\n    var min = function (a, b, c) {\n        return a < b ? (a < c ? a : c) : (b < c ? b : c)\n    }\n    var i, j, si, tj, cost\n    if (n === 0) return m\n    if (m === 0) return n\n    for (i = 0; i <= n; i++) {\n        d[i] = []\n        d[i][0] = i\n    }\n    for (j = 0; j <= m; j++) {\n        d[0][j] = j\n    }\n    for (i = 1; i <= n; i++) {\n        si = s.charAt(i - 1)\n        for (j = 1; j <= m; j++) {\n            tj = t.charAt(j - 1)\n            if (si === tj) {\n                cost = 0\n            } else {\n                cost = 1\n            }\n            d[i][j] = min(d[i - 1][j] + 1, d[i][j - 1] + 1, d[i - 1][j - 1] + cost)\n        }\n    }\n    let res = (1 - d[n][m] / l) *100\n    return res.toFixed(f)\n}\n\n$.exports.similar = similar;\n$.exports.removeExt = function (file){\n    return file.split('.').slice(0,-1).join('.')\n};"},{"col_type":"movie_3","name":"u","path":"u","rule":"$.exports = function(rule, origin, mode) {\n    return $.toString((rule, origin, mode) => {\n        let host = origin.replace(new RegExp(\"http://|https://\"), \"\").split(\"/\")[0];\n        let hosts = host.split(\".\");\n        if (hosts.length > 2) {\n            host = hosts[hosts.length - 2] + \".\" + hosts[hosts.length - 1];\n        }\n        if (input.startsWith(\"magnet\")) {\n            confirm({\n                title: \"温馨提示\",\n                content: \"检测到新的磁链地址，点击确定按钮即可播放，点击取消按钮可以复制链接\",\n                confirm: $.toString((mag) => {\n                    return mag;\n                }, input),\n                cancel: $.toString((mag) => {\n                    return \"copy://\" + mag\n                }, input)\n            })\n            return true;\n        } else if (/aliyundrive\\.com|alipan\\.com/.test(input) && mode != \"官方APP\") {\n            //log(input);\n            if (input.includes('checkurl?url=') && input.includes('&urlrefer')) {\n                input = decodeURIComponent(input.split('&urlrefer')[0].split('checkurl?url=')[1]);\n                //log('贴吧'+input);\n            }\n            return $.toString((url, rule) => {\n                fy_bridge_app.open(JSON.stringify({\n                    title: \"阿里云盘\",\n                    //url: \"hiker://page/detail?rule=云盘汇影&url=\" + url + '??fypage',\n                    url: \"hiker://page/push?rule=\" + rule + \"&url=hiker://empty##\" + encodeURIComponent(url) + '???fypage',\n                }))\n            }, input, rule)\n        } else if (/\\.(mp3|flac|m4a)$/.test(input)) {\n            //log(input);\n            return $.toString((url, rule) => {\n                fy_bridge_app.playVideo(url);\n            }, input, rule)\n        } else if (!input.includes(host) && input.startsWith(\"http\")) {\n            //log(input);\n            return $.toString((url, rule, mode) => {\n                fy_bridge_app.open(JSON.stringify({\n                    title: \"详情\",\n                    url: \"hiker://page/ysfx?rule=\" + rule + \"&r=\" + rule + \"&mode=\" + mode + \"##\" + url,\n                }))\n            }, input, rule, mode);\n        } else if (!input.startsWith(\"http\")) {\n            //log(input);\n            //能唤起APP的白名单\n            let white = [\n                \"qklink\",\n                \"bdnetdisk\",\n                \"xunleiapp\"\n            ];\n            let inWhite = white.filter(it => input.startsWith(it)).length > 0;\n            if (!inWhite) {\n                return false;\n            }\n            return $.toString((url, rule) => {\n                fy_bridge_app.openThirdApp && fy_bridge_app.openThirdApp(url);\n            }, input, rule)\n        } else {\n\n        }\n    }, rule, origin, mode);\n}"},{"col_type":"movie_3","name":"ysfx","path":"ysfx","rule":"js:\nvar d = [];\nlet rule = getParam(\"r\").split(\"##\")[0];\nlet mode = (getParam(\"mode\") || \"\").split(\"##\")[0];\nlet url = MY_URL.split(\"##\")[1];\nlet ite = $.require(\"hiker://page/u\")(rule, getHome(url),mode);\nlet js = $.toString(() => {\n    try {\n        if (document.title && document.title.length) {\n            let r = $$$().lazyRule((t) => {\n                setPageTitle(t);\n            }, document.title);\n            fy_bridge_app.parseLazyRule(r);\n        }\n    } catch (e) {\n        fy_bridge_app.log(e.toString());\n    }\n});\nd.push({\n    title: \"\",\n    url: url,\n    col_type: \"x5_webview_single\",\n    desc: \"100%&&float\",\n    pic_url: \"\",\n    extra: {\n        urlInterceptor: ite,\n        js: js,\n        canBack: true,\n        jsLoadingInject: true,\n        floatVideo: true\n    }\n});\nd.push({\n    col_type: \"line\",\n    extra: {\n        id: url\n    }\n});\nsetResult(d);"},{"col_type":"movie_3","name":"推送","path":"push","rule":"js:\n//log(MY_URL);\nvar items = [];\nvar realurl = MY_URL.split('##')[1].split('???')[0];\nif (MY_PAGE == 1) {\n    items.push({\n        title: \"📽 推送到TVBox 📺\",\n        url: $(realurl).lazyRule(() => {\n            input = decodeURIComponent(input);\n            return 'hiker://page/push?rule=XYQ推送&pushurl=' + encodeURIComponent(input);\n        }),\n        col_type: \"text_2\",\n        desc: \"\",\n        pic_url: \"\"\n    }, {\n        title: \"☁️阿里APP打开💽\",\n        url: $(realurl).lazyRule(() => {\n            //input = decodeURIComponent(input);\n            const [link, _share_pwd] = decodeURIComponent(input).split('?share_pwd=');\n            const [_link, _folderID] = link.split('/folder/');\n            let share_pwd = (_share_pwd || '').split('#name=')[0] || '';\n            let shareId = _link.split('com/s/')[1];\n            return 'smartdrive://share/browse?shareId=' + shareId + '&sharePwd=' + share_pwd;\n        }),\n        col_type: \"text_2\",\n        desc: \"\",\n        pic_url: \"\"\n    });\n}\nif ((decodeURIComponent(realurl).includes('www.aliyundrive')||decodeURIComponent(realurl).includes('www.alipan')) && !realurl.includes('%3B%7B')) {\n    eval(JSON.parse(fetch('hiker://page/sharid', {})).rule)\n}\nsetResult(items);"},{"col_type":"movie_3","name":"推送代码","path":"pushcode","rule":"js:\nlet push = JSON.stringify({\n    \"name\": pushname,\n    \"url\": tuisong.join('#'),\n    \"share_id\": shareId,\n    \"refresh_token\": reftoken\n}).replace(/\\&/g, '＆＆');\nif (tuisong.length > 0) {\n    items.unshift({\n        title: \"📽推送当前页音视频📺\",\n        url: $(push).lazyRule(() => {\n            return 'hiker://page/push?rule=XYQ推送&pushurl=' + encodeURIComponent(input);\n        }),\n        col_type: \"scroll_button\"\n    });\n    items.unshift({\n        title: (getItem('quality', '') == '1' ? '原画播√' : '转码播√'),\n        url: `hiker://empty@lazyRule=.js:getItem('quality','0')=='1'?setItem('quality','0'):setItem('quality','1');refreshPage();'toast://切换成功！'`,\n        col_type: 'scroll_button'\n    });\n    items.unshift({\n        title: (getItem('singlepush', '') == '1' ? '单推√' : '单推╳'),\n        url: `hiker://empty@lazyRule=.js:getItem('singlepush','0')=='1'?setItem('singlepush','0'):setItem('singlepush','1');refreshPage();'toast://切换成功！'`,\n        col_type: 'scroll_button'\n    });\n}"},{"col_type":"movie_3","name":"分享资源一级","path":"sharid","rule":"js:\n//var items = [];\nfunction formatDate(_date, fmt) {\n    let date = !isNaN(_date) ? new Date(_date * 1000) : new Date(_date);\n    return $.dateFormat(date, fmt || \"yyyy-MM-dd HH:mm:ss\")\n}\n\nfunction formatSize(size) {\n    if (!size) {\n        return '';\n    }\n    const units = ['B', 'KB', 'MB', 'GB', 'TB', 'PB', 'EB', 'ZB', 'YB'];\n    let i = 0;\n    while (size >= 1024) {\n        size /= 1024;\n        i++;\n    }\n    size = i ? Number(size.toFixed(2)) : size;\n    return `${size} ${units[i]}`;\n}\n//log(realurl);\n\nif (MY_PAGE == 1) {\n    clearMyVar('nextpage');\n}\nif (MY_PAGE > 1 && getMyVar('nextpage', '') == '') {\n    log('没有下一页');\n} else {\n    try {\n        var reftoken = JSON.parse(fetch('hiker://files/rules/icy/icy-ali-token.json', {}))[0].refresh_token;\n        var shareId = decodeURIComponent(realurl).split('com/s/')[1].substring(0, 11);\n        let getshar = fetch('https://api.aliyundrive.com/adrive/v3/share_link/get_share_by_anonymous', {\n            headers: {\n                'Content-Type': 'application/json'\n            },\n            body: '{\"share_id\":\"' + shareId + '\"}',\n            method: 'POST'\n        });\n        //log(getshar);\n        if (getshar.includes(\"share_link is forbidden\")) {\n            items.push({\n                title: '文件违规，根据相关法律法规要求，该文件已禁止访问。',\n                url: decodeURIComponent(getResCode().split('##')[1]),\n                col_type: 'text_center_1'\n            });\n        }\n        if (getshar.includes(\"share_link is cancelled\") || getshar.includes(\"share_link is expired\")) {\n            items.push({\n                title: '来晚啦，该分享已失效。',\n                url: decodeURIComponent(getResCode().split('##')[1]),\n                col_type: 'text_center_1'\n            });\n        }\n        if (getshar.includes(\"share_link cannot be found\")) {\n            items.push({\n                title: '你打开的链接有误，请重试。',\n                url: decodeURIComponent(getResCode().split('##')[1]),\n                col_type: 'text_center_1'\n            });\n        }\n\n        let pushname = JSON.parse(getshar).file_infos[0].file_name;\n\n        var sharetoken = JSON.parse(fetch('https://api.aliyundrive.com/v2/share_link/get_share_token', {\n            headers: {\n                'Content-Type': 'application/json'\n            },\n            body: '{\"share_pwd\":\"\",\"share_id\":\"' + shareId + '\"}',\n            method: 'POST'\n        })).share_token;\n        //log(sharetoken);\n\n        let next = getMyVar('nextpage', '') != '' ? ',\"marker\":\"' + getMyVar('nextpage') + '\"' : '';\n        if (!decodeURIComponent(realurl).includes('/folder/')) {\n            //if(!listyp == 'folder'){\n            var rescod = fetch('https://api.aliyundrive.com/adrive/v3/file/list', {\n                headers: {\n                    'Content-Type': 'application/json',\n                    'X-Share-Token': sharetoken\n                },\n                body: '{\"share_id\":\"' + shareId + '\",\"parent_file_id\":\"root\",\"limit\":100,\"image_thumbnail_process\":\"image/resize,w_160/format,jpeg\",\"image_url_process\":\"image/resize,w_1920/format,jpeg\",\"video_thumbnail_process\":\"video/snapshot,t_1000,f_jpg,ar_auto,w_300\",\"order_by\":\"name\",\"order_direction\":\"ASC\"' + next + '}',\n                method: 'POST'\n            });\n            //log(rescod);\n            if (rescod.includes(\"ParamFlowException\")) {\n                refreshPage();\n            }\n            var listyp = JSON.parse(rescod).items[0].type;\n            var pfileid = JSON.parse(rescod).items[0].file_id;\n        } else {\n            var listyp = 'folder';\n            var pfileid = decodeURIComponent(realurl).split('folder/')[1]\n\n        }\n        //log(html);\n        if (listyp == 'folder') {\n            var rescod = fetch('https://api.aliyundrive.com/adrive/v3/file/list', {\n                headers: {\n                    'Content-Type': 'application/json',\n                    'X-Share-Token': sharetoken\n                },\n                body: '{\"share_id\":\"' + shareId + '\",\"parent_file_id\":\"' + pfileid + '\",\"limit\":100,\"image_thumbnail_process\":\"image/resize,w_160/format,jpeg\",\"image_url_process\":\"image\\/resize,w_1920/format,jpeg\",\"video_thumbnail_process\":\"video/snapshot,t_1000,f_jpg,ar_auto,w_300\",\"order_by\":\"name\",\"order_direction\":\"ASC\"' + next + '}',\n                method: 'POST'\n            });\n            if (rescod.includes(\"ParamFlowException\")) {\n                refreshPage();\n            }\n        } //取文件夹\n        //log(rescod);\n\n\n        if (JSON.parse(rescod).next_marker) {\n            let marker = JSON.parse(rescod).next_marker;\n            if (marker.length > 10) {\n                putMyVar('nextpage', marker);\n            } else {\n                clearMyVar('nextpage');\n            }\n        }\n        var conts = JSON.parse(rescod).items;\n        if (conts.length < 1) {\n            items.push({\n                title: '该文件夹下没有分享的文件',\n                url: 'hiker://empty',\n                col_type: 'text_center_1'\n            });\n        }\n        var dongtai = JSON.parse(fetch('hiker://page/lazyurl', {})).rule.toString();\n\n        var tuisong = [];\n        var zimu = [];\n        for (let i in conts) {\n            //var listyp = conts[i].type;\n            if (conts[i].type != 'folder') {\n                let fname = conts[i].name;\n                let ftype = fname.toLowerCase();\n                let cate = conts[i].category;\n                if (ftype.endsWith('.srt') || ftype.endsWith('.vtt') || ftype.endsWith('.ass')) {\n                    zimu.push({\n                        tit: fname.substring(0, fname.lastIndexOf(\".\")),\n                        ext: conts[i].file_extension,\n                        fid: conts[i].file_id\n                    });\n                };\n                if (cate == 'video' || cate == 'audio') {\n                    tuisong.push(\n                        fname.replace(/\\#/g, '_').replace(/\\$/g, '_') + '$' + cate + '|' + conts[i].file_id\n                    );\n                };\n            }\n        }\n\n        for (var i in conts) {\n            var listyp = conts[i].type;\n            if (listyp != 'folder') {\n                var cate = conts[i].category;\n                var fname = conts[i].name;\n                if (cate == 'video') {\n                    var title = '📺' + conts[i].name;\n                } else if (cate == 'doc') {\n                    var title = '📖' + conts[i].name;\n                } else if (cate == 'image') {\n                    var title = '🖼' + conts[i].name;\n                } else if (cate == 'zip') {\n                    var title = '📦' + conts[i].name;\n                } else {\n                    var title = conts[i].name\n                }\n\n                // if (cate == 'video' || cate == 'audio' || cate == 'image') {\n                items.push({\n                    title: title,\n                    url: $(conts[i].file_id).lazyRule((shareId, dongtai, cate, fname, reftoken, zimu) => {\n                        if (getItem('singlepush', '') == '1') {\n                            return 'hiker://page/push?rule=XYQ推送&pushurl=' + encodeURIComponent(JSON.stringify({\n                                \"name\": fname,\n                                \"refresh_token\": reftoken,\n                                \"url\": fname.replace(/\\#/g, '_').replace(/\\$/g, '_') + '$' + cate + '|' + input,\n                                \"share_id\": shareId\n                            }));\n                        } else {\n                            eval(dongtai);\n                            return play\n                        }\n                    }, shareId, dongtai, cate, fname, reftoken, zimu),\n                    desc: formatDate(conts[i].updated_at) + '  ' + formatSize(conts[i].size),\n                    extra: {\n                        longClick: [{\n                            title: '推送到TVBox',\n                            js: $.toString((shareId, fileid, cate, fname, reftoken) => {\n                                return 'hiker://page/push?rule=XYQ推送&pushurl=' + encodeURIComponent(JSON.stringify({\n                                    \"name\": fname,\n                                    \"refresh_token\": reftoken,\n                                    \"url\": fname.replace(/\\#/g, '_').replace(/\\$/g, '_') + '$' + cate + '|' + fileid,\n                                    \"share_id\": shareId\n                                }));\n                            }, shareId, conts[i].file_id, cate, fname, reftoken)\n                        }],\n                        id: conts[i].file_id\n                    },\n                    col_type: 'text_1'\n\n                });\n\n                /*} else if (i == 0) {\n                    items.push({\n                        title: '当前文件夹下没有音视频文件',\n                        url: 'hiker://empty',\n                        col_type: 'text_center_1'\n                    });\n                }*/\n\n            } else {\n                items.push({\n                    title: '📂' + conts[i].name,\n                    url: $('hiker://empty' + conts[i].file_id + '???fypage').rule((shareId, sharetoken, pushname) => {\n                        eval(JSON.parse(fetch('hiker://page/ruleloop', {})).rule);\n                    }, shareId, sharetoken, conts[i].name),\n                    col_type: 'flex_button'\n                });\n\n            } //end if\n        } //end for i\n        //log(tuisong);\n        eval(JSON.parse(fetch('hiker://page/pushcode', {})).rule);\n\n    } catch (e) {\n        /*\n        items.push({\n            title: '欧欧，报错了。',\n            url: decodeURIComponent(getResCode().split('##')[1]),\n            col_type: 'text_center_1'\n        });\n        */\n    }\n}\n/*\nsetHomeResult({\n    data: items\n});\n*/"},{"col_type":"movie_3","name":"分享资源嵌套","path":"ruleloop","rule":"var items = [];\n\nfunction formatDate(_date, fmt) {\n    let date = !isNaN(_date) ? new Date(_date * 1000) : new Date(_date);\n    return $.dateFormat(date, fmt || \"yyyy-MM-dd HH:mm:ss\")\n}\n\nfunction formatSize(size) {\n    if (!size) {\n        return '';\n    }\n    const units = ['B', 'KB', 'MB', 'GB', 'TB', 'PB', 'EB', 'ZB', 'YB'];\n    let i = 0;\n    while (size >= 1024) {\n        size /= 1024;\n        i++;\n    }\n    size = i ? Number(size.toFixed(2)) : size;\n    return `${size} ${units[i]}`;\n}\n\n//log(getResCode());\nif (MY_PAGE == 1) {\n    clearMyVar('nextpage');\n    items.unshift({\n        title: \"📽推送当前文件夹📺\",\n        url: $('https://www.aliyundrive.com/s/' + shareId + '/folder/' + getResCode().split('???')[0]).lazyRule(() => {\n            return 'hiker://page/push?rule=XYQ推送&pushurl=' + encodeURIComponent(input);\n        }),\n        col_type: \"scroll_button\"\n    });\n}\nif (MY_PAGE > 1 && getMyVar('nextpage', '') == '') {\n    log('没有下一页');\n} else {\n    let reftoken = JSON.parse(fetch('hiker://files/rules/icy/icy-ali-token.json', {}))[0].refresh_token;\n\n    let next = getMyVar('nextpage', '') != '' ? ',\"marker\":\"' + getMyVar('nextpage') + '\"' : '';\n\n    var rescod = fetch('https://api.aliyundrive.com/adrive/v3/file/list', {\n        headers: {\n            'Content-Type': 'application/json',\n            'X-Share-Token': sharetoken\n        },\n        body: '{\"share_id\":\"' + shareId + '\",\"parent_file_id\":\"' + getResCode().split('???')[0] + '\",\"limit\":100,\"image_thumbnail_process\":\"image/resize,w_160/format,jpeg\",\"image_url_process\":\"image\\/resize,w_1920/format,jpeg\",\"video_thumbnail_process\":\"video/snapshot,t_1000,f_jpg,ar_auto,w_300\",\"order_by\":\"name\",\"order_direction\":\"ASC\"' + next + '}',\n        method: 'POST'\n    });\n    //log(rescod);\n    if (rescod.includes(\"ParamFlowException\")) {\n        refreshPage();\n    }\n    if (JSON.parse(rescod).next_marker) {\n        let marker = JSON.parse(rescod).next_marker;\n        if (marker.length > 10) {\n            putMyVar('nextpage', marker);\n        } else {\n            clearMyVar('nextpage');\n        }\n    }\n    var conts = JSON.parse(rescod).items;\n    /*\n    if (conts.length < 1) {\n        items.push({\n            title: '该文件夹下没有分享的文件',\n            url: 'hiker://empty',\n            col_type: 'text_center_1'\n        });\n    }\n    */\n    var dongtai = JSON.parse(fetch('hiker://page/lazyurl', {})).rule.toString();\n    \n    var tuisong = [];\n    var zimu = [];\n    for (let i in conts) {\n        //var listyp = conts[i].type;\n        if (conts[i].type != 'folder') {\n            let fname = conts[i].name;\n            let ftype = fname.toLowerCase();\n            let cate = conts[i].category;\n            if (ftype.endsWith('.srt') || ftype.endsWith('.vtt') || ftype.endsWith('.ass')) {\n                zimu.push({\n                    tit: fname.substring(0, fname.lastIndexOf(\".\")),\n                    ext: conts[i].file_extension,\n                    fid: conts[i].file_id\n                });\n            };\n            if (cate == 'video' || cate == 'audio') {\n                tuisong.push(\n                    fname.replace(/\\#/g, '_').replace(/\\$/g, '_') + '$' + cate + '|' + conts[i].file_id\n                );\n            };\n        }\n    }\n    \n    for (var i in conts) {\n        var listyp = conts[i].type;\n        if (listyp != 'folder') {\n            var cate = conts[i].category;\n            var fname = conts[i].name;\n            if (cate == 'video') {\n                var title = '📺' + conts[i].name;\n            } else if (cate == 'doc') {\n                var title = '📖' + conts[i].name;\n            } else if (cate == 'image') {\n                var title = '🖼' + conts[i].name;\n            } else if (cate == 'zip') {\n                var title = '📦' + conts[i].name;\n            } else {\n                var title = conts[i].name\n            }\n            //if (cate == 'video' || cate == 'audio' || cate == 'image') {\n            items.push({\n                title: title,\n                url: $(conts[i].file_id).lazyRule((shareId, dongtai, cate, fname, reftoken,zimu) => {\n                    if (getItem('singlepush', '') == '1') {\n                        return 'hiker://page/push?rule=XYQ推送&pushurl=' + encodeURIComponent(JSON.stringify({\n                            \"name\": fname,\n                            \"refresh_token\": reftoken,\n                            \"url\": fname.replace(/\\#/g, '_').replace(/\\$/g, '_') + '$' + cate + '|' + input,\n                            \"share_id\": shareId\n                        }));\n                    } else {\n                        eval(dongtai);\n                        return play\n                    }\n                }, shareId, dongtai, cate, fname, reftoken,zimu),\n                desc: formatDate(conts[i].updated_at) + '  ' + formatSize(conts[i].size),\n                extra: {\n                    longClick: [{\n                        title: '推送到TVBox',\n                        js: $.toString((shareId, fileid, cate, fname, reftoken) => {\n                            return 'hiker://page/push?rule=XYQ推送&pushurl=' + encodeURIComponent(JSON.stringify({\n                                \"name\": fname,\n                                \"refresh_token\": reftoken,\n                                \"url\": fname.replace(/\\#/g, '_').replace(/\\$/g, '_') + '$' + cate + '|' + fileid,\n                                \"share_id\": shareId\n                            }));\n                        }, shareId, conts[i].file_id, cate, fname, reftoken)\n                    }],\n                    id: conts[i].file_id\n                },\n                col_type: 'text_1'\n\n            });\n            //}\n        } else {\n            items.push({\n                title: '📂' + conts[i].name,\n                url: $('hiker://empty' + conts[i].file_id + '???fypage').rule((shareId, sharetoken, pushname) => {\n                    eval(JSON.parse(fetch('hiker://page/ruleloop', {})).rule);\n                }, shareId, sharetoken, conts[i].name),\n                col_type: 'flex_button'\n            });\n\n        } //end if\n\n\n    }\n    eval(JSON.parse(fetch('hiker://page/pushcode', {})).rule);\n}\nsetHomeResult({\n    data: items\n});"},{"col_type":"movie_3","name":"分享资源动态解析","path":"lazyurl","rule":"var defdriveid = getMyVar('defdriveid', ''),\n    reaccessTk = getMyVar(\"aliaccessTk\", ''),\n    timeToken = getMyVar('timeToken', '0'),\n    stToken = getMyVar('stToken', '0'),\n    shareiid = getMyVar('shareiid', shareId),\n    sharetoken = getItem('sharetoken', ''),\n    resdriveid = getMyVar('resdriveid', ''),\n    ftype = fname.toLowerCase();\n//log((parseInt(timeToken) - parseInt(new Date().getTime() / 1000)).toString());\nfunction accessTk() {\n    if (reaccessTk == '' || (parseInt(timeToken) - parseInt(new Date().getTime() / 1000)).toString() <= 3600) {\n        log('刷新reaccessTk');\n        let ntoken = JSON.parse(fetch('hiker://files/rules/icy/icy-ali-token.json', {}));\n        var reftoken = ntoken[0].refresh_token;\n        let refresh = fetch('https://auth.aliyundrive.com/v2/account/token', {\n            headers: {\n                'User-Agent': PC_UA,\n                'Content-Type': 'application/json',\n                'Referer': 'https://www.aliyundrive.com/'\n            },\n            body: '{\"refresh_token\":\"' + reftoken + '\",\"grant_type\":\"refresh_token\"}',\n            method: 'POST'\n        });\n        ntoken[0] = JSON.parse(refresh);\n        if (!fileExist(\"hiker://files/rules/icy/icy-ali-token.json\") || refresh.length > 300) {\n            writeFile(\"hiker://files/rules/icy/icy-ali-token.json\", JSON.stringify(ntoken));\n        }\n        putMyVar('timeToken', (parseInt(JSON.parse(refresh).expires_in) + parseInt(new Date().getTime() / 1000)).toString());\n        defdriveid = JSON.parse(refresh).default_drive_id;\n        putMyVar('defdriveid', defdriveid);\n        reaccessTk = JSON.parse(refresh).token_type + ' ' + JSON.parse(refresh).access_token;\n        putMyVar(\"aliaccessTk\", reaccessTk);\n\n    }\n};\n\nfunction resourceID() {\n    let userresinfo = JSON.parse(fetch(\"https://user.aliyundrive.com/v2/user/get\", {\n        headers: {\n            'content-type': 'application/json',\n            'User-Agent': PC_UA,\n            \"authorization\": reaccessTk,\n            'Referer': 'https://www.aliyundrive.com/'\n        },\n        body: {},\n        method: 'POST'\n    }));\n    if (userresinfo.resource_drive_id) {\n        resdriveid = userresinfo.resource_drive_id;\n        putMyVar('resdriveid', resdriveid);\n    }\n}\n\naccessTk();\nresourceID();\n//刷新sharetoken\nif (shareiid != shareId || (parseInt(stToken) - parseInt(new Date().getTime() / 1000)).toString() <= 3600) {\n    var sharetk = fetch('https://api.aliyundrive.com/v2/share_link/get_share_token', {\n        headers: {\n            'User-Agent': PC_UA,\n            'Content-Type': 'application/json'\n        },\n        body: '{\"share_pwd\":\"\",\"share_id\":\"' + shareId + '\"}',\n        method: 'POST'\n    });\n    log('刷新sharetoken');\n    sharetoken = JSON.parse(sharetk).share_token;\n    setItem('sharetoken', JSON.parse(sharetk).share_token);\n    putMyVar('stToken', (parseInt(JSON.parse(sharetk).expires_in) + parseInt(new Date().getTime() / 1000)).toString());\n    putMyVar('shareiid', shareId);\n}\n//log(zimu);\nconst transcoding = {\n    UHD: \"4K 超清\",\n    QHD: \"2K 超清\",\n    FHD: \"1080 全高清\",\n    HD: \"720 高清\",\n    SD: \"540 标清\",\n    LD: \"360 流畅\"\n};\nif (!fileExist(\"hiker://files/rules/icy/icy-ali-OpenToken.json\")) {\n    var OpenToken = {\n        'RefreshTokenOpen': '',\n        'AccessTokenOpen': ''\n    };\n} else {\n    var OpenToken = JSON.parse(fetch('hiker://files/rules/icy/icy-ali-OpenToken.json', {}));\n}\n//var reftoken = JSON.parse(fetch('hiker://files/rules/icy/icy-ali-token.json', {}))[0].refresh_token;\nfunction getsub(zmfid, zmext) {\n    try {\n        var json = fetch('https://api.aliyundrive.com/v2/file/get_share_link_download_url', {\n            headers: {\n                'Content-Type': 'application/json',\n                'Authorization': reaccessTk,\n                'X-Share-Token': sharetoken\n            },\n            body: '{\"share_id\":\"' + shareId + '\",\"file_id\":\"' + zmfid + '\"}',\n            method: 'POST'\n        });\n        //log(json);\n        let zimul = JSON.parse(json).download_url;\n        downloadFile(zimul, 'hiker://files/download/subtitling.' + zmext, {\n            'Referer': 'https://www.aliyundrive.com/'\n        });\n        return getPath('hiker://files/download/subtitling.' + zmext)\n        //return zimul\n    } catch (e) {\n        return \"\";\n    }\n}\n\nfunction aliSharePlayUrl(share_id, file_id, alitoken) {\n    try {\n        function getNowTime() {\n            const yy = new Date().getFullYear()\n            const MM = (new Date().getMonth() + 1) < 10 ? '0' + (new Date().getMonth() + 1) : (new Date().getMonth() + 1)\n            const dd = new Date().getDate() < 10 ? '0' + new Date().getDate() : new Date().getDate()\n            const HH = new Date().getHours() < 10 ? '0' + new Date().getHours() : new Date().getHours()\n            const mm = new Date().getMinutes() < 10 ? '0' + new Date().getMinutes() : new Date().getMinutes()\n            return yy + '' + dd + '' + HH + '' + MM + '' + mm\n        }\n\n        let sharetoken = JSON.parse(request('https://api.aliyundrive.com/v2/share_link/get_share_token', {\n            body: {\n                \"share_pwd\": \"\",\n                \"share_id\": share_id\n            },\n            method: 'POST',\n            timeout: 3000\n        })).share_token;\n\n        let headers = {\n            'content-type': 'application/json;charset=UTF-8',\n            \"origin\": \"https://www.aliyundrive.com\",\n            \"referer\": \"https://www.aliyundrive.com/\",\n            //\"user-agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/110.0.0.0 Safari/537.36\",\n            \"user-agent\": PC_UA,\n            \"x-canary\": \"client=web,app=adrive,version=v3.1.0\"\n        };\n        let nowtime = Date.now();\n        let oldtime = parseInt(getMyVar('userinfoChecktime', '0').replace('time', ''));\n        let userinfo;\n        let aliuserinfo = storage0.getMyVar('aliuserinfo');\n        if (aliuserinfo && aliuserinfo.user_id && nowtime < (oldtime + 1 * 60 * 60 * 1000)) {\n            userinfo = aliuserinfo;\n        } else {\n            userinfo = JSON.parse(request('https://auth.aliyundrive.com/v2/account/token', {\n                headers: headers,\n                body: {\n                    \"refresh_token\": alitoken,\n                    \"grant_type\": \"refresh_token\"\n                },\n                method: 'POST',\n                timeout: 3000\n            }));\n            storage0.putMyVar('aliuserinfo', userinfo);\n            putMyVar('userinfoChecktime', nowtime + 'time');\n        }\n        let authorization = 'Bearer ' + userinfo.access_token;\n        let deviceId = userinfo.device_id;\n        let userId = userinfo.user_id;\n        let signature;\n\n        let as = justTestSign(\"5dde4e1bdf9e4966b387ba58f4b3fdc3\", deviceId, userId);\n        //log(a);\n        let bp = as.split(\"##\");\n        var sign = bp[0];\n        var pubKey = bp[bp.length - 1];\n\n        let i = 0;\n        do {\n\n            let sess = fetch('https://api.aliyundrive.com/users/v1/users/device/create_session', {\n                headers: {\n                    'Content-Type': 'application/json',\n                    'User-Agent': PC_UA,\n                    'Referer': 'https://www.aliyundrive.com/',\n                    'Authorization': authorization,\n                    'X-Share-Token': sharetoken,\n                    'x-device-id': deviceId,\n                    'x-signature': sign\n                },\n                body: '{\"deviceName\":\"Chrome浏览器\",\"modelName\":\"Windows网页版\",\"nonce\":0,\"pubKey\":\"' + pubKey + '\",\"refreshToken\":\"' + alitoken + '\"}',\n                method: 'POST'\n            });\n            if (sess.includes('success')) {\n                break;\n            }\n            log('create_session ' + sess);\n            as = justTestSign(\"5dde4e1bdf9e4966b387ba58f4b3fdc3\", deviceId, userId);\n            //log(a);\n            bp = as.split(\"##\");\n            sign = bp[0];\n            pubKey = bp[bp.length - 1];\n            i++;\n        } while (i < 5);\n\n        signature = sign;\n        headers['authorization'] = authorization;\n        headers['x-device-id'] = deviceId;\n        headers['x-signature'] = signature;\n        let aliyunUrl = [];\n        headers['x-share-token'] = sharetoken;\n        headers['fileid'] = userId;\n        let data = {\n            \"category\": \"live_transcoding\",\n            \"file_id\": file_id,\n            \"get_preview_url\": true,\n            \"share_id\": share_id,\n            \"template_id\": \"\",\n            \"get_subtitle_info\": true\n        }\n        //log(data);\n        let json = JSON.parse(request('https://api.aliyundrive.com/v2/file/get_share_link_video_preview_play_info', {\n            headers: headers,\n            body: data,\n            method: 'POST',\n            timeout: 3000\n        }));\n        aliyunUrl = json.video_preview_play_info.live_transcoding_task_list;\n        aliyunUrl.reverse();\n\n        return aliyunUrl;\n    } catch (e) {\n        log('根据共享链接获取播放地址失败>' + e.message);\n        return \"\";\n    }\n}\n\nfunction getAliUrl(share_id, file_id, alitoken) {\n    try {\n        let urls = [];\n        let names = [];\n        let heads = [];\n        let u = startProxyServer($.toString((aliSharePlayUrl, file_id, share_id, alitoken) => {\n            function geturl(fileid, line) {\n                //预加载时会变file_id,所以ts过期更新时还取原来的id\n                let playUrlList = aliSharePlayUrl(share_id, fileid, alitoken) || [];\n                let aliurl;\n                playUrlList.forEach((item) => {\n                    if (item.template_id == line) {\n                        aliurl = item.url;\n                        /*aliurl = JSON.parse(request(item.url, {\n                            headers: {\n                                'User-Agent': PC_UA,\n                                'Referer': 'https://www.aliyundrive.com/'\n                            },\n                            onlyHeaders: true,\n                            redirect: false,\n                            timeout: 3000\n                        })).headers.location[0];*/\n                    }\n                })\n                //上面是获取阿里的播放地址\n                //log(\"我在代理\" + aliurl);\n                let home = aliurl.split('media.m3u8')[0];\n                let f = fetch(aliurl, {\n                    headers: {\n                        'User-Agent': PC_UA,\n                        'Referer': 'https://www.aliyundrive.com/'\n                    },\n                    timeout: 3000\n                }).split(\"\\n\");\n                let ff = f.map(it => {\n                    if (it.startsWith(\"media-\")) {\n                        return \"/proxy?url=\" + base64Encode(home + it);\n                    }\n                    return it;\n                }).join(\"\\n\");\n                //log('ufid-'+fileid);\n                writeFile('hiker://files/cache/_fileSelect_' + fileid + '.m3u8', ff);\n                return ff;\n            }\n            let url = base64Decode(MY_PARAMS.url);\n            if (url.includes(\".ts\")) {\n                let fid = url.split('&f=')[1].split('&')[0];\n                //log('sfid-'+fid);\n                let f = fetch('hiker://files/cache/_fileSelect_' + fid + '.m3u8').split(\"\\n\");\n                f.forEach(it => {\n                    if (it && it.startsWith('/proxy?url=')) {\n                        let furl = base64Decode(it.replace('/proxy?url=', ''));\n                        if (url.substr(url.indexOf('/media-'), url.indexOf('.ts')) == furl.substr(furl.indexOf('/media-'), furl.indexOf('.ts'))) {\n                            url = furl;\n                        }\n                    }\n                })\n                let expires = url.split('x-oss-expires=')[1].split('&')[0];\n                const lasttime = parseInt(expires) - Date.now() / 1000;\n                if (lasttime < 60) {\n                    //log('过期更新')\n                    let line = url.split('/media')[0]; //取之前播放的ts段线路\n                    line = line.substring(line.lastIndexOf('/') + 1);\n                    let f = geturl(fid, line).split(\"\\n\");\n                    f.forEach(it => {\n                        if (it && it.startsWith('/proxy?url=')) {\n                            let furl = base64Decode(it.replace('/proxy?url=', ''));\n                            if (url.substr(url.indexOf('/media-'), url.indexOf('.ts')) == furl.substr(furl.indexOf('/media-'), furl.indexOf('.ts'))) {\n                                url = furl;\n                            }\n                        }\n                    })\n\n                } else {\n                    //log('未过期')\n                    //log(\"代理ts：\" + url);\n                }\n                return JSON.stringify({\n                    statusCode: 302,\n                    headers: {\n                        \"Location\": url,\n                        \"User-Agent\": PC_UA,\n                        'Referer': 'https://www.aliyundrive.com/'\n                    }\n                });\n            } else {\n                //log('首次更新')\n                let line = url.split('|')[1];\n                let ff = geturl(file_id, line);\n                return ff;\n            }\n        }, aliSharePlayUrl, file_id, share_id, alitoken));\n\n        let playUrlList = aliSharePlayUrl(share_id, file_id, alitoken) || [];\n\n        if (playUrlList.length > 0) {\n            playUrlList.forEach((item) => {\n                urls.push(u + \"?url=\" + base64Encode(item.url + \"|\" + item.template_id) + \"#.m3u8\");\n                names.push(transcoding[item.template_id] ? transcoding[item.template_id] : item.template_height);\n                heads.push({\n                    'User-Agent': PC_UA,\n                    'Referer': 'https://www.aliyundrive.com/'\n                });\n            })\n            var mult = {\n                urls: urls,\n                names: names,\n                headers: heads\n            };\n            if (zimu.length > 0) {\n                for (let i in zimu) {\n                    var zimut = zimu[i].tit;\n                    if (fname.includes(zimut) || zimut.includes(fname.substring(0, fname.lastIndexOf('.')))) {\n                        mult['subtitle'] = getsub(zimu[i].fid, zimu[i].ext);\n                        break;\n                    }\n                }\n            }\n\n            return mult;\n        } else {\n            log('未获取阿里播放地址，建议重进软件再试一次')\n            return {};\n        }\n    } catch (e) {\n        log('获取共享链接播放地址失败>' + e.message);\n        return {};\n    }\n}\n\nif (cate == 'video') {\n    //log(reaccessTk); \n    if (getItem('quality', '') == '1') {\n        //原画\n        //accessTk();\n\n        function oauthRedirect(code) {\n            //log(code);\n            try {\n                if (getMyVar('ored', '1') != '0') {\n                    let json = fetch('https://api.xhofe.top/alist/ali_open/code', {\n                        headers: {\n                            'User-Agent': PC_UA,\n                            'Referer': 'https://www.aliyundrive.com/'\n\n                        },\n                        body: {\n                            \"code\": code,\n                            \"grant_type\": \"authorization_code\"\n                        },\n                        method: 'POST'\n                    });\n                    if (json == \"\" || !JSON.parse(json)) {\n                        json = fetch('https://api-cf.nn.ci/alist/ali_open/code', {\n                            headers: {\n                                'User-Agent': PC_UA,\n                                'Referer': 'https://www.aliyundrive.com/'\n\n                            },\n                            body: {\n                                \"code\": code,\n                                \"grant_type\": \"authorization_code\"\n                            },\n                            method: 'POST'\n                        });\n                    }\n                    log('获取RefreshTokenOpen');\n                    if (json.includes('Too Many Requests')) {\n                        putMyVar('ored', '0');\n                        toast('请求太频繁，被封限制了');\n                        //log('请求太频繁，被封IP了');\n                        return '';\n                    } else {\n                        putMyVar('ored', '1');\n                        if (JSON.parse(json).refresh_token) {\n                            let getRefreshTokenOpen = JSON.parse(json).refresh_token;\n                            OpenToken.RefreshTokenOpen = getRefreshTokenOpen;\n                            let getAccessTokenOpen = JSON.parse(json).token_type + ' ' + JSON.parse(json).access_token;\n                            OpenToken.AccessTokenOpen = getAccessTokenOpen;\n                            writeFile(\"hiker://files/rules/icy/icy-ali-OpenToken.json\", JSON.stringify(OpenToken));\n                            putMyVar('redirect', '1');\n                        }\n                    }\n                }\n            } catch (e) {}\n        };\n\n        function oauthRequest() {\n            try {\n                let json = fetch('https://open.aliyundrive.com/oauth/users/authorize?client_id=' + '76917ccccd4441c39457a04f6084fb2f' + '&redirect_uri=https://alist.nn.ci/tool/aliyundrive/callback&scope=user:base,file:all:read,file:all:write&state=', {\n                    headers: {\n                        'User-Agent': PC_UA,\n                        'Referer': 'https://www.aliyundrive.com/',\n                        'authorization': reaccessTk, //getAccessToken\n                        'x-canary': 'client=web,app=share,version=v2.3.1',\n                        'x-share-token': sharetoken\n\n                    },\n                    body: {\n                        \"authorize\": 1,\n                        \"scope\": \"user:base,file:all:read,file:all:write\"\n                    },\n                    method: 'POST'\n                });\n                //log('oauthreq\\n' + json);\n                if (json.includes('AccessTokenExpired')) {\n                    reaccessTk = '';\n                    accessTok();\n                }\n                let code = JSON.parse(json).redirectUri.split(\"code=\")[1];\n                //log(code);\n                oauthRedirect(code);\n            } catch (e) {\n                reaccessTk = '';\n                accessTk();\n            }\n        };\n\n        function refreshOpenToken() {\n            try {\n                if (getMyVar('rot', '1') != '0') {\n                    let json = fetch('https://api.xhofe.top/alist/ali_open/token', {\n                        headers: {\n                            'User-Agent': PC_UA,\n                            'Referer': 'https://www.aliyundrive.com/'\n                        },\n                        body: {\n                            'grant_type': 'refresh_token',\n                            'refresh_token': OpenToken.RefreshTokenOpen\n                        },\n                        method: 'POST'\n                    });\n                    if (json == \"\" || !JSON.parse(json)) {\n                        json = fetch('https://api-cf.nn.ci/alist/ali_open/code', {\n                            headers: {\n                                'User-Agent': PC_UA,\n                                'Referer': 'https://www.aliyundrive.com/'\n                            },\n                            body: {\n                                'grant_type': 'refresh_token',\n                                'refresh_token': OpenToken.RefreshTokenOpen\n                            },\n                            method: 'POST'\n                        });\n                    }\n                    log('获取AccessTokenOpen');\n                    if (json.includes('Too Many Requests')) {\n                        putMyVar('rot', '0');\n                        toast('请求太频繁，被封限制了');\n                        //log('请求太频繁，被封IP了');\n                        return '';\n                    } else {\n                        putMyVar('rot', '1');\n                        if (JSON.parse(json).refresh_token) {\n                            let getRefreshTokenOpen = JSON.parse(json).refresh_token;\n                            OpenToken.RefreshTokenOpen = getRefreshTokenOpen;\n                            let getAccessTokenOpen = JSON.parse(json).token_type + ' ' + JSON.parse(json).access_token;\n                            OpenToken.AccessTokenOpen = getAccessTokenOpen;\n                            writeFile(\"hiker://files/rules/icy/icy-ali-OpenToken.json\", JSON.stringify(OpenToken));\n                        }\n                    }\n                }\n            } catch (e) {}\n        };\n\n        function copy(fileId) {\n            try {\n                let json = fetch('https://api.aliyundrive.com/adrive/v2/batch', {\n                    headers: {\n                        'User-Agent': PC_UA,\n                        'Referer': 'https://www.aliyundrive.com/',\n                        'authorization': reaccessTk,\n                        //getAccessToken\n                        'x-canary': 'client=web,app=share,version=v2.3.1',\n                        'x-share-token': sharetoken\n\n                    },\n                    body: {\n                        \"requests\": [{\n                            \"body\": {\n                                \"file_id\": fileId,\n                                \"share_id\": shareId,\n                                \"auto_rename\": true,\n                                \"to_parent_file_id\": \"root\",\n                                \"to_drive_id\": defdriveid\n                            },\n                            \"headers\": {\n                                \"Content-Type\": \"application/json\"\n                            },\n                            \"id\": \"0\",\n                            \"method\": \"POST\",\n                            \"url\": \"/file/copy\"\n                        }],\n                        \"resource\": \"file\"\n                    },\n                    method: 'POST'\n                });\n                //log('copy\\n' + json);\n                if (json.includes('AccessTokenExpired')) {\n                    reaccessTk = '';\n                    accessTok();\n                }\n                return JSON.parse(json).responses[0].body.file_id;\n            } catch (e) {\n                return \"\";\n            }\n        };\n\n        function open(fileId) {\n            try {\n                let json = \"\";\n                let number = 0;\n                do {\n                    json = fetch('https://open.aliyundrive.com/adrive/v1.0/openFile/getDownloadUrl', {\n                        headers: {\n                            'User-Agent': PC_UA,\n                            'Referer': 'https://www.aliyundrive.com/',\n                            'authorization': OpenToken.AccessTokenOpen\n                            //getAccessTokenOpen\n\n                        },\n                        body: {\n                            'file_id': fileId,\n                            'drive_id': defdriveid\n                        },\n                        method: 'POST'\n                    });\n                    //log('open\\n' + json);\n                    if (json.includes('\"url\":\"http')) {\n                        break;\n                    }\n                    if (json.includes(\"TooManyRequests\")) {\n                        //deletee(fileId);\n                        toast('Too Many Requests');\n                    }\n                    if (getMyVar('redirect', '0') == '0') {\n                        oauthRequest();\n                    } else {\n                        refreshOpenToken();\n                    }\n                    number++\n                } while (number < 2);\n                //deletee(fileId);\n                if (json.includes('http')) {\n                    return JSON.parse(json).url + '#isVideo=true#;{Referer@https://www.aliyundrive.com/}';\n                } else {\n                    log(json);\n                    return \"hiker://empty\";\n                }\n            } catch (e) {\n                return \"hiker://empty\";\n            }\n        };\n\n        function deletee(fileId) {\n\n            fetch('https://api.aliyundrive.com/adrive/v2/batch', {\n                headers: {\n                    'User-Agent': PC_UA,\n                    'Referer': 'https://www.aliyundrive.com/',\n                    'authorization': reaccessTk,\n                    'x-canary': 'client=web,app=share,version=v2.3.1',\n                    'x-share-token': sharetoken\n\n                },\n                body: {\n                    \"requests\": [{\n                        \"body\": {\n                            \"drive_id\": defdriveid,\n                            \"file_id\": fileId\n                        },\n                        \"headers\": {\n                            \"Content-Type\": \"application/json\"\n                        },\n                        \"id\": fileId,\n                        \"method\": \"POST\",\n                        \"url\": \"/file/delete\"\n                    }],\n                    \"resource\": \"file\"\n                },\n                method: 'POST'\n            });\n            //log('删除 ' + del);\n            /*\n            fetch('https://open.aliyundrive.com/adrive/v1.0/openFile/delete', {\n                headers: {\n                    'User-Agent': PC_UA,\n                    'Referer': 'https://www.aliyundrive.com/',\n                    'authorization': getItem('getAccessTokenOpen', ''),\n                    'x-share-token': sharetoken\n\n\n                },\n                body: {\n                    \"drive_id\": defdriveid,\n                    \"file_id\": fileId\n                },\n                method: 'POST'\n            });\n            */\n            //log('dele\\n' + json);\n        };\n\n        //处理视频  \n        var dsid = shareId;\n        var dfid = input;\n        if (resdriveid != null && resdriveid != \"\") {\n            defdriveid = resdriveid;\n        }\n        let fileId = copy(dfid);\n        var play = open(fileId);\n        if (fileId.length > 0) {\n            deletee(fileId);\n        }\n        if (zimu.length > 0) {\n            for (let i in zimu) {\n                var zimut = zimu[i].tit;\n                if (fname.includes(zimut) || zimut.includes(fname.substring(0, fname.lastIndexOf('.')))) {\n                    play = JSON.stringify({\n                        urls: [play.split(';{')[0]],\n                        headers: [{\n                            'Referer': 'https://www.aliyundrive.com/'\n                        }],\n                        subtitle: getsub(zimu[i].fid, zimu[i].ext)\n                    })\n                    break;\n                }\n            }\n        }\n    } else {\n        //普画  \n        var dsid = shareId;\n        var dfid = input;\n\n        if (cate == 'video') {\n            var play = JSON.stringify(getAliUrl(\n                shareId,\n                input,\n                reftoken\n            ));\n        }\n    }\n} else if (cate == 'image') {\n    //处理文档\n    //accessTk();\n\n    var json = fetch('https://api.aliyundrive.com/v2/file/get_share_link_download_url', {\n        headers: {\n            'Content-Type': 'application/json',\n            'Authorization': reaccessTk,\n            'X-Share-Token': sharetoken\n        },\n        body: '{\"share_id\":\"' + shareId + '\",\"expire_sec\": 600,\"file_id\":\"' + input + '\"}',\n        method: 'POST'\n    });\n\n    //log(json);\n    /*\n        var loclink = JSON.parse(fetch(JSON.parse(json).download_url, {\n            headers: {\n                'User-Agent': MOBILE_UA,\n                'Content-Type': 'application/x-www-form-urlencoded',\n                'Referer': 'https://www.aliyundrive.com/'\n            },\n            redirect: false,\n            withStatusCode: true\n        })).headers.location[0];\n        */\n    var loclink = JSON.parse(json).download_url;\n    //log(loclink);\n    if (cate == 'image') {\n        var play = 'pics://' + loclink + '@Referer=https://www.aliyundrive.com/';\n    } else {\n        var play = loclink + ';{Referer@https://www.aliyundrive.com/}';\n    }\n} else if (cate == 'audio') {\n    var json = fetch('https://api.aliyundrive.com/v2/file/get_share_link_download_url', {\n        headers: {\n            'Content-Type': 'application/json',\n            'Authorization': reaccessTk,\n            'X-Share-Token': sharetoken\n        },\n        body: '{\"share_id\":\"' + shareId + '\",\"get_audio_play_info\": true,\"file_id\":\"' + input + '\"}',\n        method: 'POST'\n    });\n    //log(json);\n    var play = JSON.parse(json).download_url + '#isMusic=true#;{Referer@https://www.aliyundrive.com/}';\n} else if (ftype.endsWith('.srt') || ftype.endsWith('.vtt') || ftype.endsWith('.ass')) {\n    var json = fetch('https://api.aliyundrive.com/v2/file/get_share_link_download_url', {\n        headers: {\n            'Content-Type': 'application/json',\n            'Authorization': reaccessTk,\n            'X-Share-Token': sharetoken\n        },\n        body: '{\"share_id\":\"' + shareId + '\",\"file_id\":\"' + input + '\"}',\n        method: 'POST'\n    });\n    //log(json);\n    var zimul = JSON.parse(json).download_url;\n    downloadFile(zimul, 'hiker://files/download/XYQ_subtitling' + fname.substring(fname.lastIndexOf(\".\")), {\n        'Referer': 'https://www.aliyundrive.com/'\n    });\n    var play = 'toast://字幕文件已下载到hiker://files/download/XYQ_subtitling' + fname.substring(fname.lastIndexOf(\".\"))\n    // + ';{Referer@https://www.aliyundrive.com/}';\n} else {\n    var play = 'toast://该格式暂未支持，目前只支持视频。'\n}"},{"col_type":"movie_3","name":"登入账号","path":"Login","rule":"d.push({\n    title: \"⛅️点我网页登录\",\n    url: $(\"hiker://empty###noRecordHistory##noHistory#\").rule(() => {\n        let d = [];\n        let ntoken = [];\n        if (fileExist(\"hiker://files/rules/icy/icy-ali-token.json\")) {\n            ntoken = JSON.parse(fetch('hiker://files/rules/icy/icy-ali-token.json', {}));\n        }\n        let url = 'https://www.aliyundrive.com/sign'\n        let js = $.toString((ntoken) => {\n            const tokenFunction = function() {\n                var stor = \"\";\n                if (localStorage.getItem('token') != null) {\n                    stor = localStorage.getItem(\"token\");\n                } else {\n                    stor = sessionStorage.getItem(\"token\");\n                }\n                var token = JSON.parse(stor);\n                if (token && token.user_id) {\n                    let alistfile = \"hiker://files/rules/icy/icy-ali-token.json\";\n                    ntoken[0] = token;\n                    fy_bridge_app.writeFile(alistfile, JSON.stringify(ntoken));\n                    localStorage.clear();\n                    alert('TOKEN获取成功，返回后刷新页面！');\n                    fy_bridge_app.parseLazyRule(`hiker://empty@lazyRule=.js:refreshX5WebView('');`);\n                    fy_bridge_app.back();\n                    return;\n                } else {\n                    token_timer();\n                }\n            }\n            var token_timer = function() {\n                setTimeout(tokenFunction, 500)\n            };\n            tokenFunction();\n        }, ntoken)\n        d.push({\n            url: url,\n            col_type: 'x5_webview_single',\n            desc: '100%&&float',\n            extra: {\n                canBack: true,\n                ua: PC_UA,\n                js: js\n            }\n        })\n        setResult(d);\n    }),\n    col_type: 'text_2'\n});\nd.push({\n    title: \"⛅️点我Token登录\",\n    url: $(\"\", \"输入32位阿里Token\").input(() => {\n        let reftoken = input.trim();\n        let ntoken = [];\n        if (reftoken.length == 32) {\n            var refresh = fetch('https://auth.aliyundrive.com/v2/account/token', {\n                headers: {\n                    'Content-Type': 'application/json',\n                    'User-Agent': PC_UA,\n                    'Referer': 'https://www.aliyundrive.com/'\n                },\n                body: '{\"refresh_token\":\"' + reftoken + '\",\"grant_type\":\"refresh_token\"}',\n                method: 'POST'\n            });\n            //log(refresh);\n            if (refresh.includes('\"refresh_token\"')) {\n                ntoken[0] = JSON.parse(refresh);\n                writeFile(\"hiker://files/rules/icy/icy-ali-token.json\", JSON.stringify(ntoken));\n                refreshPage();\n                return 'hiker://empty'\n            }\n        }\n        return 'toast://登入失败，可能Token是无效的。'\n    }),\n    col_type: 'text_2'\n});"}],"title":"云盘君(推送)","author":"小棉袄🌞(推送与原画功能by香雅情)","version":14,"type":"video","url":"hiker://empty##fypage","col_type":"movie_3","class_name":"","class_url":"","area_name":"","area_url":"","sort_name":"","year_name":"","sort_url":"","year_url":"","find_rule":"js:\nvar d = [];\naddListener(\n    'onRefresh', $.toString(() => {\n        clearMyVar('s')\n    })\n)\nif (!fileExist(\"hiker://files/rules/icy/icy-ali-token.json\")) {\n    eval(JSON.parse(fetch(\"hiker://page/Login\")).rule);\n} else {\n    let ntoken = JSON.parse(fetch('hiker://files/rules/icy/icy-ali-token.json', {}));\n    if (ntoken[0].refresh_token) {\n        eval(JSON.parse(fetch(\"hiker://page/sou\")).rule);\n        let s = getMyVar('s', '');\n        if (s == \"\") {\n            if (MY_PAGE == 1) {\n\n                header = {\n                    'User-Agent': 'Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/99.0.4844.51 Mobile Safari/537.36',\n                    'Host': 'top.baidu.com',\n                    'Accept': 'application/json, text/plain, */*',\n                    'Accept-Language': 'zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7',\n                    'Accept-Encoding': 'gzip, deflate, br',\n                    'Referer': 'https://top.baidu.com/board?tab=novel',\n                }\n                let json;\n                d.push({\n                    title: (getMyVar('topbaidu', '1') == '1' ? '电视剧热搜榜√' : '电视剧热搜榜'),\n                    url: `hiker://empty#noLoading#@lazyRule=.js:getMyVar('topbaidu','1')=='1'?putMyVar('topbaidu','0'):putMyVar('topbaidu','1');refreshPage();'hiker://empty'`,\n                    col_type: 'flex_button'\n                },{\n                    title: (getMyVar('topbaidu', '1') == '0' ? '电影热搜榜√' : '电影热搜榜'),\n                    url: `hiker://empty#noLoading#@lazyRule=.js:getMyVar('topbaidu','1')=='1'?putMyVar('topbaidu','0'):putMyVar('topbaidu','1');refreshPage();'hiker://empty'`,\n                    col_type: 'flex_button'\n                });\n\n                if (getMyVar('topbaidu', '1') == \"1\") {\n                    if (getMyVar('dsjjson', \"\") == \"\") {\n                        json = request('https://top.baidu.com/api/board?platform=wise&tab=teleplay&tag=%7B%7D', {\n                            headers: header\n                        });\n                        putMyVar('dsjjson', json);\n                    } else {\n                        json = getMyVar('dsjjson');\n                    }\n                } else {\n                    if (getMyVar('dyjson', '') == \"\") {\n                        json = request('https://top.baidu.com/api/board?platform=wise&tab=movie&tag=%7B%7D', {\n                            headers: header\n                        });\n                        putMyVar('dyjson', json);\n                    } else {\n                        json = getMyVar('dyjson');\n                    }\n                }\n                let list = JSON.parse(json).data.cards[0].content;\n\n                for (let i = 0; i < list.length; i++) {\n                    let name = list[i].word + '    (' + list[i].show[2] + ')';\n                    let des = list[i].desc;\n                    d.push({\n                        title: i == \"0\" ? '““””<span style=\"color:#ff3300\">' + (parseInt(i) + 1).toString() + '</span>' + \"\\t\\t\\t\" + name : i == \"1\" ? '““””<span style=\"color:#ff6600\">' + (parseInt(i) + 1).toString() + '</span>' + \"\\t\\t\\t\" + name : i == \"2\" ? '““””<span style=\"color:#ff9900\">' + (parseInt(i) + 1).toString() + '</span>' + \"\\t\\t\\t\" + name : '““””<span>' + (parseInt(i) + 1).toString() + '</span>' + \"\\t\\t\\t\" + name,\n                        url: $('#noLoading#').lazyRule((name) => {\n                            name = name.split('    (')[0];\n                            putMyVar('s', name);\n                            refreshPage();\n                            return 'hiker://empty'\n                        }, name),\n                        desc: des,\n                        col_type: \"text_1\"\n                    });\n                }\n            }\n        }\n    } else {\n        eval(JSON.parse(fetch(\"hiker://page/Login\")).rule);\n    }\n    //setResult(d);\n}\nsetResult(d);","searchFind":"js:\nvar d = [];\nlet key = MY_URL.split(\"##\")[1];\nd.push({\n    title: \"点我开始聚合搜索\" + key,\n    url: \"hiker://page/soup?p=fypage\",\n    extra: {\n        pageTitle: \"搜索\" + key,\n        key: key\n    }\n});\n\nsetResult(d);","search_url":"hiker://empty##**","group":"②推送","detail_col_type":"movie_1","detail_find_rule":"","sdetail_col_type":"movie_1","sdetail_find_rule":"","ua":"mobile","preRule":"let reaccessTk = getMyVar(\"aliaccessTk\", '');\nlet timeToken = getMyVar('timeToken', '0');\nif (reaccessTk == '' || (parseInt(timeToken) - parseInt(new Date().getTime() / 1000)).toString() <= 3600) {\n    let ntoken = [];\n    let reftoken = \"\";\n    if (!fileExist(\"hiker://files/rules/icy/icy-ali-token.json\")) {\n        toast('用户信息获取失败，请登入账号。');\n    } else {\n        ntoken = JSON.parse(fetch('hiker://files/rules/icy/icy-ali-token.json', {}));\n        if (ntoken[0].refresh_token) {\n            reftoken = ntoken[0].refresh_token;\n        } else {\n            toast('用户信息获取失败，请登入账号。');\n        }\n    }\n    if (reftoken.length == 32) {\n        var refresh = fetch('https://auth.aliyundrive.com/v2/account/token', {\n            headers: {\n                'Content-Type': 'application/json',\n                'User-Agent': PC_UA,\n                'Referer': 'https://www.aliyundrive.com/'\n            },\n            body: '{\"refresh_token\":\"' + reftoken + '\",\"grant_type\":\"refresh_token\"}',\n            method: 'POST'\n        });\n        ntoken[0] = JSON.parse(refresh);\n        writeFile(\"hiker://files/rules/icy/icy-ali-token.json\", JSON.stringify(ntoken));\n        log('运行预处理');\n        if (!fileExist(\"hiker://files/rules/icy/icy-ali-token.json\") || refresh.length > 300) {\n            var refresh = fetch('hiker://files/rules/icy/icy-ali-token.json', {});\n            putMyVar('timeToken', (parseInt(JSON.parse(refresh)[0].expires_in) + parseInt(new Date().getTime() / 1000)).toString());\n            let defdriveid = JSON.parse(refresh)[0].default_drive_id;\n            putMyVar('defdriveid', defdriveid);\n            var accessTk = JSON.parse(refresh)[0].token_type + ' ' + JSON.parse(refresh)[0].access_token;\n            //log(accessTk);\n            putMyVar(\"aliaccessTk\", accessTk);\n            let userresinfo = JSON.parse(fetch(\"https://user.aliyundrive.com/v2/user/get\", {\n                headers: {\n                    'content-type': 'application/json',\n                    'User-Agent': PC_UA,\n                    \"authorization\": accessTk,\n                    'Referer': 'https://www.aliyundrive.com/'\n                },\n                body: {},\n                method: 'POST'\n            }));\n            if (userresinfo.resource_drive_id) {\n                let resdriveid = userresinfo.resource_drive_id;\n                putMyVar('resdriveid', resdriveid);\n            }\n        }\n    }\n}","pages":"[{\"col_type\":\"movie_3\",\"name\":\"规则列表\",\"path\":\"data\",\"rule\":\"var wrapu = (u) => {\\n    if (config.mode == \\\"本地转码\\\") {\\n        return 'hiker://page/push?url=hiker://empty##' + encodeURIComponent(u) + '???fypage'\\n    }\\n    if (/aliyundrive/.test(u)) {\\n        const [link, _share_pwd] = u.split('?share_pwd=');\\n        const [_link, _folderID] = link.split('/folder/');\\n        let share_pwd = (_share_pwd || '').split('#name=')[0] || '';\\n        let shareId = _link.split('com/s/')[1];\\n        return 'smartdrive://share/browse?shareId=' + shareId + '&sharePwd=' + share_pwd;\\n    }\\n    return \\\"web://\\\" + u;\\n};\\n\\nvar checkali = (realurl) => {\\n    try {\\n        let shareId = realurl.split(\\\"com/s/\\\")[1].substring(0, 11);\\n        if (realurl.includes(\\\"com/s/\\\") && realurl != \\\"\\\") {\\n            let share = fetch(\\\"https://api.aliyundrive.com/adrive/v3/share_link/get_share_by_anonymous\\\", {\\n                headers: {\\n                    'content-type': 'application/json',\\n                    \\\"User-Agent\\\": PC_UA,\\n                    \\\"Referer\\\": \\\"https://www.aliyundrive.com/\\\"\\n                },\\n                body: {\\n                    \\\"share_id\\\": shareId\\n                },\\n                method: 'POST'\\n            });\\n            if (share.includes(\\\"share_link is\\\") || share.includes(\\\"share_link cannot\\\")) return false;\\n        }\\n    } catch (e) {}\\n    return true;\\n}\\n\\nlet rules = [{\\n        name: \\\"云盘资源\\\",\\n        page: true,\\n        find: function(s, page) {\\n            let url = \\\"https://res.yunpan.win/?PageIndex=\\\" + page + \\\"&PageSize=12&Keyword=\\\" + s + \\\"&Type=&Tag=\\\";\\n            let html = request(url, {\\n                headers: {\\n                    \\\"Referer\\\": \\\"https://res.yunpan.win/\\\"\\n                }\\n            });\\n\\n            let arr = pdfa(html, \\\"main&&.card\\\");\\n            //log(arr);\\n            let d = [];\\n            for (let i = 0; i < arr.length; i++) {\\n                let it = arr[i];\\n                let u = pdfh(it, \\\".card-link,1&&onclick\\\").match(/https:\\\\/\\\\/(www\\\\.aliyundrive\\\\.com\\\\/s|alywp\\\\.net|www\\\\.alipan\\\\.com\\\\/s)\\\\/\\\\w*/g) || [];\\n                u = u.length > 0 ? u[0] : url;\\n                d.push({\\n                    title: pdfh(it, \\\".card-title&&Text\\\"),\\n                    pic_url: pd(it, \\\"img&&src\\\", url),\\n                    //url: 'hiker://page/detail?rule=云盘汇影&url=' + u + '??fypage',\\n                    //url: 'hiker://page/push?url=hiker://empty##' + encodeURIComponent(u) + '???fypage',\\n                    url: wrapu(u),\\n                    desc: \\\"““””<font color=#f13b66a>云盘资源</font>&nbsp;\\\" + (pdfh(it, \\\".card-text,-1&&Text\\\")) + \\\"\\\\n\\\" + (u),\\n                });\\n            }\\n            return d;\\n        }\\n    }, {\\n        name: \\\"UP云搜\\\",\\n        page: true,\\n        find: function(s, page) {\\n            let url = \\\"https://upapi.juapp9.com/search?keyword=\\\" + s + \\\"&page=\\\" + page + \\\"&s_type=1\\\";\\n            let html = request(url, {\\n                headers: {\\n                    \\\"Accept\\\": \\\"*//*\\\",\\n                    \\\"Referer\\\": \\\"https://www.upyunso.com/\\\",\\n                    \\\"Origin\\\": \\\"https://www.upyunso.com\\\"\\n                }\\n            });\\n            //log(base64Decode(html));\\n            let arr = JSON.parse(base64Decode(html)).result.items;\\n            //log(arr);\\n            let d = [];\\n            for (let i = 0; i < arr.length; i++) {\\n                let it = arr[i];\\n                let u = it.page_url;\\n                //u = u.length > 0 ? u[0] : url;\\n                if (!/aliyundrive|alipan/.test(u)) {\\n                    continue;\\n                }\\n                d.push({\\n                    title: it.title,\\n                    //url: 'hiker://page/detail?rule=云盘汇影&url=' + u + '??fypage',\\n                    //url: 'hiker://page/push?url=hiker://empty##' + encodeURIComponent(u) + '???fypage',\\n                    url: wrapu(u),\\n                    desc: \\\"““””<font color=#f13b66a>UP云搜</font>&nbsp;\\\" + \\\"\\\\n\\\" + (u),\\n                });\\n\\n            }\\n            return d;\\n        }\\n    }, {\\n        name: \\\"猫狸盘搜\\\",\\n        page: false,\\n        find: function(s, page) {\\n            let html = request(\\\"https://www.alipansou.com/search?k=\\\" + s, {\\n                headers: {\\n                    \\\"Referer\\\": \\\"https://www.alipansou.com/search?k=\\\" + s\\n                }\\n            });\\n            let arr = pdfa(html, \\\"#app&&a\\\");\\n            //log(arr);\\n            let d = [];\\n            for (let i = 0; i < arr.length; i++) {\\n                let it = \\\"<div>\\\" + arr[i] + \\\"</div>\\\";\\n                let u = pdfh(it, \\\"a&&href\\\");\\n                //log(u);\\n                if (!u.includes(\\\"/s/\\\")) {\\n                    continue;\\n                }\\n                u = \\\"https://www.alipansou.com\\\" + u.replace(\\\"/s/\\\", \\\"/cv/\\\");\\n                d.push({\\n                    title: pdfh(it, \\\"template&&Text\\\"),\\n                    url: $(u).lazyRule((wrapu) => {\\n                        let html = request(input, {\\n                            headers: {\\n                                \\\"Cookie\\\": \\\"no_show_donate=1\\\",\\n                                \\\"Referer\\\": input.replace(\\\"/cv/\\\", \\\"/s/\\\")\\n                            },\\n                            redirect: false\\n                        });\\n                        html = parseDomForHtml(html, 'a&&href');\\n                        //var _links = html.match(/https:\\\\/\\\\/(www\\\\.aliyundrive\\\\.com\\\\/s|alywp\\\\.net)\\\\/\\\\w*/g) || [];\\n                        //log(_links);\\n                        if (html.length > 0) {\\n                            //return 'hiker://page/detail?rule=云盘汇影&url=' + _links[0] + '??fypage';\\n                            //return 'hiker://page/push?url=hiker://empty##' + encodeURIComponent(html) + '???fypage';\\n                            return wrapu(html);\\n                        } else {\\n                            return input;\\n                        }\\n                    }, wrapu),\\n                    desc: \\\"““””<font color=#f13b66a>猫狸盘搜</font>&nbsp;\\\" + pdfh(it, \\\"template,1&&Text\\\"),\\n                });\\n            }\\n            return d;\\n        }\\n    }, {\\n        name: \\\"易搜\\\",\\n        page: true,\\n        find: function(s, page) {\\n            eval(getCryptoJS());\\n\\n            function keyen(str) {\\n                var key = CryptoJS.enc.Utf8.parse(\\\"4OToScUFOaeVTrHE\\\"),\\n                    iv = CryptoJS.enc.Utf8.parse(\\\"9CLGao1vHKqm17Oz\\\");\\n                var encrypted = CryptoJS.AES.decrypt({\\n                    ciphertext: CryptoJS.enc.Base64.parse(str)\\n                }, key, {\\n                    iv: iv,\\n                    mode: CryptoJS.mode.CBC,\\n                    padding: CryptoJS.pad.Pkcs7\\n                }).toString(CryptoJS.enc.Utf8);\\n                return encrypted;\\n            }\\n            let html = request(\\\"https://yiso.fun/api/search?name=\\\" + s + \\\"&pageNo=\\\" + page, {\\n                headers: {\\n                    \\\"Referer\\\": \\\"https://yiso.fun/info?searchKey=\\\" + s,\\n                    \\\"Cookie\\\": getItem('yisoucooke', '')\\n                }\\n            });\\n            //log(html);\\n            if (html.includes('登录用户无限制')) {\\n                var i = 0;\\n                do {\\n                    var tyimglin = 'https://yiso.fun/api/user/login/captcha?t=' + parseInt(new Date().getTime()) + '';\\n                    let img = convertBase64Image(tyimglin).split(',')[1];\\n                    let cod = request('https://api.nn.ci/ocr/b64/text', {\\n                        headers: {\\n                            'Content-Type': 'text/plain'\\n                        },\\n                        body: img,\\n                        method: 'POST'\\n                    });\\n                    var ver = JSON.parse(request('https://yiso.fun/api/user/login', {\\n                        headers: {\\n                            'content-type': 'application/json',\\n                            'referer': 'https://yiso.fun/login',\\n                            'Cookie': getCookie(tyimglin)\\n                        },\\n                        body: {\\n                            \\\"userName\\\": \\\"tvbox2023\\\",\\n                            \\\"password\\\": \\\"Tvbox2023\\\",\\n                            \\\"code\\\": cod\\n                        },\\n                        method: 'POST'\\n                    }));\\n                    if (ver.code == 200) {\\n                        log('易搜登入验证成功');\\n                        setItem('yisoucooke', getCookie('https://yiso.fun'));\\n                        html = request(\\\"https://yiso.fun/api/search?name=\\\" + s + \\\"&pageNo=\\\" + page, {\\n                            headers: {\\n                                \\\"Referer\\\": \\\"https://yiso.fun/info?searchKey=\\\" + s,\\n                                \\\"Cookie\\\": getItem('yisoucooke', '')\\n                            }\\n                        });\\n                        break;\\n                    }\\n                    i++;\\n                } while (i < 4);\\n\\n            }\\n            let arr = JSON.parse(html).data.list;\\n            //log(arr);\\n            let d = [];\\n            for (let i = 0; i < arr.length; i++) {\\n                let it = arr[i];\\n                let u = keyen(it.url);\\n                //log(u);\\n                if (u == null || !u.includes(\\\"ali\\\")) {\\n                    continue;\\n                }\\n                d.push({\\n                    title: \\\"““””\\\" + it.name,\\n                    //url: 'hiker://page/detail?rule=云盘汇影&url=' + u + '??fypage',\\n                    //url: 'hiker://page/push?url=hiker://empty##' + encodeURIComponent(u) + '???fypage',\\n                    url: wrapu(u),\\n                    desc: \\\"““””<font color=#f13b66a>易搜</font>&nbsp;\\\" + (it.gmtShare || it.gmtCreate) + \\\"\\\\n\\\" + (u),\\n                });\\n\\n            }\\n            return d;\\n        }\\n    }, {\\n        name: \\\"找资源\\\",\\n        page: true,\\n        find: function(s, page) {\\n            function gethtml() {\\n                let html = request(\\\"http://zhaoziyuan.pw/so?filename=\\\" + s + \\\"&page=\\\" + page, {\\n                    headers: {\\n                        \\\"Referer\\\": \\\"http://zhaoziyuan.pw/stop.html\\\",\\n                        \\\"origin\\\": \\\"http://zhaoziyuan.pw\\\",\\n                        \\\"Cookie\\\": getItem(\\\"zzycooke\\\", \\\"\\\"),\\n                        \\\"upgrade-insecure-requests\\\": \\\"1\\\",\\n                        \\\"content-type\\\": \\\"application/x-www-form-urlencoded\\\"\\n                    }\\n                });\\n                return html;\\n            };\\n            var html = gethtml();\\n            if (!html.includes(\\\"search_box\\\")) {\\n                let 账号 = 'fanty';\\n                let 密码 = 'qqq111';\\n                let user = 'username=' + 账号 + '&password=' + 密码;\\n                let cook = JSON.parse(fetchCookie('http://zhaoziyuan.pw/logiu.html', {\\n                    headers: {\\n                        'User-Agent': MOBILE_UA,\\n                        'Content-Type': 'application/x-www-form-urlencoded',\\n                        'Origin': 'http://zhaoziyuan.pw',\\n                        'Referer': 'http://zhaoziyuan.pw/login.html',\\n                        \\\"upgrade-insecure-requests\\\": \\\"1\\\"\\n                    },\\n                    body: user,\\n                    method: 'POST',\\n                    onlyHeaders: true,\\n                    withHeaders: true\\n                })).join(';');\\n                setItem(\\\"zzycooke\\\", cook);\\n                log(\\\"找资源登入\\\");\\n                html = gethtml();\\n            }\\n\\n            let arr = pdfa(html, \\\"body&&.newsList&&li:not(:first-child)\\\");\\n            //log(arr);\\n            let d = [];\\n            for (let i = 0; i < arr.length; i++) {\\n                let it = arr[i];\\n                let u = pdfh(it, \\\"a&&href\\\");\\n                if (u == null) {\\n                    continue;\\n                }\\n                u = \\\"http://zhaoziyuan.pw/\\\" + u;\\n                //log(u);\\n                let title = pdfh(it, \\\".news_text&&h3&&Text\\\");\\n                d.push({\\n                    title: title,\\n                    desc: \\\"““””<font color=#f13b66a>找资源</font>&nbsp;\\\" + (pdfh(it, \\\".news_text&&p&&Text\\\")),\\n                    url: $(u).lazyRule((wrapu) => {\\n                        let html = request(input);\\n                        var _links = html.match(/https:\\\\/\\\\/(www\\\\.aliyundrive\\\\.com\\\\/s|www\\\\.alipan\\\\.com\\\\/s|alywp\\\\.net)\\\\/\\\\w*/g) || [];\\n                        //log(_links);\\n                        if (_links.length > 0) {\\n                            //return 'hiker://page/detail?rule=云盘汇影&url=' + _links[0] + '??fypage';\\n                            //return 'hiker://page/push?url=hiker://empty##' + encodeURIComponent(_links[0]) + '???fypage';\\n                            return wrapu(_links[0]);\\n                        } else {\\n                            return input;\\n                        }\\n                    }, wrapu)\\n                });\\n            }\\n            return d;\\n        }\\n    }, {\\n        name: \\\"小纸条\\\",\\n        page: false,\\n        find: function(s, page) {\\n            function gettoken() {\\n                if (getMyVar('xzytoken', '').length == 0) {\\n                    let token = JSON.parse(post('https://gitcafe.net/tool/alipaper/', {\\n                        headers: {\\n                            'Referer': 'https://u.gitcafe.net/'\\n                        },\\n                        body: {\\n                            action: 'get_token'\\n                        }\\n                    })).data;\\n                    putMyVar('xzttoken', token);\\n                }\\n                return getMyVar('xzttoken', '');\\n            }\\n\\n            function cat_code(a) {\\n                var d, e, b = [\\\"华语电视\\\", \\\"日韩电视\\\", \\\"欧美电视\\\", \\\"其他电视\\\", \\\"华语电影\\\", \\\"日韩电影\\\", \\\"欧美电影\\\", \\\"其他电影\\\", \\\"华语动漫\\\", \\\"日韩动漫\\\", \\\"欧美动漫\\\", \\\"纪录片\\\", \\\"综艺片\\\", \\\"教育培训\\\", \\\"其他视频\\\", \\\"华语音乐\\\", \\\"日韩音乐\\\", \\\"欧美音乐\\\", \\\"其他音乐\\\", \\\"娱乐软件\\\", \\\"系统软件\\\", \\\"网络软件\\\", \\\"办公软件\\\", \\\"其他软件\\\", \\\"漫画\\\", \\\"小说\\\", \\\"出版书\\\", \\\"知识培训\\\", \\\"其他文档\\\", \\\"壁纸\\\", \\\"人物\\\", \\\"风景\\\", \\\"其他图片\\\", \\\"其他\\\"],\\n                    c = [\\\"hyds\\\", \\\"rhds\\\", \\\"omds\\\", \\\"qtds\\\", \\\"hydy\\\", \\\"rhdy\\\", \\\"omdy\\\", \\\"qtdy\\\", \\\"hydm\\\", \\\"rhdm\\\", \\\"omdm\\\", \\\"jlp\\\", \\\"zyp\\\", \\\"jypx\\\", \\\"qtsp\\\", \\\"hyyy\\\", \\\"rhyy\\\", \\\"omyy\\\", \\\"qtyy\\\", \\\"kfrj\\\", \\\"xtrj\\\", \\\"wlrj\\\", \\\"bgrj\\\", \\\"qtrj\\\", \\\"mh\\\", \\\"xs\\\", \\\"cbs\\\", \\\"zspx\\\", \\\"qtwd\\\", \\\"bz\\\", \\\"rw\\\", \\\"fj\\\", \\\"qttp\\\", \\\"qt\\\"];\\n                for (d = 0, e = c.length; e > d; d++)\\n                    if (c[d] == a) return b[d];\\n            }\\n            let d = [];\\n            let html = post(\\\"https://gitcafe.net/tool/alipaper/\\\", {\\n                headers: {\\n                    'Referer': 'https://u.gitcafe.net/'\\n                },\\n                body: {\\n                    action: \\\"search\\\",\\n                    from: \\\"web\\\",\\n                    token: gettoken(),\\n                    keyword: s\\n                }\\n            })\\n            let list = JSON.parse(html);\\n            if (list.data) {\\n                list = list.data;\\n            }\\n            for (let i = 0; i < list.length; i++) {\\n                let it = list[i]\\n                let title = it.title;\\n                let u = it.alikey;\\n                if (u == null) {\\n                    continue;\\n                }\\n                let murl = 'https://www.aliyundrive.com/s/' + u;\\n\\n                if (!checkali(murl)) {\\n                    continue;\\n                }\\n                if (title.includes(s)) {\\n                    d.push({\\n                        title: \\\"√ \\\" + title,\\n                        desc: \\\"““””<font color=#f13b66a>小纸条</font>&nbsp;\\\" + cat_code(it.cat),\\n                        extra: {\\n                            des: it.des\\n                        },\\n                        //url: 'hiker://page/detail?rule=云盘汇影&url=https://www.aliyundrive.com/s/' + murl + '??fypage',\\n                        url: wrapu(murl)\\n                        //url: 'hiker://page/push?url=hiker://empty##' + encodeURIComponent('https://www.aliyundrive.com/s/' + murl) + '???fypage',\\n                    });\\n\\n                }\\n            }\\n            return d;\\n        }\\n    }, {\\n        name: \\\"玩偶哥哥\\\",\\n        page: true,\\n        find: function(s, page) {\\n            let url = \\\"http://wogg.link/index.php/vodsearch/\\\" + s + \\\"----------\\\" + page + \\\"---.html\\\";\\n            let html = request(url, {});\\n            let arr = parseDomForArray(html, '.module-items&&.module-search-item');\\n            //log(arr);\\n            let d = [];\\n            let bet = [];\\n            for (let i = 0; i < arr.length; i++) {\\n                let it = arr[i];\\n                let utitle = parseDomForHtml(it, 'h3&&a&&Text');\\n                let userial = parseDomForHtml(it, '.video-serial&&Text');\\n                let uimage = parseDom(it, '.lazyload&&data-src', 'http://wogg.link/');\\n                let u = parseDom(it, 'h3&&a&&href', 'http://wogg.link/');\\n                //let det = request(u, {});\\n                bet.push({\\n                    title: utitle,\\n                    url: u,\\n                    image: uimage,\\n                    desc: userial\\n                });\\n            }\\n            if (bet.length > 0) {\\n                let beth = batchFetch(bet);\\n                for (let i = 0; i < beth.length; i++) {\\n                    let list = parseDomForArray(beth[i], '.module-player-list&&p')\\n                    for (let j = 0; j < list.length; j++) {\\n                        let u = parseDomForHtml(list[j], 'p&&Text');\\n                        if (!u.includes(\\\"/s/\\\")) {\\n                            continue;\\n                        }\\n                        d.push({\\n                            title: bet[i].title,\\n                            pic_url: bet[i].image,\\n                            //url: 'hiker://page/detail?rule=云盘汇影&url=' + u + '??fypage',\\n                            //url: 'hiker://page/push?url=hiker://empty##' + encodeURIComponent(u) + '???fypage',\\n                            url: wrapu(u),\\n                            desc: \\\"““””<font color=#f13b66a>玩偶哥哥</font>&nbsp;\\\" + (bet[i].desc) + '\\\\n' + u,\\n                        });\\n\\n                    }\\n                }\\n            }\\n            return d;\\n        }\\n    }, {\\n        name: \\\"玩偶妹妹\\\",\\n        page: true,\\n        find: function(s, page) {\\n            let url = \\\"https://www.weixine.net/vodsearch/\\\" + s + \\\"----------\\\" + page + \\\"---.html\\\";\\n            let html = request(url, {});\\n            let arr = parseDomForArray(html, '.module-items&&.module-search-item');\\n            //log(arr);\\n            let d = [];\\n            let bet = [];\\n            for (let i = 0; i < arr.length; i++) {\\n                let it = arr[i];\\n                let utitle = parseDomForHtml(it, 'h3&&a&&Text');\\n                let userial = parseDomForHtml(it, '.video-serial&&Text');\\n                let uimage = parseDom(it, '.lazyload&&data-src', 'https://www.weixine.net/');\\n                let u = parseDom(it, 'h3&&a&&href', 'https://www.weixine.net/');\\n                //let det = request(u, {});\\n                bet.push({\\n                    title: utitle,\\n                    url: u,\\n                    image: uimage,\\n                    desc: userial\\n                });\\n            }\\n            if (bet.length > 0) {\\n                let beth = batchFetch(bet);\\n                for (let i = 0; i < beth.length; i++) {\\n                    let list = parseDomForArray(beth[i], '.module-player-list&&p')\\n                    for (let j = 0; j < list.length; j++) {\\n                        let u = parseDomForHtml(list[j], 'p&&Text');\\n                        if (!/aliyundrive|alipan/.test(u)) {\\n                            continue;\\n                        }\\n                        d.push({\\n                            title: bet[i].title,\\n                            pic_url: bet[i].image,\\n                            //url: 'hiker://page/detail?rule=云盘汇影&url=' + u + '??fypage',\\n                            //url: 'hiker://page/push?url=hiker://empty##' + encodeURIComponent(u) + '???fypage',\\n                            url: wrapu(u),\\n                            desc: \\\"““””<font color=#f13b66a>玩偶妹妹</font>&nbsp;\\\" + (bet[i].desc) + '\\\\n' + u,\\n                        });\\n\\n                    }\\n                }\\n            }\\n            return d;\\n        }\\n    }, {\\n        name: \\\"阿里云盘网\\\",\\n        page: true,\\n        find: function(s, page) {\\n            let url = \\\"https://www.alypw.cn/search.php?q=\\\" + s + \\\"&page=\\\" + page;\\n            let html = request(url, {});\\n            let arr = parseDomForArray(html, '.list&&li');\\n            //log(arr);\\n            let d = [];\\n            let bet = [];\\n            for (let i = 0; i < arr.length; i++) {\\n                let it = arr[i];\\n                let utitle = parseDomForHtml(it, 'a&&title');\\n                let userial = parseDomForHtml(it, '.fa-clock-o&&Text');\\n                let uimage = parseDom(it, 'img&&src', 'https://www.alypw.cn/');\\n                let u = parseDom(it, 'a&&href', 'https://www.alypw.cn/');\\n                //let det = request(u, {});\\n                if (!utitle.includes(s)) {\\n                    continue;\\n                }\\n                bet.push({\\n                    title: utitle,\\n                    url: u,\\n                    image: uimage,\\n                    desc: userial\\n                });\\n            }\\n            //log(bet);\\n            if (bet.length > 0) {\\n                let beth = batchFetch(bet);\\n                for (let i = 0; i < beth.length; i++) {\\n                    let list = parseDomForArray(beth[i], 'body&&a[href^=https://www.aliyundrive.com/s/]')\\n                    //log(list);\\n                    for (let j = 0; j < list.length; j++) {\\n                        let u = parseDomForHtml(list[j], 'a&&href');\\n                        d.push({\\n                            title: bet[i].title,\\n                            pic_url: bet[i].image,\\n                            //url: 'hiker://page/detail?rule=云盘汇影&url=' + u + '??fypage',\\n                            //url: 'hiker://page/push?url=hiker://empty##' + encodeURIComponent(u) + '???fypage',\\n                            url: wrapu(u),\\n                            desc: \\\"““””<font color=#f13b66a>阿里云盘网</font>&nbsp;\\\" + (bet[i].desc) + '\\\\n' + u,\\n                        });\\n\\n                    }\\n                }\\n            }\\n            return d;\\n        }\\n    },\\n    {\\n        name: \\\"小云搜索\\\",\\n        page: false,\\n        find: function(s, page) {\\n            let ur = 'https://www.yunso.net/api/validate/search?wd=' + s + '&mode=90002&stype=20100&uk=&page=' + page + '&limit=20&screen_filetype=undefined';\\n            let bod = 'data=/api/validate/search?wd=' + s + '&mode=90002&stype=20100&uk=&page=' + page + '&limit=20&screen_filetype=undefined';\\n            let html = fetch(ur, {\\n                headers: {\\n                    \\\"User-Agent\\\": PC_UA,\\n                    \\\"Referer\\\": \\\"https://www.yunso.net\\\",\\n                    \\\"x-requested-with\\\": \\\"XMLHttpRequest\\\"\\n                },\\n                body: bod,\\n                method: \\\"POST\\\"\\n            });\\n\\n            let arr = parseDomForArray(JSON.parse(html).data, 'body&&a[url^=aHR0c]');\\n            let d = [];\\n            for (let i = 0; i < arr.length; i++) {\\n                let it = arr[i];\\n                //log(it);\\n                let u = base64Decode(parseDomForHtml(it, 'a&&url'));\\n                let tit = parseDomForHtml(it, 'a&&Text');\\n                if (!tit.includes(s)) {\\n                    continue;\\n                }\\n                if (!/aliyundrive|alipan/.test(u)) {\\n                    continue;\\n                }\\n                //log(u);\\n                d.push({\\n                    title: tit,\\n                    //url: 'hiker://page/detail?rule=云盘汇影&url=' + u + '??fypage',\\n                    //url: 'hiker://page/push?url=hiker://empty##' + encodeURIComponent(u) + '???fypage',\\n                    url: wrapu(u),\\n                    desc: \\\"““””<font color=#f13b66a>小云搜索</font>&nbsp;\\\" + \\\"\\\\n\\\" + u,\\n                });\\n            }\\n            return d;\\n        }\\n    },\\n    {\\n        name: \\\"阿里搜\\\",\\n        page: true,\\n        find: function(s, page) {\\n            let d = [];\\n            let html = request('https://aliso.cc/s/' + s + '-' + page + '-0.html', {});\\n\\n            let list = parseDomForArray(html, '.search-result&&.resource-item');\\n            for (let j = 0; j < list.length; j++) {\\n                let u = list[j];\\n                let tit = parseDomForHtml(u, 'h3&&Text');\\n                if (!tit.includes(s)) {\\n                    continue;\\n                }\\n                d.push({\\n                    title: tit,\\n                    url: $(parseDom(u, 'h3&&a&&href', 'https://aliso.cc/')).lazyRule((wrapu) => {\\n                        eval(getCryptoJS());\\n\\n                        function decry(str) {\\n                            var key = CryptoJS.enc.Utf8.parse(\\\"9EB20DDFD6AFBD68\\\");\\n                            var encrypted = CryptoJS.AES.decrypt(str, key, {\\n                                iv: key,\\n                                mode: CryptoJS.mode.CBC,\\n                                padding: CryptoJS.pad.Pkcs7\\n                            }).toString(CryptoJS.enc.Utf8);\\n                            return encrypted;\\n                        }\\n\\n                        let html = request(input);\\n                        let but = parseDom(html, '.button&&href', 'https://aliso.cc/');\\n                        //log(but);\\n                        let got = request(but);\\n                        //log(got);\\n                        eval(parseDomForHtml(got, 'head&&script,1&&Html'));\\n                        return wrapu(decry(base64.split('!')[0]));\\n\\n                    }, wrapu),\\n                    desc: \\\"““””<font color=#f13b66a>阿里搜</font>&nbsp;\\\" + parseDomForHtml(u, '.time&&Text'),\\n                });\\n\\n            }\\n            return d;\\n        }\\n    },\\n    {\\n        name: \\\"土拨鼠搜\\\",\\n        page: false,\\n        find: function(s, page) {\\n            /*let html = request('https://www.tugousou.com/search', {\\n                body: 'keyword=' + s,\\n                method: 'POST'\\n            });*/\\n            var ee = getMyVar(\\\"tgskey\\\", \\\"\\\");\\n\\n            function getkey() {\\n                let aa = request('https://www.tbsdy.com/service/mrs/token.json', {\\n                    headers: {\\n                        'content-type': 'application/json',\\n                        'USER-KEY-ID': 'ukey:e26a05575d3c4a80856bf9b63f99529f'\\n                    },\\n                    body: {\\n                        \\\"app_key\\\": \\\"86b9fb4c32b5f832fdf39e17c8\\\"\\n                    },\\n                    method: 'POST'\\n                });\\n                let bb = JSON.parse(aa).data;\\n                putMyVar(\\\"tgskey\\\", bb);\\n                return bb;\\n            }\\n\\n            function tencode(e, t) {\\n                e += \\\"\\\";\\n                for (var o = \\\"\\\", n = 0; n < e.length; n++) {\\n                    var r = e.charCodeAt(n);\\n                    r += t,\\n                        r > 127 && (r = 127),\\n                        o += String.fromCharCode(r)\\n                }\\n                return o\\n            }\\n            //log(tencode(ee, 10));\\n\\n            let html = request('https://www.tbsdy.com/service/search/wap.json?paged=' + page + '&page_size=10', {\\n                headers: {\\n                    'content-type': 'application/json',\\n                    'USER-KEY-ID': 'ukey:e26a05575d3c4a80856bf9b63f99529f'\\n                },\\n                body: {\\n                    \\\"keyword\\\": s,\\n                    \\\"data_type\\\": 987910,\\n                    \\\"category\\\": 983920,\\n                    \\\"mrs_token\\\": tencode(ee == '' ? getkey() : ee, 10),\\n                    \\\"app_key\\\": \\\"86b9fb4c32b5f832fdf39e17c8\\\"\\n                },\\n                method: 'POST'\\n            });\\n            //log(ee);\\n            let arr = JSON.parse(html).cloud_list;\\n            let d = [];\\n            for (let i = 0; i < arr.length; i++) {\\n                let it = arr[i];\\n                let u = it.url;\\n                if (!u.includes(\\\"/s/\\\")) {\\n                    continue;\\n                }\\n                //log(u);\\n                d.push({\\n                    title: it.name,\\n                    //url: 'hiker://page/detail?rule=云盘汇影&url=' + u + '??fypage',\\n                    //url: 'hiker://page/push?url=hiker://empty##' + encodeURIComponent(u) + '???fypage',\\n                    url: wrapu(u),\\n                    desc: \\\"““””<font color=#f13b66a>土拨鼠搜</font>&nbsp;\\\" + \\\"\\\\n\\\" + u,\\n                });\\n            }\\n            return d;\\n        }\\n    },\\n    {\\n        name: \\\"云盘分享社\\\",\\n        page: false,\\n        find: function(s, page) {\\n            eval(getCryptoJS());\\n\\n            function decry(str) {\\n                var key = CryptoJS.enc.Utf8.parse(\\\"5F6B2AK33DASD123\\\");\\n                var encrypted = CryptoJS.AES.decrypt(str, key, {\\n                    mode: CryptoJS.mode.ECB,\\n                    padding: CryptoJS.pad.Pkcs7\\n                }).toString(CryptoJS.enc.Utf8);\\n                return encrypted;\\n            }\\n            let html = fetch('https://www.yunpanfenxiang.cn/api/bbs/api/getdata?key=' + s, {\\n                headers: {\\n                    'user-agent': 'Mozilla/5.0 (Linux; Android 13; V2049A Build/TP1A.220624.014; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/118.0.0.0 Mobile Safari/537.36',\\n                    \\\"referer\\\": \\\"https://www.yunpanfenxiang.cn/search?key=\\\" + s\\n                }\\n            });\\n            let aa = JSON.parse(html).data;\\n\\n            let json = decry(aa);\\n            //log(json);\\n            let arr = JSON.parse(json); //[0].result.items;\\n            //log(arr);\\n\\n            let d = [];\\n            let bet = [];\\n            for (let i = 0; i < arr.length; i++) {\\n                let it = arr[i];\\n                let url = it.pid;\\n                bet.push({\\n                    url: 'https://www.yunpanfenxiang.cn/api/bbs/api/getarticle?id=' + url,\\n                    options: {\\n                        headers: {\\n                            \\\"Referer\\\": \\\"https://www.yunpanfenxiang.cn/\\\"\\n                        }\\n                    }\\n                });\\n            }\\n            //log(u);\\n            let beth = batchFetch(bet);\\n\\n            //log(article);\\n            for (let i = 0; i < beth.length; i++) {\\n                let json = JSON.parse(beth[i]).data;\\n                //log(json);\\n                let list = json.download.split('@');\\n                for (let j = 0; j < list.length; j++) {\\n                    let u = list[j];\\n                    d.push({\\n                        title: json.title,\\n                        //url: 'hiker://page/detail?rule=云盘汇影&url=' + u + '??fypage',\\n                        //url: 'hiker://page/push?url=hiker://empty##' + encodeURIComponent(u) + '???fypage',\\n                        url: wrapu('https://www.aliyundrive.com/s/' + u),\\n                        desc: \\\"““””<font color=#f13b66a>云盘分享社</font>&nbsp;\\\" + (json.createtime) + \\\"\\\\n\\\" + ('https://www.aliyundrive.com/s/' + u),\\n                    });\\n                }\\n            }\\n\\n            return d;\\n        }\\n    }, {\\n        name: \\\"盘搜\\\",\\n        page: true,\\n        find: function(s, page) {\\n            page = (page - 1) * 10;\\n            let url = \\\"https://www.pansearch.me/search?keyword=\\\" + s + \\\"&offset=\\\" + page + \\\"&pan=aliyundrive\\\";\\n            let html = request(url, {});\\n\\n            let arr = parseDomForArray(html, '.grid&&.shadow:has(a[href^=https://www.aliyundrive.com/s/])');\\n            //log(arr);\\n            let d = [];\\n            for (let i = 0; i < arr.length; i++) {\\n                let it = arr[i];\\n                let u = parseDomForHtml(it, 'a[href^=https://www.aliyundrive.com/s/]&&href');\\n                //log(u);\\n                d.push({\\n                    title: parseDomForHtml(it, '.break-all&&Text').split('http')[0],\\n                    pic_url: parseDomForHtml(it, 'img&&src'),\\n                    //url: 'hiker://page/detail?rule=云盘汇影&url=' + u + '??fypage',\\n                    //url: 'hiker://page/push?url=hiker://empty##' + encodeURIComponent(u) + '???fypage',\\n                    url: wrapu(u),\\n                    desc: \\\"““””<font color=#f13b66a>盘搜</font>&nbsp;\\\" + (parseDomForHtml(it, 'p&&Text')) + \\\"\\\\n\\\" + (u),\\n                });\\n\\n            }\\n            return d;\\n        }\\n    },\\n    {\\n        name: \\\"DOVX搜\\\",\\n        page: false,\\n        find: function(s, page) {\\n            let url = \\\"https://api.dovx.tk/ali/search?wd=\\\" + s;\\n            let html = request(url, {});\\n            //log(base64Decode(html));\\n            let arr = JSON.parse(html).list;\\n            //log(arr);\\n            let d = [];\\n            for (let i = 0; i < arr.length; i++) {\\n                let it = arr[i];\\n                let u = it.vod_content;\\n                //u = u.length > 0 ? u[0] : url;\\n                if (!/aliyundrive|alipan/.test(u)) {\\n                    continue;\\n                }\\n                if (!checkali(u)) {\\n                    continue;\\n                }\\n                d.push({\\n                    title: \\\"√ \\\" + it.vod_name,\\n                    pic_url: it.vod_pic,\\n                    //url: 'hiker://page/detail?rule=云盘汇影&url=' + u + '??fypage',\\n                    //url: 'hiker://page/push?url=hiker://empty##' + encodeURIComponent(u) + '???fypage',\\n                    url: wrapu(u),\\n                    desc: \\\"““””<font color=#f13b66a>DOVX搜</font>&nbsp;\\\" + \\\"\\\\n\\\" + (u),\\n                });\\n            }\\n            return d;\\n        }\\n    },\\n    {\\n        name: \\\"必应\\\",\\n        page: true,\\n        find: function(s, page) {\\n            let url = \\\"https://cn.bing.com/search?q=\\\" + s + \\\"+aliyundrive&qs=ds&form=QBRE\\\";\\n            if (page != 1) {\\n                url = getMyVar(\\\"bing\\\", url);\\n            }\\n            let html = request(url, {\\n                headers: {\\n                    \\\"Referer\\\": \\\"https://cn.bing.com/\\\",\\n                    //\\\"X-Requested-With\\\": \\\"com.example.hikerview\\\",\\n                    \\\"Accept\\\": \\\"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9\\\"\\n                }\\n            });\\n            let arr = pdfa(html, \\\"body&&a\\\");\\n            //log(arr);\\n            let d = [];\\n            for (let i = 0; i < arr.length; i++) {\\n                let it = arr[i];\\n                let u = pd(it, \\\"a&&href\\\", url);\\n                let t = pdfh(it, \\\"a&&Text\\\");\\n                if (it.includes(\\\"Next page\\\") || it.includes(\\\"下一页\\\")) {\\n                    let u2 = pd(it, \\\"a&&href\\\", url);\\n                    //log(\\\"next page\\\");\\n                    //log(u2);\\n                    putMyVar(\\\"bing\\\", u2);\\n                }\\n                if (u == null || t == null || !it.includes(s)) {\\n                    continue;\\n                }\\n                if (!it.includes(\\\"网盘\\\") && !it.includes(\\\"云盘\\\") &&\\n                    !it.includes(\\\"aliyundrive\\\") && !it.includes(\\\"yunpan\\\") && !it.includes(\\\"alipan\\\")) {\\n                    continue;\\n                }\\n                if (u.startsWith(\\\"https://cn.bing.com/\\\")) {\\n                    continue;\\n                }\\n                let dom = getHome(u).replace(\\\"http://\\\", \\\"\\\").replace(\\\"https://\\\", \\\"\\\");\\n                let _links = t.match(/https:\\\\/\\\\/(www\\\\.aliyundrive\\\\.com\\\\/s|alywp\\\\.net|www\\\\.alipan\\\\.com\\\\/s)\\\\/\\\\w*/g) || [];\\n                //log(_links);\\n                let c = null;\\n                //log(_links);\\n                //if (_links.length > 0) {\\n                //c = 'hiker://page/push?url=hiker://empty##' + encodeURIComponent(_links[0]) + '???fypage';\\n                //c=wrapu(_links[0])\\n                //}\\n                if (_links.length > 1 && _links[1].replace(_links[0], \\\"\\\").replace(/[a-zA-Z0-9]+/g, \\\"\\\") == \\\"\\\") {\\n                    c = wrapu(_links[1]);\\n                } else if (_links.length > 0) {\\n                    c = wrapu(_links[0]);\\n                }\\n                d.push({\\n                    title: t,\\n                    desc: \\\"““””<font color=#f13b66a>必应</font>&nbsp;\\\" + dom,\\n                    url: c != null ? c : $(u).lazyRule((wrapu, mode) => {\\n                        let html = request(input);\\n                        var _links = html.match(/https:\\\\/\\\\/(www\\\\.aliyundrive\\\\.com\\\\/s|alywp\\\\.net)\\\\/\\\\w*/g) || [];\\n                        //log(_links);\\n                        //if (_links.length > 0) {\\n                        //return 'hiker://page/detail?rule=云盘汇影&url=' + _links[0] + '??fypage';\\n                        //return 'hiker://page/push?url=hiker://empty##' + encodeURIComponent(_links[0]) + '???fypage';\\n                        if (_links.length > 1 && _links[1].replace(_links[0], \\\"\\\").replace(/[a-zA-Z0-9]+/g, \\\"\\\") == \\\"\\\") {\\n                            return wrapu(_links[1]);\\n                        } else if (_links.length > 0) {\\n                            return wrapu(_links[0]);\\n                        } else {\\n                            let rule = MY_RULE.title;\\n                            return \\\"hiker://page/ysfx?rule=\\\" + rule + \\\"&r=\\\" + rule + \\\"&mode=\\\" + mode + \\\"##\\\" + input;\\n                        }\\n                    }, wrapu, config.mode)\\n                });\\n            }\\n            return d;\\n        }\\n    }\\n];\\n\\n/*\\nlet ccof = $.require('hiker://page/ccof')\\nrules.push(ccof)\\n*/\\n//并发规则数\\nlet size = 10;\\n\\n$.exports = function(page, rule) {\\n    if (!page && !rule) {\\n        return rules.map(it => it.name);\\n    }\\n    if (rule != null) {\\n        if (page != null && page > 1) {\\n            return rules.filter(i => i.name == rule && i.page);\\n        }\\n        return rules.filter(i => i.name == rule);\\n    }\\n    let start = (page - 1) * size;\\n    if (rules.length < start + 1) {\\n        return [];\\n    }\\n    let len = size;\\n    if (rules.length < page * size) {\\n        len = rules.length - start\\n    }\\n    return rules.slice(start, start + len);\\n}\"},{\"col_type\":\"movie_3\",\"name\":\"搜索\",\"path\":\"sou\",\"rule\":\"let r = getItem(\\\"r\\\", \\\"\\\");\\nif (MY_PAGE == 1) {\\n    let r1 = fetch(\\\"hiker://home@XYQ推送\\\");\\n    let ntoken = JSON.parse(fetch('hiker://files/rules/icy/icy-ali-token.json', {}));\\n\\n    if (!r1 || r1.length <= 5) {\\n        let ru = $.toString(() => {\\n            return \\\"海阔视界规则分享，当前分享的是：小程序￥home_rule_v2￥base64://@XYQ推送@eyJsYXN0X2NoYXB0ZXJfcnVsZSI6IiIsInRpdGxlIjoiWFlR5o6o6YCBIiwiYXV0aG9yIjoi6aaZ6ZuF5oOFIiwidXJsIjoiaGlrZXI6Ly9lbXB0eSIsInZlcnNpb24iOjEsImNvbF90eXBlIjoibW92aWVfMyIsImNsYXNzX25hbWUiOiIiLCJ0eXBlIjoidG9vbCIsImNsYXNzX3VybCI6IiIsImFyZWFfbmFtZSI6IiIsImFyZWFfdXJsIjoiIiwic29ydF9uYW1lIjoiIiwieWVhcl9uYW1lIjoiIiwic29ydF91cmwiOiIiLCJ5ZWFyX3VybCI6IiIsImZpbmRfcnVsZSI6ImpzOlxubGV0IGQgPSBbXTtcbmQucHVzaCh7XG4gICAgdGl0bGU6ICforr7nva7nlLXop4ZJUCcsXG4gICAgdXJsOiBcImlucHV0Oi8vXCIgKyBnZXRJdGVtKCdoaWtlcnR2Ym94c2V0JywgJ2h0dHA6Ly8nICsgZ2V0SVAoKSArICc6OTk3OCcpICsgXCIvLy8v6K+36L6T5YWldHZib3jmjqjpgIFJUOWcsOWdgO+8jOWmgmh0dHA6Ly9cIiArIGdldElQKCkgKyBcIjo5OTc4LmpzOnNldEl0ZW0oJ2hpa2VydHZib3hzZXQnLGlucHV0KTtyZWZyZXNoUGFnZSgpXCIsXG4gICAgY29sX3R5cGU6ICdzY3JvbGxfYnV0dG9uJ1xufSk7XG5kLnB1c2goe1xuICAgIHRpdGxlOiBnZXRJdGVtKCdoaWtlcnR2Ym94c2V0JywgJycpLFxuICAgIC8vdXJsOiAnaGlrZXI6Ly9lbXB0eScsXG4gICAgdXJsOiBcImlucHV0Oi8vXCIgKyBnZXRJdGVtKCdoaWtlcnR2Ym94c2V0JywgJ2h0dHA6Ly8nICsgZ2V0SVAoKSArICc6OTk3OCcpICsgXCIvLy8v6K+36L6T5YWldHZib3jmjqjpgIFJUOWcsOWdgO+8jOWmgmh0dHA6Ly9cIiArIGdldElQKCkgKyBcIjo5OTc4LmpzOnNldEl0ZW0oJ2hpa2VydHZib3hzZXQnLGlucHV0KTtyZWZyZXNoUGFnZSgpXCIsXG4gICAgY29sX3R5cGU6ICdzY3JvbGxfYnV0dG9uJ1xufSk7XG5cbmQucHVzaCh7XG4gICAgdGl0bGU6IFwi5o6o6YCBXCIsXG4gICAgdXJsOiAkLnRvU3RyaW5nKCgpID0+IHtcbiAgICAgICAgY2xlYXJNeVZhcignbmFtZScpO1xuICAgICAgICAvL3ZhciBsaW5rID0gJ2hpa2VyOi8vcGFnZS9wdXNoLmh0bWw/dXJsPScgKyBlbmNvZGVVUklDb21wb25lbnQoaW5wdXQucmVwbGFjZShcIiNpc011c2ljPXRydWUjXCIsICcnKS5yZXBsYWNlKCcjaXNWaWRlbz10cnVlIycsICcnKSk7XG4gICAgICAgIHZhciBsaW5rID0gXCJoaWtlcjovL3BhZ2UvcHVzaD9wdXNodXJsPVwiICsgZW5jb2RlVVJJQ29tcG9uZW50KGlucHV0KTtcblxuICAgICAgICBpZiAoaW5wdXQuc3RhcnRzV2l0aCgnaHR0cCcpIHx8IGlucHV0LnN0YXJ0c1dpdGgoJ21hZ25ldDonKSB8fCAoaW5wdXQuaW5jbHVkZXMoXCJcXG5cIikgJiYgIWlucHV0LnN0YXJ0c1dpdGgoXCJ7XCIpKSkge1xuICAgICAgICAgICAgcmV0dXJuIGxpbms7XG4gICAgICAgIH0gZWxzZSBpZiAoaW5wdXQuc3RhcnRzV2l0aChcIntcIikgJiYgaW5wdXQuZW5kc1dpdGgoXCJ9XCIpKSB7XG4gICAgICAgICAgICByZXR1cm4gbGluaztcbiAgICAgICAgfSBlbHNlIGlmICgvXFwudG9ycmVudHxlZDJrXFw6Ly50ZXN0KGlucHV0KSkge1xuICAgICAgICAgICAgcmV0dXJuICd0b2FzdDovL+S4jeaUr+aMgeaOqOmAgei/meenjemTvuaOpeOAgidcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiAndG9hc3Q6Ly/or7fovpPlhaXmraPnoa7nmoTpk77mjqXjgIInXG4gICAgICAgIH1cbiAgICB9KSxcbiAgICBleHRyYToge1xuICAgICAgICB0aXRsZVZpc2libGU6IHRydWVcbiAgICB9LFxuICAgIGNvbF90eXBlOiAnaW5wdXQnXG59KTtcbmQucHVzaCh7XG4gICAgdGl0bGU6IFwiVFZC5pCc57SiXCIsXG4gICAgdXJsOiAkLnRvU3RyaW5nKCgpID0+IHtcbiAgICAgICAgbGV0IHR2aXAgPSBnZXRJdGVtKCdoaWtlcnR2Ym94c2V0JywgJycpO1xuICAgICAgICBsZXQgc3RhdGUgPSAnZmFsc2UnO1xuICAgICAgICBpZiAodHZpcCAhPSAnJyAmJiB0dmlwLmluY2x1ZGVzKCc6OTk3JykpIHtcbiAgICAgICAgICAgIHZhciBzdGF0ZSA9IHJlcXVlc3QodHZpcCArICcvYWN0aW9uJywge1xuICAgICAgICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQnLFxuICAgICAgICAgICAgICAgICAgICAvLydYLVJlcXVlc3RlZC1XaXRoJzogJ1hNTEh0dHBSZXF1ZXN0JyxcbiAgICAgICAgICAgICAgICAgICAgJ1JlZmVyZXInOiB0dmlwXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB0aW1lb3V0OiAyMDAwLFxuICAgICAgICAgICAgICAgIGJvZHk6ICdkbz1zZWFyY2gmd29yZD0nICsgaW5wdXQsXG4gICAgICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCdcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIC8vbG9nKHN0YXRlKTtcbiAgICAgICAgaWYgKHN0YXRlID09ICdvaycpIHtcbiAgICAgICAgICAgIHJldHVybiAndG9hc3Q6Ly/mkJzntKLmjqjpgIHmiJDlip/vvIzor7fms6jmhI/op4LnnIvnlLXop4bnq690dmJveOeVjOmdoic7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gJ3RvYXN0Oi8v5pCc57Si5o6o6YCB5aSx6LSlJ1xuICAgICAgICB9XG4gICAgfSksXG4gICAgZXh0cmE6IHtcbiAgICAgICAgdGl0bGVWaXNpYmxlOiB0cnVlXG4gICAgfSxcbiAgICBjb2xfdHlwZTogJ2lucHV0J1xufSk7XG4vL+iwg+eUqOS7o+eggeekuuS+i1xuLy9yZXR1cm4gJ2hpa2VyOi8vcGFnZS9wdXNoP3J1bGU9WFlR5o6o6YCBJnB1c2h1cmw9JyArIGVuY29kZVVSSUNvbXBvbmVudChpbnB1dCk7XG4vL3VybDogJ2hpa2VyOi8vcGFnZS9wdXNoP3J1bGU9WFlR5o6o6YCBJnB1c2h1cmw9JytlbmNvZGVVUklDb21wb25lbnQodXJsKTtcbmQucHVzaCh7XG4gICAgdGl0bGU6ICfkuIvovb1UVkJveOaOqOmAgeaPkuS7ticsXG4gICAgdXJsOiAnaHR0cHM6Ly9mcmFtYWdpdC5vcmcvbHprMjM1NTkvdHZib3gvLS90cmVlL21haW4nLFxuICAgIGNvbF90eXBlOiAndGV4dF8yJ1xufSk7XG5kLnB1c2goe1xuICAgIHRpdGxlOiAn5p+l55yLVFborr7nva7mlZnnqIsnLFxuICAgIHVybDogJ2h0dHBzOi8vZnJhbWFnaXQub3JnL2x6azIzNTU5L3R2Ym94Ly0vYmxvYi9tYWluLyVFNCVCRCVCRiVFNyU5NCVBOCVFOCVBRiVCNCVFNiU5OCU4RS0lRTUlQkYlODUlRTclOUMlOEIvWFlRVFZCb3glRTYlQUQlQTUlRTklQUElQTQlRTYlOTMlOEQlRTQlQkQlOUMlRTglQUYlQjQlRTYlOTglOEUucGRmJyxcbiAgICBjb2xfdHlwZTogJ3RleHRfMidcbn0pO1xuZC5wdXNoKHtcbiAgICB0aXRsZTogXCLmjqjpgIHlpKflrrbml49cIixcbiAgICB1cmw6ICdodHRwczovL3BkLnFxLmNvbS9zLzU1M3NmbHdqZT9zaGFyZVNvdXJjZT01JyxcbiAgICBjb2xfdHlwZTogXCJ0ZXh0XzFcIlxufSk7XG52YXIganVtcCA9IFsndHZib3jkupHnm5jmjqjpgIEnLCAn5LqR55uY5ZCbKOaOqOmAgSknLCAnQUnlvbHmkJwo5o6o6YCBKScsICdNWemYv+mHjOS6keebmCcsICfpppnmg4XlvbHop4YnLCfomY7niZnnm7Tmkq0o5o6o6YCBKSddO1xuZm9yICh2YXIgaiBpbiBqdW1wKSB7XG4gICAgZC5wdXNoKHtcbiAgICAgICAgdGl0bGU6IGp1bXBbal0sXG4gICAgICAgIHVybDogJ2hpa2VyOi8vaG9tZUAnICsganVtcFtqXSxcbiAgICAgICAgY29sX3R5cGU6IFwidGV4dF8zXCJcbiAgICB9KTtcbn1cbnNldFJlc3VsdChkKTsiLCJzZWFyY2hfdXJsIjoiIiwiZ3JvdXAiOiLikaHpppnpm4Xmg4UiLCJzZWFyY2hGaW5kIjoiIiwiZGV0YWlsX2NvbF90eXBlIjoibW92aWVfMSIsImRldGFpbF9maW5kX3J1bGUiOiIiLCJzZGV0YWlsX2NvbF90eXBlIjoibW92aWVfMSIsInNkZXRhaWxfZmluZF9ydWxlIjoiIiwidWEiOiJtb2JpbGUiLCJwcmVSdWxlIjoiIiwicGFnZXMiOiJbe1wiY29sX3R5cGVcIjpcIm1vdmllXzNcIixcIm5hbWVcIjpcIuaOqOmAgVwiLFwicGF0aFwiOlwicHVzaFwiLFwicnVsZVwiOlwianM6XFxubGV0IGl0ZW1zID0gW107XFxubGV0IHB1c2hpbiA9IGRlY29kZVVSSUNvbXBvbmVudChnZXRQYXJhbShcXFwicHVzaHVybFxcXCIpKTtcXG5sZXQgdHZpcCA9IGdldEl0ZW0oJ2hpa2VydHZib3hzZXQnLCAnJyk7XFxuXFxuaXRlbXMucHVzaCh7XFxuICAgIHRpdGxlOiAn55S16KeGSVDvvJonICsgdHZpcCxcXG4gICAgdXJsOiBcXFwiaW5wdXQ6Ly9cXFwiICsgZ2V0SXRlbSgnaGlrZXJ0dmJveHNldCcsICdodHRwOi8vJyArIGdldElQKCkgKyAnOjk5NzgnKSArIFxcXCIvLy8v6K+36L6T5YWlVFZCb3jnq6/nmoRJUOWcsOWdgO+8jOWmgmh0dHA6Ly9cXFwiICsgZ2V0SVAoKSArIFxcXCI6OTk3OC5qczpzZXRJdGVtKCdoaWtlcnR2Ym94c2V0JyxpbnB1dCk7cmVmcmVzaFBhZ2UoKVxcXCIsXFxuICAgIGNvbF90eXBlOiAnZmxleF9idXR0b24nXFxufSk7XFxudmFyIHB1cmwgPSBwdXNoaW47XFxuXFxuaWYgKHB1c2hpbi5pbmNsdWRlcygnXFxcXG4nKSAmJiAhcHVzaGluLnN0YXJ0c1dpdGgoJ3snKSkge1xcbiAgICBwdXJsID0gcHVzaGluLnJlcGxhY2UoXFxcIlxcXFxuXFxcIiwgJyQnKTtcXG59XFxuaWYgKHB1c2hpbi5zdGFydHNXaXRoKCdodHRwJykgJiYgcHVzaGluLmluY2x1ZGVzKCc7eycpKSB7XFxuICAgIHB1cmwgPSBKU09OLnN0cmluZ2lmeSh7XFxuICAgICAgICBcXFwibmFtZVxcXCI6IFxcXCLmtbfpmJTnm7Tpk77mjqjpgIFcXFwiLFxcbiAgICAgICAgXFxcInVybFxcXCI6IHB1c2hpblxcbiAgICB9KVxcbn1cXG5pZiAocHVzaGluLnN0YXJ0c1dpdGgoJ2h0dHBzOi8vd3d3LmFsaXl1bmRyaXZlLmNvbS9zLycpKSB7XFxuICAgIGxldCByZWZ0b2tlbiA9IEpTT04ucGFyc2UoZmV0Y2goJ2hpa2VyOi8vZmlsZXMvcnVsZXMvaWN5L2ljeS1hbGktdG9rZW4uanNvbicsIHt9KSlbMF0ucmVmcmVzaF90b2tlbjtcXG4gICAgcHVybCA9IEpTT04uc3RyaW5naWZ5KHtcXG4gICAgICAgIFxcXCJ1cmxcXFwiOiBwdXNoaW4sXFxuICAgICAgICBcXFwicmVmcmVzaF90b2tlblxcXCI6IHJlZnRva2VuXFxuICAgIH0pXFxufVxcbmlmIChwdXNoaW4uaW5jbHVkZXMoJzo1MjAyMCcpKSB7XFxuICAgIGlmIChwdXNoaW4uaW5jbHVkZXMoJ3JlZGlyZWN0UGxheVVybCcpKSB7XFxuICAgICAgICBwdXJsID0gSlNPTi5zdHJpbmdpZnkoe1xcbiAgICAgICAgICAgIFxcXCJuYW1lXFxcIjogXFxcIua1t+mYlOaKleWxj+ebtOmTvlxcXCIsXFxuICAgICAgICAgICAgXFxcInVybFxcXCI6IHB1c2hpblxcbiAgICAgICAgfSlcXG4gICAgfSBlbHNlIHtcXG4gICAgICAgIHB1cmwgPSBKU09OLnN0cmluZ2lmeSh7XFxuICAgICAgICAgICAgXFxcIm5hbWVcXFwiOiBcXFwi5rW36ZiU572R6aG15oqV5bGPXFxcIixcXG4gICAgICAgICAgICBcXFwidXJsXFxcIjogcHVzaGluXFxuICAgICAgICB9KVxcbiAgICB9XFxufVxcblxcbi8vbG9nKCfmjqjpgIEnK3B1cmwpO1xcbnZhciBzdGF0ZSA9IHJlcXVlc3QodHZpcCArICcvYWN0aW9uJywge1xcbiAgICBoZWFkZXJzOiB7XFxuICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCcsXFxuICAgICAgICAvLydYLVJlcXVlc3RlZC1XaXRoJzogJ1hNTEh0dHBSZXF1ZXN0JyxcXG4gICAgICAgICdSZWZlcmVyJzogdHZpcFxcbiAgICB9LFxcbiAgICB0aW1lb3V0OiAyMDAwLFxcbiAgICBib2R5OiAnZG89cHVzaCZ1cmw9JyArIHB1cmwucmVwbGFjZSgvXFxcXCYvZywgJ++8hu+8hicpLnJlcGxhY2UoL3ZpZGVvXFxcXDpcXFxcL1xcXFwvL2csJycpLFxcbiAgICBtZXRob2Q6ICdQT1NUJ1xcbn0pO1xcbi8vbG9nKHN0YXRlKTtcXG5pZiAoc3RhdGUgPT0gJ29rJykge1xcbiAgICAvL2xvZyhzdGF0ZSk7XFxuICAgIGl0ZW1zLnB1c2goe1xcbiAgICAgICAgdGl0bGU6IFxcXCLiiJpcXFwiICsgc3RhdGUsXFxuICAgICAgICB1cmw6IFxcXCJoaWtlcjovL2VtcHR5XFxcIixcXG4gICAgICAgIGNvbF90eXBlOiBcXFwidGV4dF9jZW50ZXJfMVxcXCJcXG4gICAgfSk7XFxufSBlbHNlIHtcXG4gICAgLy9sb2coc3RhdGUpO1xcbiAgICBpdGVtcy5wdXNoKHtcXG4gICAgICAgIHRpdGxlOiBcXFwi4pWzXFxcIiArIHN0YXRlLFxcbiAgICAgICAgdXJsOiBcXFwiaGlrZXI6Ly9lbXB0eVxcXCIsXFxuICAgICAgICBjb2xfdHlwZTogXFxcInRleHRfY2VudGVyXzFcXFwiXFxuICAgIH0pO1xcblxcbn1cXG5zZXRSZXN1bHQoaXRlbXMpO1wifV0iLCJpY29uIjoiIiwicHJveHkiOiIifQ==\\\"\\n        });\\n        confirm({\\n            title: MY_RULE.title + '提示',\\n            content: '本规则依赖XYQ推送规则，点击下面的确定按钮导入XYQ推送，注意导入后一定要在XYQ推送里设置好TV端IP，否则推送功能不能用',\\n            confirm: ru,\\n            cancel: ru\\n        })\\n    }\\n    addListener(\\\"onClose\\\", $.toString(() => {\\n        clearMyVar(\\\"s\\\");\\n    }));\\n\\n    let tip = \\\"📽XYQ推送\\\";\\n    d.push({\\n        title: tip,\\n        url: $(\\\"#noLoading#\\\").lazyRule((tip) => {\\n            return 'hiker://home@XYQ推送'\\n        }, tip),\\n        col_type: \\\"text_3\\\",\\n        desc: \\\"\\\",\\n        pic_url: \\\"hiker://images/account\\\"\\n    });\\n    let dmode = getItem(\\\"dmode\\\", \\\"本地转码\\\");\\n    initConfig({\\n        mode: dmode\\n    });\\n\\n    d.push({\\n        title: \\\"🛠\\\" + dmode,\\n        url: \\\"select://\\\" + JSON.stringify({\\n            title: \\\"选择模式\\\",\\n            options: [\\\"本地转码\\\", \\\"官方APP\\\"],\\n            col: 1,\\n            js: $.toString(() => {\\n                setItem(\\\"dmode\\\", input);\\n                refreshPage();\\n                if (input == \\\"官方APP\\\") {\\n                    return \\\"toast://修改成功，请确保手机有安装阿里云盘官方APP\\\";\\n                } else {\\n                    return \\\"toast://修改成功。\\\"\\n                }\\n            })\\n        }),\\n        col_type: \\\"text_3\\\",\\n        desc: \\\"\\\",\\n        pic_url: \\\"hiker://images/icon1\\\"\\n    });\\n    d.push({\\n        title: '☁️我的云盘',\\n        url: 'hiker://home@MY阿里云盘',\\n        col_type: \\\"text_3\\\",\\n        desc: \\\"\\\",\\n        pic_url: \\\"\\\"\\n    });\\n\\n    d.push({\\n        title: '当前用户：' + ntoken[0].nick_name + ' ' + ntoken[0].user_name,\\n        url: $('hiker://empty#noRecordHistory#').rule(() => {\\n            let d = [];\\n            d.push({\\n                title: \\\"退出登录\\\",\\n                url: $('hiker://empty#noRecordHistory#').lazyRule(() => {\\n                    let ntoken = JSON.parse(fetch('hiker://files/rules/icy/icy-ali-token.json', {}));\\n                    //ntoken.splice(0, 1);\\n                    //ntoken.shift();\\n                    ntoken[0] = {};\\n                    writeFile(\\\"hiker://files/rules/icy/icy-ali-token.json\\\", JSON.stringify(ntoken));\\n                    back(true);\\n                    return \\\"hiker://empty\\\";\\n                }),\\n                col_type: \\\"text_center_1\\\"\\n            });\\n            setHomeResult(d);\\n        }),\\n        col_type: \\\"avatar\\\",\\n        pic_url: ntoken[0].avatar\\n    });\\n    d.push({\\n        title: '搜索',\\n        desc: '请输入关键词',\\n        col_type: 'input',\\n        url: $.toString(() => {\\n            if (/https\\\\:\\\\/\\\\/www.ali(pan|yundrive)\\\\.com\\\\/s\\\\//.test(input)) {\\n                return 'hiker://page/push?url=hiker://empty##' + encodeURIComponent(input) + '???fypage';\\n            } else {\\n                putMyVar('s', input);\\n                refreshPage();\\n                return 'hiker://empty'\\n            }\\n        }),\\n        extra: {\\n            defaultValue: getMyVar('s', '')\\n        }\\n    });\\n    let rules = $.require(\\\"hiker://page/data\\\")();\\n    d.push({\\n        title: \\\"\\\" == r ? \\\"““全部””\\\" : \\\"全部\\\",\\n        url: $(\\\"#noLoading#\\\").lazyRule(() => {\\n            clearItem(\\\"r\\\");\\n            refreshPage();\\n            return \\\"hiker://empty\\\"\\n        }),\\n        col_type: \\\"scroll_button\\\",\\n        desc: \\\"\\\",\\n        pic_url: \\\"\\\"\\n    });\\n    for (let it of rules) {\\n        d.push({\\n            title: it == r ? \\\"““\\\" + it + \\\"””\\\" : it,\\n            url: $(\\\"#noLoading#\\\").lazyRule((r) => {\\n                setItem(\\\"r\\\", r);\\n                refreshPage();\\n                return \\\"hiker://empty\\\"\\n            }, it),\\n            col_type: \\\"scroll_button\\\",\\n            desc: \\\"\\\",\\n            pic_url: \\\"\\\"\\n        });\\n    }\\n    d.push({\\n        col_type: 'line',\\n        extra: {\\n            id: 'ypj-l'\\n        }\\n    });\\n}\\nlet s = getMyVar('s', '');\\nif (s != \\\"\\\") {\\n    let p = MY_PAGE;\\n    let data = $.require(\\\"hiker://page/data\\\")(p, r != \\\"\\\" ? r : null);\\n\\n    let pageid = \\\"ypj-page\\\" + p;\\n    if (data.length > 0) {\\n        d.push({\\n            title: \\\"加载第\\\" + p + \\\"页中，进度：1/\\\" + data.length,\\n            url: \\\"\\\",\\n            col_type: \\\"text_center_1\\\",\\n            desc: \\\"\\\",\\n            pic_url: \\\"\\\",\\n            extra: {\\n                id: pageid\\n            }\\n        });\\n    }\\n    setResult(d);\\n    //log(data.length);\\n\\n    if (data.length > 0) {\\n        //多线程加载        \\n        let realPage = \\\"\\\" == r ? 1 : p;\\n        let tasks = data.map(it => {\\n            return {\\n                func: function(rule) {\\n                    return rule.find(s, realPage);\\n                },\\n                param: it,\\n                id: \\\"rule@\\\" + it.name\\n            }\\n        });\\n\\n        batchExecute(tasks, {\\n            func: function(param, id, error, result) {\\n                //log(\\\"listener: \\\" + (result || []).length)\\n                param.i = param.i + 1;\\n                if (result) {\\n                    try {\\n                        for (let it of result) {\\n                            param.j = param.j + 1;\\n                            addItemBefore(pageid, {\\n                                title: it.title.includes(\\\"““””\\\") ? it.title : \\\"““””\\\" + it.title.replace(new RegExp(\\\"<em>|</em>\\\", \\\"g\\\"), \\\"\\\").replace(new RegExp(s, \\\"g\\\"), \\\"<strong><span style=\\\\\\\"color: #1E90FF\\\\\\\">\\\" + s + \\\"</span></strong>\\\"),\\n                                desc: it.desc,\\n                                url: it.url,\\n                                pic_url: it.pic_url,\\n                                col_type: it.pic_url ? 'movie_1_vertical_pic' : \\\"text_1\\\",\\n                                extra: {\\n                                    id: \\\"__app\\\" + MY_PAGE + \\\"@\\\" + param.j,\\n                                    inheritTitle: false\\n                                }\\n                            })\\n                        }\\n                    } catch (e) {}\\n\\n                }\\n                if (param.i >= param.all) {\\n                    deleteItem(pageid)\\n                } else {\\n                    updateItem({\\n                        title: \\\"加载第\\\" + MY_PAGE + \\\"页中，进度：\\\" + (param.i + 1) + \\\"/\\\" + param.all,\\n                        url: \\\"\\\",\\n                        col_type: \\\"text_center_1\\\",\\n                        desc: \\\"\\\",\\n                        pic_url: \\\"\\\",\\n                        extra: {\\n                            id: pageid\\n                        }\\n                    })\\n                }\\n            },\\n            param: {\\n                all: data.length,\\n                i: 0,\\n                j: -1\\n            }\\n        })\\n    }\\n}\"},{\"col_type\":\"movie_3\",\"name\":\"搜索页面\",\"path\":\"soup\",\"rule\":\"js:\\nvar d = [];\\nif (MY_PARAMS.key) {\\n    putMyVar(\\\"s\\\", MY_PARAMS.key);\\n}\\neval(JSON.parse(fetch(\\\"hiker://page/sou\\\")).rule);\"},{\"col_type\":\"movie_3\",\"name\":\"CCOF\",\"path\":\"ccof\",\"rule\":\"var wrapu = (u) => {\\n    if(config.mode == \\\"本地转码\\\"){\\n        return 'hiker://page/push?url=hiker://empty##' + encodeURIComponent(u) + '???fypage'\\n    }\\n    if (/aliyundrive/.test(u)) {\\n        const [link, _share_pwd] = u.split('?share_pwd=');\\n        const [_link, _folderID] = link.split('/folder/');\\n        let share_pwd = (_share_pwd || '').split('#name=')[0] || '';\\n        let shareId = _link.split('com/s/')[1];\\n        return 'smartdrive://share/browse?shareId=' + shareId + '&sharePwd=' + share_pwd;\\n    }\\n    return \\\"web://\\\" + u;\\n};\\n\\n$.exports = {\\n    name: 'CCOF',\\n    page: true,\\n    find: function(s, page) {\\n        let d = []\\n        const {\\n            bytesToSize,\\n            color\\n        } = $.require('hiker://page/tools');\\n        let html = fetch('https://pan.ccof.cc/api/search', {\\n            headers: {\\n                \\\"content-type\\\": 'application/json',\\n                'Referer': 'https://pan.ccof.cc/search?keyword=' + s\\n            },\\n            body: {\\n                \\\"pageSize\\\": 20,\\n                \\\"pageNum\\\": page,\\n                \\\"keyword\\\": s,\\n                \\\"fromMobile\\\": true\\n            },\\n            method: 'POST'\\n        })\\n        let list = JSON.parse(html)\\n            .data.rows\\n        for (let i = 0; i < list.length; i++) {\\n            let it = list[i]\\n            let title = it.fileName\\n            let murl = it.url\\n            let type = it.type.replace(/folder/, '文件夹').replace(/file/, '文件')\\n            if (title.includes(s)) {\\n                d.push({\\n                    title: title,\\n                    desc: '““””<font color=#f13b66a>CCOF</font>&nbsp;' + '文件类型：' + type + '，文件大小：' + bytesToSize(it.size),\\n                    //url: 'hiker://page/detail?rule=云盘汇影&url=' + murl + '??fypage'\\n                    //url: 'hiker://page/push?url=hiker://empty##' + encodeURIComponent(murl) + '???fypage'\\n                    url: wrapu(murl)\\n                })\\n            }\\n        }\\n        return d\\n    }\\n}\"},{\"col_type\":\"movie_3\",\"name\":\"工具\",\"path\":\"tools\",\"rule\":\"function bytesToSize(size) {\\n    if (size < 0.1 * 1024) {\\n        //小于0.1KB，则转化成B\\n        size = size.toFixed(2) + \\\"B\\\";\\n    } else if (size < 0.1 * 1024 * 1024) {\\n        // 小于0.1MB，则转化成KB\\n        size = (size / 1024).toFixed(2) + \\\"KB\\\";\\n    } else if (size < 0.1 * 1024 * 1024 * 1024) {\\n        // 小于0.1GB，则转化成MB\\n        size = (size / (1024 * 1024)).toFixed(2) + \\\"MB\\\";\\n    } else {\\n        // 其他转化成GB\\n        size = (size / (1024 * 1024 * 1024)).toFixed(2) + \\\"GB\\\";\\n    }\\n    // 转成字符串\\n    let sizeStr = size + \\\"\\\",\\n        // 获取小数点处的索引\\n        index = sizeStr.indexOf(\\\".\\\"),\\n        // 获取小数点后两位的值\\n        dou = sizeStr.substr(index + 1, 2);\\n    // 判断后两位是否为00，如果是则删除00\\n    if (dou === \\\"00\\\") return sizeStr.substring(0, index) + sizeStr.substr(index + 3, 2);\\n    return size;\\n}\\n$.exports.bytesToSize = bytesToSize;\\n$.exports.color = function(text, color) {\\n    text += \\\"\\\";\\n    if (text.indexOf(\\\"““””\\\") === 0) {\\n        text.replace(\\\"““””\\\", \\\"\\\");\\n    }\\n    return \\\"““””<font color='\\\" + color + \\\"'>\\\" + text + \\\"</font>\\\";\\n}\\n\\n$.exports.sleep = function(timeout) {\\n    java.lang.Thread.sleep(timeout);\\n}\\n\\nfunction htmlTag(tag, text) {\\n    text += \\\"\\\";\\n    if (text.indexOf(\\\"““””\\\") === 0) {\\n        text.replace(\\\"““””\\\", \\\"\\\");\\n    }\\n    return \\\"““””\\\" + \\\"<\\\" + tag + \\\">\\\" + text + \\\"</\\\" + tag + \\\">\\\";\\n\\n}\\n$.exports.htmlTag = htmlTag;\\n$.exports.small = function(text) {\\n    return htmlTag(\\\"small\\\", text);\\n}\\n\\nfunction getTime(file,isStandard) {\\n    isStandard = isStandard||false;\\n    let tTime = file.updated_at || file.time_str || \\\"\\\";\\n    tTime = tTime.split(\\\"T\\\");\\n    let date = tTime[0];\\n    if(isStandard){\\n        date = date.replace(/-/g,\\\"/\\\");\\n    }\\n    tTime = tTime[1].split(/Z|\\\\./);\\n    date += \\\" \\\" + tTime[0];\\n    return date;\\n}\\nfunction getTimeInt(timeStr){\\n    return (new Date(timeStr)).getTime()\\n}\\n$.exports.getTime = getTime;\\n\\nlet chnNumChar = {\\n    零: 0,\\n    一: 1,\\n    二: 2,\\n    三: 3,\\n    四: 4,\\n    五: 5,\\n    六: 6,\\n    七: 7,\\n    八: 8,\\n    九: 9\\n};\\n\\nlet chnNameValue = {\\n    十: {\\n        value: 10,\\n        secUnit: false\\n    },\\n    百: {\\n        value: 100,\\n        secUnit: false\\n    },\\n    千: {\\n        value: 1000,\\n        secUnit: false\\n    },\\n    万: {\\n        value: 10000,\\n        secUnit: true\\n    },\\n    亿: {\\n        value: 100000000,\\n        secUnit: true\\n    }\\n}\\n\\nfunction ChineseToNumber(chnStr) {\\n    let rtn = 0;\\n    let section = 0;\\n    let number = 0;\\n    let secUnit = false;\\n    let str = chnStr.split('');\\n\\n    for (let i = 0; i < str.length; i++) {\\n        let num = chnNumChar[str[i]];\\n        if (typeof num !== 'undefined') {\\n            number = num;\\n            if (i === str.length - 1) {\\n                section += number;\\n            }\\n        } else {\\n            let unit = chnNameValue[str[i]].value;\\n            secUnit = chnNameValue[str[i]].secUnit;\\n            if (secUnit) {\\n                section = (section + number) * unit;\\n                rtn += section;\\n                section = 0;\\n            } else {\\n                section += (number * unit);\\n            }\\n            number = 0;\\n        }\\n    }\\n    return rtn + section;\\n}\\n\\nfunction nameCompare(a, b) {\\n    if (a == null || b == null)\\n        return a == null ? b == null ? 0 : -1 : 1;\\n\\n    a = a.replace(/([零一二三四五六七八九十百千万亿])/g, function(match, p1, p2, p3, offset, string) {\\n        // p1 is nondigits, p2 digits, and p3 non-alphanumerics\\n        return ChineseToNumber(p1);\\n    })\\n    b = b.replace(/([零一二三四五六七八九十百千万亿])/g, function(match, p1, p2, p3, offset, string) {\\n        // p1 is nondigits, p2 digits, and p3 non-alphanumerics\\n        return ChineseToNumber(p1);\\n    })\\n\\n    let NUMBERS = java.util.regex.Pattern.compile(\\\"(?<=\\\\\\\\D)(?=\\\\\\\\d)|(?<=\\\\\\\\d)(?=\\\\\\\\D)\\\")\\n    let split1 = NUMBERS.split(new java.lang.String(a));\\n    let split2 = NUMBERS.split(new java.lang.String(b));\\n\\n    for (let i = 0; i < Math.min(split1.length, split2.length); i++) {\\n        let c1 = split1[i].charCodeAt(0);\\n        let c2 = split2[i].charCodeAt(0);\\n        let cmp = 0;\\n        let zeroCharCode = '0'.charCodeAt(0);\\n        let nineCharCode = '9'.charCodeAt(0);\\n\\n        if (c1 >= zeroCharCode && c1 <= nineCharCode && c2 >= zeroCharCode && c2 <= nineCharCode) {\\n            cmp = new java.math.BigInteger(split1[i]).compareTo(new java.math.BigInteger(split2[i]));\\n        }\\n\\n        if (cmp === 0) {\\n            let regex = /[a-zA-Z0-9]/\\n            let s1 = String(split1[i])\\n            let s2 = String(split2[i])\\n            if (regex.test(s1) || regex.test(s2)) {\\n                cmp = new java.lang.String(split1[i]).compareTo(new java.lang.String(split2[i]));\\n                // cmp = s1.localeCompare(s2, 'en')\\n            } else {\\n                cmp = s1.localeCompare(s2, 'zh')\\n            }\\n        }\\n\\n        if (cmp !== 0) {\\n            return cmp;\\n        }\\n    }\\n    let lengthCmp = split1.length - split2.length;\\n    // if (lengthCmp !== 0) lengthCmp = lengthCmp > 0 ? -1 : 1;\\n    return lengthCmp;\\n}\\n\\n$.exports.sorts = function(list, sort) {\\n    if (sort === \\\"类型\\\") {\\n        // log(\\\"类型排序\\\");\\n        list.sort(function(a, b) {\\n            return a.type - b.type\\n        });\\n    } else if (sort === \\\"名称\\\") {\\n        // log(\\\"名称排序\\\");\\n        // list.sort(function(a, b) {\\n        //     return a.name.localeCompare(b.name, \\\"zh\\\")\\n        // });\\n        list.sort(function(a, b) {\\n            return nameCompare(a.name||a.title, b.name||b.title);\\n        });\\n    } else if (sort === \\\"大小\\\") {\\n        // log(\\\"大小排序\\\");\\n        list.sort(function(a, b) {\\n            return (a.size || Number(a.size_str) || 0) - (b.size || Number(b.size_str) || 0);\\n        });\\n    }else if (sort === \\\"时间\\\") {\\n        // log(\\\"时间排序\\\");\\n        list.sort(function(a, b) {\\n            return getTimeInt(getTime(a,true)) - getTimeInt(getTime(b,true))\\n        });\\n    }\\n    return list\\n}\\n\\nfunction similar(s, t, f) {//判断两个字符串之间的相似度\\n    if (!s || !t) {\\n        return 0\\n    }\\n    if(s === t){\\n        return 100;\\n    }\\n    var l = s.length > t.length ? s.length : t.length\\n    var n = s.length\\n    var m = t.length\\n    var d = []\\n    f = f || 2\\n    var min = function (a, b, c) {\\n        return a < b ? (a < c ? a : c) : (b < c ? b : c)\\n    }\\n    var i, j, si, tj, cost\\n    if (n === 0) return m\\n    if (m === 0) return n\\n    for (i = 0; i <= n; i++) {\\n        d[i] = []\\n        d[i][0] = i\\n    }\\n    for (j = 0; j <= m; j++) {\\n        d[0][j] = j\\n    }\\n    for (i = 1; i <= n; i++) {\\n        si = s.charAt(i - 1)\\n        for (j = 1; j <= m; j++) {\\n            tj = t.charAt(j - 1)\\n            if (si === tj) {\\n                cost = 0\\n            } else {\\n                cost = 1\\n            }\\n            d[i][j] = min(d[i - 1][j] + 1, d[i][j - 1] + 1, d[i - 1][j - 1] + cost)\\n        }\\n    }\\n    let res = (1 - d[n][m] / l) *100\\n    return res.toFixed(f)\\n}\\n\\n$.exports.similar = similar;\\n$.exports.removeExt = function (file){\\n    return file.split('.').slice(0,-1).join('.')\\n};\"},{\"col_type\":\"movie_3\",\"name\":\"u\",\"path\":\"u\",\"rule\":\"$.exports = function(rule, origin, mode) {\\n    return $.toString((rule, origin, mode) => {\\n        let host = origin.replace(new RegExp(\\\"http://|https://\\\"), \\\"\\\").split(\\\"/\\\")[0];\\n        let hosts = host.split(\\\".\\\");\\n        if (hosts.length > 2) {\\n            host = hosts[hosts.length - 2] + \\\".\\\" + hosts[hosts.length - 1];\\n        }\\n        if (input.startsWith(\\\"magnet\\\")) {\\n            confirm({\\n                title: \\\"温馨提示\\\",\\n                content: \\\"检测到新的磁链地址，点击确定按钮即可播放，点击取消按钮可以复制链接\\\",\\n                confirm: $.toString((mag) => {\\n                    return mag;\\n                }, input),\\n                cancel: $.toString((mag) => {\\n                    return \\\"copy://\\\" + mag\\n                }, input)\\n            })\\n            return true;\\n        } else if (/aliyundrive\\\\.com|alipan\\\\.com/.test(input) && mode != \\\"官方APP\\\") {\\n            //log(input);\\n            if (input.includes('checkurl?url=') && input.includes('&urlrefer')) {\\n                input = decodeURIComponent(input.split('&urlrefer')[0].split('checkurl?url=')[1]);\\n                //log('贴吧'+input);\\n            }\\n            return $.toString((url, rule) => {\\n                fy_bridge_app.open(JSON.stringify({\\n                    title: \\\"阿里云盘\\\",\\n                    //url: \\\"hiker://page/detail?rule=云盘汇影&url=\\\" + url + '??fypage',\\n                    url: \\\"hiker://page/push?rule=\\\" + rule + \\\"&url=hiker://empty##\\\" + encodeURIComponent(url) + '???fypage',\\n                }))\\n            }, input, rule)\\n        } else if (/\\\\.(mp3|flac|m4a)$/.test(input)) {\\n            //log(input);\\n            return $.toString((url, rule) => {\\n                fy_bridge_app.playVideo(url);\\n            }, input, rule)\\n        } else if (!input.includes(host) && input.startsWith(\\\"http\\\")) {\\n            //log(input);\\n            return $.toString((url, rule, mode) => {\\n                fy_bridge_app.open(JSON.stringify({\\n                    title: \\\"详情\\\",\\n                    url: \\\"hiker://page/ysfx?rule=\\\" + rule + \\\"&r=\\\" + rule + \\\"&mode=\\\" + mode + \\\"##\\\" + url,\\n                }))\\n            }, input, rule, mode);\\n        } else if (!input.startsWith(\\\"http\\\")) {\\n            //log(input);\\n            //能唤起APP的白名单\\n            let white = [\\n                \\\"qklink\\\",\\n                \\\"bdnetdisk\\\",\\n                \\\"xunleiapp\\\"\\n            ];\\n            let inWhite = white.filter(it => input.startsWith(it)).length > 0;\\n            if (!inWhite) {\\n                return false;\\n            }\\n            return $.toString((url, rule) => {\\n                fy_bridge_app.openThirdApp && fy_bridge_app.openThirdApp(url);\\n            }, input, rule)\\n        } else {\\n\\n        }\\n    }, rule, origin, mode);\\n}\"},{\"col_type\":\"movie_3\",\"name\":\"ysfx\",\"path\":\"ysfx\",\"rule\":\"js:\\nvar d = [];\\nlet rule = getParam(\\\"r\\\").split(\\\"##\\\")[0];\\nlet mode = (getParam(\\\"mode\\\") || \\\"\\\").split(\\\"##\\\")[0];\\nlet url = MY_URL.split(\\\"##\\\")[1];\\nlet ite = $.require(\\\"hiker://page/u\\\")(rule, getHome(url),mode);\\nlet js = $.toString(() => {\\n    try {\\n        if (document.title && document.title.length) {\\n            let r = $$$().lazyRule((t) => {\\n                setPageTitle(t);\\n            }, document.title);\\n            fy_bridge_app.parseLazyRule(r);\\n        }\\n    } catch (e) {\\n        fy_bridge_app.log(e.toString());\\n    }\\n});\\nd.push({\\n    title: \\\"\\\",\\n    url: url,\\n    col_type: \\\"x5_webview_single\\\",\\n    desc: \\\"100%&&float\\\",\\n    pic_url: \\\"\\\",\\n    extra: {\\n        urlInterceptor: ite,\\n        js: js,\\n        canBack: true,\\n        jsLoadingInject: true,\\n        floatVideo: true\\n    }\\n});\\nd.push({\\n    col_type: \\\"line\\\",\\n    extra: {\\n        id: url\\n    }\\n});\\nsetResult(d);\"},{\"col_type\":\"movie_3\",\"name\":\"推送\",\"path\":\"push\",\"rule\":\"js:\\n//log(MY_URL);\\nvar items = [];\\nvar realurl = MY_URL.split('##')[1].split('???')[0];\\nif (MY_PAGE == 1) {\\n    items.push({\\n        title: \\\"📽 推送到TVBox 📺\\\",\\n        url: $(realurl).lazyRule(() => {\\n            input = decodeURIComponent(input);\\n            return 'hiker://page/push?rule=XYQ推送&pushurl=' + encodeURIComponent(input);\\n        }),\\n        col_type: \\\"text_2\\\",\\n        desc: \\\"\\\",\\n        pic_url: \\\"\\\"\\n    }, {\\n        title: \\\"☁️阿里APP打开💽\\\",\\n        url: $(realurl).lazyRule(() => {\\n            //input = decodeURIComponent(input);\\n            const [link, _share_pwd] = decodeURIComponent(input).split('?share_pwd=');\\n            const [_link, _folderID] = link.split('/folder/');\\n            let share_pwd = (_share_pwd || '').split('#name=')[0] || '';\\n            let shareId = _link.split('com/s/')[1];\\n            return 'smartdrive://share/browse?shareId=' + shareId + '&sharePwd=' + share_pwd;\\n        }),\\n        col_type: \\\"text_2\\\",\\n        desc: \\\"\\\",\\n        pic_url: \\\"\\\"\\n    });\\n}\\nif ((decodeURIComponent(realurl).includes('www.aliyundrive')||decodeURIComponent(realurl).includes('www.alipan')) && !realurl.includes('%3B%7B')) {\\n    eval(JSON.parse(fetch('hiker://page/sharid', {})).rule)\\n}\\nsetResult(items);\"},{\"col_type\":\"movie_3\",\"name\":\"推送代码\",\"path\":\"pushcode\",\"rule\":\"js:\\nlet push = JSON.stringify({\\n    \\\"name\\\": pushname,\\n    \\\"url\\\": tuisong.join('#'),\\n    \\\"share_id\\\": shareId,\\n    \\\"refresh_token\\\": reftoken\\n}).replace(/\\\\&/g, '＆＆');\\nif (tuisong.length > 0) {\\n    items.unshift({\\n        title: \\\"📽推送当前页音视频📺\\\",\\n        url: $(push).lazyRule(() => {\\n            return 'hiker://page/push?rule=XYQ推送&pushurl=' + encodeURIComponent(input);\\n        }),\\n        col_type: \\\"scroll_button\\\"\\n    });\\n    items.unshift({\\n        title: (getItem('quality', '') == '1' ? '原画播√' : '转码播√'),\\n        url: `hiker://empty@lazyRule=.js:getItem('quality','0')=='1'?setItem('quality','0'):setItem('quality','1');refreshPage();'toast://切换成功！'`,\\n        col_type: 'scroll_button'\\n    });\\n    items.unshift({\\n        title: (getItem('singlepush', '') == '1' ? '单推√' : '单推╳'),\\n        url: `hiker://empty@lazyRule=.js:getItem('singlepush','0')=='1'?setItem('singlepush','0'):setItem('singlepush','1');refreshPage();'toast://切换成功！'`,\\n        col_type: 'scroll_button'\\n    });\\n}\"},{\"col_type\":\"movie_3\",\"name\":\"分享资源一级\",\"path\":\"sharid\",\"rule\":\"js:\\n//var items = [];\\nfunction formatDate(_date, fmt) {\\n    let date = !isNaN(_date) ? new Date(_date * 1000) : new Date(_date);\\n    return $.dateFormat(date, fmt || \\\"yyyy-MM-dd HH:mm:ss\\\")\\n}\\n\\nfunction formatSize(size) {\\n    if (!size) {\\n        return '';\\n    }\\n    const units = ['B', 'KB', 'MB', 'GB', 'TB', 'PB', 'EB', 'ZB', 'YB'];\\n    let i = 0;\\n    while (size >= 1024) {\\n        size /= 1024;\\n        i++;\\n    }\\n    size = i ? Number(size.toFixed(2)) : size;\\n    return `${size} ${units[i]}`;\\n}\\n//log(realurl);\\n\\nif (MY_PAGE == 1) {\\n    clearMyVar('nextpage');\\n}\\nif (MY_PAGE > 1 && getMyVar('nextpage', '') == '') {\\n    log('没有下一页');\\n} else {\\n    try {\\n        var reftoken = JSON.parse(fetch('hiker://files/rules/icy/icy-ali-token.json', {}))[0].refresh_token;\\n        var shareId = decodeURIComponent(realurl).split('com/s/')[1].substring(0, 11);\\n        let getshar = fetch('https://api.aliyundrive.com/adrive/v3/share_link/get_share_by_anonymous', {\\n            headers: {\\n                'Content-Type': 'application/json'\\n            },\\n            body: '{\\\"share_id\\\":\\\"' + shareId + '\\\"}',\\n            method: 'POST'\\n        });\\n        //log(getshar);\\n        if (getshar.includes(\\\"share_link is forbidden\\\")) {\\n            items.push({\\n                title: '文件违规，根据相关法律法规要求，该文件已禁止访问。',\\n                url: decodeURIComponent(getResCode().split('##')[1]),\\n                col_type: 'text_center_1'\\n            });\\n        }\\n        if (getshar.includes(\\\"share_link is cancelled\\\") || getshar.includes(\\\"share_link is expired\\\")) {\\n            items.push({\\n                title: '来晚啦，该分享已失效。',\\n                url: decodeURIComponent(getResCode().split('##')[1]),\\n                col_type: 'text_center_1'\\n            });\\n        }\\n        if (getshar.includes(\\\"share_link cannot be found\\\")) {\\n            items.push({\\n                title: '你打开的链接有误，请重试。',\\n                url: decodeURIComponent(getResCode().split('##')[1]),\\n                col_type: 'text_center_1'\\n            });\\n        }\\n\\n        let pushname = JSON.parse(getshar).file_infos[0].file_name;\\n\\n        var sharetoken = JSON.parse(fetch('https://api.aliyundrive.com/v2/share_link/get_share_token', {\\n            headers: {\\n                'Content-Type': 'application/json'\\n            },\\n            body: '{\\\"share_pwd\\\":\\\"\\\",\\\"share_id\\\":\\\"' + shareId + '\\\"}',\\n            method: 'POST'\\n        })).share_token;\\n        //log(sharetoken);\\n\\n        let next = getMyVar('nextpage', '') != '' ? ',\\\"marker\\\":\\\"' + getMyVar('nextpage') + '\\\"' : '';\\n        if (!decodeURIComponent(realurl).includes('/folder/')) {\\n            //if(!listyp == 'folder'){\\n            var rescod = fetch('https://api.aliyundrive.com/adrive/v3/file/list', {\\n                headers: {\\n                    'Content-Type': 'application/json',\\n                    'X-Share-Token': sharetoken\\n                },\\n                body: '{\\\"share_id\\\":\\\"' + shareId + '\\\",\\\"parent_file_id\\\":\\\"root\\\",\\\"limit\\\":100,\\\"image_thumbnail_process\\\":\\\"image/resize,w_160/format,jpeg\\\",\\\"image_url_process\\\":\\\"image/resize,w_1920/format,jpeg\\\",\\\"video_thumbnail_process\\\":\\\"video/snapshot,t_1000,f_jpg,ar_auto,w_300\\\",\\\"order_by\\\":\\\"name\\\",\\\"order_direction\\\":\\\"ASC\\\"' + next + '}',\\n                method: 'POST'\\n            });\\n            //log(rescod);\\n            if (rescod.includes(\\\"ParamFlowException\\\")) {\\n                refreshPage();\\n            }\\n            var listyp = JSON.parse(rescod).items[0].type;\\n            var pfileid = JSON.parse(rescod).items[0].file_id;\\n        } else {\\n            var listyp = 'folder';\\n            var pfileid = decodeURIComponent(realurl).split('folder/')[1]\\n\\n        }\\n        //log(html);\\n        if (listyp == 'folder') {\\n            var rescod = fetch('https://api.aliyundrive.com/adrive/v3/file/list', {\\n                headers: {\\n                    'Content-Type': 'application/json',\\n                    'X-Share-Token': sharetoken\\n                },\\n                body: '{\\\"share_id\\\":\\\"' + shareId + '\\\",\\\"parent_file_id\\\":\\\"' + pfileid + '\\\",\\\"limit\\\":100,\\\"image_thumbnail_process\\\":\\\"image/resize,w_160/format,jpeg\\\",\\\"image_url_process\\\":\\\"image\\\\/resize,w_1920/format,jpeg\\\",\\\"video_thumbnail_process\\\":\\\"video/snapshot,t_1000,f_jpg,ar_auto,w_300\\\",\\\"order_by\\\":\\\"name\\\",\\\"order_direction\\\":\\\"ASC\\\"' + next + '}',\\n                method: 'POST'\\n            });\\n            if (rescod.includes(\\\"ParamFlowException\\\")) {\\n                refreshPage();\\n            }\\n        } //取文件夹\\n        //log(rescod);\\n\\n\\n        if (JSON.parse(rescod).next_marker) {\\n            let marker = JSON.parse(rescod).next_marker;\\n            if (marker.length > 10) {\\n                putMyVar('nextpage', marker);\\n            } else {\\n                clearMyVar('nextpage');\\n            }\\n        }\\n        var conts = JSON.parse(rescod).items;\\n        if (conts.length < 1) {\\n            items.push({\\n                title: '该文件夹下没有分享的文件',\\n                url: 'hiker://empty',\\n                col_type: 'text_center_1'\\n            });\\n        }\\n        var dongtai = JSON.parse(fetch('hiker://page/lazyurl', {})).rule.toString();\\n\\n        var tuisong = [];\\n        var zimu = [];\\n        for (let i in conts) {\\n            //var listyp = conts[i].type;\\n            if (conts[i].type != 'folder') {\\n                let fname = conts[i].name;\\n                let ftype = fname.toLowerCase();\\n                let cate = conts[i].category;\\n                if (ftype.endsWith('.srt') || ftype.endsWith('.vtt') || ftype.endsWith('.ass')) {\\n                    zimu.push({\\n                        tit: fname.substring(0, fname.lastIndexOf(\\\".\\\")),\\n                        ext: conts[i].file_extension,\\n                        fid: conts[i].file_id\\n                    });\\n                };\\n                if (cate == 'video' || cate == 'audio') {\\n                    tuisong.push(\\n                        fname.replace(/\\\\#/g, '_').replace(/\\\\$/g, '_') + '$' + cate + '|' + conts[i].file_id\\n                    );\\n                };\\n            }\\n        }\\n\\n        for (var i in conts) {\\n            var listyp = conts[i].type;\\n            if (listyp != 'folder') {\\n                var cate = conts[i].category;\\n                var fname = conts[i].name;\\n                if (cate == 'video') {\\n                    var title = '📺' + conts[i].name;\\n                } else if (cate == 'doc') {\\n                    var title = '📖' + conts[i].name;\\n                } else if (cate == 'image') {\\n                    var title = '🖼' + conts[i].name;\\n                } else if (cate == 'zip') {\\n                    var title = '📦' + conts[i].name;\\n                } else {\\n                    var title = conts[i].name\\n                }\\n\\n                // if (cate == 'video' || cate == 'audio' || cate == 'image') {\\n                items.push({\\n                    title: title,\\n                    url: $(conts[i].file_id).lazyRule((shareId, dongtai, cate, fname, reftoken, zimu) => {\\n                        if (getItem('singlepush', '') == '1') {\\n                            return 'hiker://page/push?rule=XYQ推送&pushurl=' + encodeURIComponent(JSON.stringify({\\n                                \\\"name\\\": fname,\\n                                \\\"refresh_token\\\": reftoken,\\n                                \\\"url\\\": fname.replace(/\\\\#/g, '_').replace(/\\\\$/g, '_') + '$' + cate + '|' + input,\\n                                \\\"share_id\\\": shareId\\n                            }));\\n                        } else {\\n                            eval(dongtai);\\n                            return play\\n                        }\\n                    }, shareId, dongtai, cate, fname, reftoken, zimu),\\n                    desc: formatDate(conts[i].updated_at) + '  ' + formatSize(conts[i].size),\\n                    extra: {\\n                        longClick: [{\\n                            title: '推送到TVBox',\\n                            js: $.toString((shareId, fileid, cate, fname, reftoken) => {\\n                                return 'hiker://page/push?rule=XYQ推送&pushurl=' + encodeURIComponent(JSON.stringify({\\n                                    \\\"name\\\": fname,\\n                                    \\\"refresh_token\\\": reftoken,\\n                                    \\\"url\\\": fname.replace(/\\\\#/g, '_').replace(/\\\\$/g, '_') + '$' + cate + '|' + fileid,\\n                                    \\\"share_id\\\": shareId\\n                                }));\\n                            }, shareId, conts[i].file_id, cate, fname, reftoken)\\n                        }],\\n                        id: conts[i].file_id\\n                    },\\n                    col_type: 'text_1'\\n\\n                });\\n\\n                /*} else if (i == 0) {\\n                    items.push({\\n                        title: '当前文件夹下没有音视频文件',\\n                        url: 'hiker://empty',\\n                        col_type: 'text_center_1'\\n                    });\\n                }*/\\n\\n            } else {\\n                items.push({\\n                    title: '📂' + conts[i].name,\\n                    url: $('hiker://empty' + conts[i].file_id + '???fypage').rule((shareId, sharetoken, pushname) => {\\n                        eval(JSON.parse(fetch('hiker://page/ruleloop', {})).rule);\\n                    }, shareId, sharetoken, conts[i].name),\\n                    col_type: 'flex_button'\\n                });\\n\\n            } //end if\\n        } //end for i\\n        //log(tuisong);\\n        eval(JSON.parse(fetch('hiker://page/pushcode', {})).rule);\\n\\n    } catch (e) {\\n        /*\\n        items.push({\\n            title: '欧欧，报错了。',\\n            url: decodeURIComponent(getResCode().split('##')[1]),\\n            col_type: 'text_center_1'\\n        });\\n        */\\n    }\\n}\\n/*\\nsetHomeResult({\\n    data: items\\n});\\n*/\"},{\"col_type\":\"movie_3\",\"name\":\"分享资源嵌套\",\"path\":\"ruleloop\",\"rule\":\"var items = [];\\n\\nfunction formatDate(_date, fmt) {\\n    let date = !isNaN(_date) ? new Date(_date * 1000) : new Date(_date);\\n    return $.dateFormat(date, fmt || \\\"yyyy-MM-dd HH:mm:ss\\\")\\n}\\n\\nfunction formatSize(size) {\\n    if (!size) {\\n        return '';\\n    }\\n    const units = ['B', 'KB', 'MB', 'GB', 'TB', 'PB', 'EB', 'ZB', 'YB'];\\n    let i = 0;\\n    while (size >= 1024) {\\n        size /= 1024;\\n        i++;\\n    }\\n    size = i ? Number(size.toFixed(2)) : size;\\n    return `${size} ${units[i]}`;\\n}\\n\\n//log(getResCode());\\nif (MY_PAGE == 1) {\\n    clearMyVar('nextpage');\\n    items.unshift({\\n        title: \\\"📽推送当前文件夹📺\\\",\\n        url: $('https://www.aliyundrive.com/s/' + shareId + '/folder/' + getResCode().split('???')[0]).lazyRule(() => {\\n            return 'hiker://page/push?rule=XYQ推送&pushurl=' + encodeURIComponent(input);\\n        }),\\n        col_type: \\\"scroll_button\\\"\\n    });\\n}\\nif (MY_PAGE > 1 && getMyVar('nextpage', '') == '') {\\n    log('没有下一页');\\n} else {\\n    let reftoken = JSON.parse(fetch('hiker://files/rules/icy/icy-ali-token.json', {}))[0].refresh_token;\\n\\n    let next = getMyVar('nextpage', '') != '' ? ',\\\"marker\\\":\\\"' + getMyVar('nextpage') + '\\\"' : '';\\n\\n    var rescod = fetch('https://api.aliyundrive.com/adrive/v3/file/list', {\\n        headers: {\\n            'Content-Type': 'application/json',\\n            'X-Share-Token': sharetoken\\n        },\\n        body: '{\\\"share_id\\\":\\\"' + shareId + '\\\",\\\"parent_file_id\\\":\\\"' + getResCode().split('???')[0] + '\\\",\\\"limit\\\":100,\\\"image_thumbnail_process\\\":\\\"image/resize,w_160/format,jpeg\\\",\\\"image_url_process\\\":\\\"image\\\\/resize,w_1920/format,jpeg\\\",\\\"video_thumbnail_process\\\":\\\"video/snapshot,t_1000,f_jpg,ar_auto,w_300\\\",\\\"order_by\\\":\\\"name\\\",\\\"order_direction\\\":\\\"ASC\\\"' + next + '}',\\n        method: 'POST'\\n    });\\n    //log(rescod);\\n    if (rescod.includes(\\\"ParamFlowException\\\")) {\\n        refreshPage();\\n    }\\n    if (JSON.parse(rescod).next_marker) {\\n        let marker = JSON.parse(rescod).next_marker;\\n        if (marker.length > 10) {\\n            putMyVar('nextpage', marker);\\n        } else {\\n            clearMyVar('nextpage');\\n        }\\n    }\\n    var conts = JSON.parse(rescod).items;\\n    /*\\n    if (conts.length < 1) {\\n        items.push({\\n            title: '该文件夹下没有分享的文件',\\n            url: 'hiker://empty',\\n            col_type: 'text_center_1'\\n        });\\n    }\\n    */\\n    var dongtai = JSON.parse(fetch('hiker://page/lazyurl', {})).rule.toString();\\n    \\n    var tuisong = [];\\n    var zimu = [];\\n    for (let i in conts) {\\n        //var listyp = conts[i].type;\\n        if (conts[i].type != 'folder') {\\n            let fname = conts[i].name;\\n            let ftype = fname.toLowerCase();\\n            let cate = conts[i].category;\\n            if (ftype.endsWith('.srt') || ftype.endsWith('.vtt') || ftype.endsWith('.ass')) {\\n                zimu.push({\\n                    tit: fname.substring(0, fname.lastIndexOf(\\\".\\\")),\\n                    ext: conts[i].file_extension,\\n                    fid: conts[i].file_id\\n                });\\n            };\\n            if (cate == 'video' || cate == 'audio') {\\n                tuisong.push(\\n                    fname.replace(/\\\\#/g, '_').replace(/\\\\$/g, '_') + '$' + cate + '|' + conts[i].file_id\\n                );\\n            };\\n        }\\n    }\\n    \\n    for (var i in conts) {\\n        var listyp = conts[i].type;\\n        if (listyp != 'folder') {\\n            var cate = conts[i].category;\\n            var fname = conts[i].name;\\n            if (cate == 'video') {\\n                var title = '📺' + conts[i].name;\\n            } else if (cate == 'doc') {\\n                var title = '📖' + conts[i].name;\\n            } else if (cate == 'image') {\\n                var title = '🖼' + conts[i].name;\\n            } else if (cate == 'zip') {\\n                var title = '📦' + conts[i].name;\\n            } else {\\n                var title = conts[i].name\\n            }\\n            //if (cate == 'video' || cate == 'audio' || cate == 'image') {\\n            items.push({\\n                title: title,\\n                url: $(conts[i].file_id).lazyRule((shareId, dongtai, cate, fname, reftoken,zimu) => {\\n                    if (getItem('singlepush', '') == '1') {\\n                        return 'hiker://page/push?rule=XYQ推送&pushurl=' + encodeURIComponent(JSON.stringify({\\n                            \\\"name\\\": fname,\\n                            \\\"refresh_token\\\": reftoken,\\n                            \\\"url\\\": fname.replace(/\\\\#/g, '_').replace(/\\\\$/g, '_') + '$' + cate + '|' + input,\\n                            \\\"share_id\\\": shareId\\n                        }));\\n                    } else {\\n                        eval(dongtai);\\n                        return play\\n                    }\\n                }, shareId, dongtai, cate, fname, reftoken,zimu),\\n                desc: formatDate(conts[i].updated_at) + '  ' + formatSize(conts[i].size),\\n                extra: {\\n                    longClick: [{\\n                        title: '推送到TVBox',\\n                        js: $.toString((shareId, fileid, cate, fname, reftoken) => {\\n                            return 'hiker://page/push?rule=XYQ推送&pushurl=' + encodeURIComponent(JSON.stringify({\\n                                \\\"name\\\": fname,\\n                                \\\"refresh_token\\\": reftoken,\\n                                \\\"url\\\": fname.replace(/\\\\#/g, '_').replace(/\\\\$/g, '_') + '$' + cate + '|' + fileid,\\n                                \\\"share_id\\\": shareId\\n                            }));\\n                        }, shareId, conts[i].file_id, cate, fname, reftoken)\\n                    }],\\n                    id: conts[i].file_id\\n                },\\n                col_type: 'text_1'\\n\\n            });\\n            //}\\n        } else {\\n            items.push({\\n                title: '📂' + conts[i].name,\\n                url: $('hiker://empty' + conts[i].file_id + '???fypage').rule((shareId, sharetoken, pushname) => {\\n                    eval(JSON.parse(fetch('hiker://page/ruleloop', {})).rule);\\n                }, shareId, sharetoken, conts[i].name),\\n                col_type: 'flex_button'\\n            });\\n\\n        } //end if\\n\\n\\n    }\\n    eval(JSON.parse(fetch('hiker://page/pushcode', {})).rule);\\n}\\nsetHomeResult({\\n    data: items\\n});\"},{\"col_type\":\"movie_3\",\"name\":\"分享资源动态解析\",\"path\":\"lazyurl\",\"rule\":\"var defdriveid = getMyVar('defdriveid', ''),\\n    reaccessTk = getMyVar(\\\"aliaccessTk\\\", ''),\\n    timeToken = getMyVar('timeToken', '0'),\\n    stToken = getMyVar('stToken', '0'),\\n    shareiid = getMyVar('shareiid', shareId),\\n    sharetoken = getItem('sharetoken', ''),\\n    resdriveid = getMyVar('resdriveid', ''),\\n    ftype = fname.toLowerCase();\\n//log((parseInt(timeToken) - parseInt(new Date().getTime() / 1000)).toString());\\nfunction accessTk() {\\n    if (reaccessTk == '' || (parseInt(timeToken) - parseInt(new Date().getTime() / 1000)).toString() <= 3600) {\\n        log('刷新reaccessTk');\\n        let ntoken = JSON.parse(fetch('hiker://files/rules/icy/icy-ali-token.json', {}));\\n        var reftoken = ntoken[0].refresh_token;\\n        let refresh = fetch('https://auth.aliyundrive.com/v2/account/token', {\\n            headers: {\\n                'User-Agent': PC_UA,\\n                'Content-Type': 'application/json',\\n                'Referer': 'https://www.aliyundrive.com/'\\n            },\\n            body: '{\\\"refresh_token\\\":\\\"' + reftoken + '\\\",\\\"grant_type\\\":\\\"refresh_token\\\"}',\\n            method: 'POST'\\n        });\\n        ntoken[0] = JSON.parse(refresh);\\n        if (!fileExist(\\\"hiker://files/rules/icy/icy-ali-token.json\\\") || refresh.length > 300) {\\n            writeFile(\\\"hiker://files/rules/icy/icy-ali-token.json\\\", JSON.stringify(ntoken));\\n        }\\n        putMyVar('timeToken', (parseInt(JSON.parse(refresh).expires_in) + parseInt(new Date().getTime() / 1000)).toString());\\n        defdriveid = JSON.parse(refresh).default_drive_id;\\n        putMyVar('defdriveid', defdriveid);\\n        reaccessTk = JSON.parse(refresh).token_type + ' ' + JSON.parse(refresh).access_token;\\n        putMyVar(\\\"aliaccessTk\\\", reaccessTk);\\n\\n    }\\n};\\n\\nfunction resourceID() {\\n    let userresinfo = JSON.parse(fetch(\\\"https://user.aliyundrive.com/v2/user/get\\\", {\\n        headers: {\\n            'content-type': 'application/json',\\n            'User-Agent': PC_UA,\\n            \\\"authorization\\\": reaccessTk,\\n            'Referer': 'https://www.aliyundrive.com/'\\n        },\\n        body: {},\\n        method: 'POST'\\n    }));\\n    if (userresinfo.resource_drive_id) {\\n        resdriveid = userresinfo.resource_drive_id;\\n        putMyVar('resdriveid', resdriveid);\\n    }\\n}\\n\\naccessTk();\\nresourceID();\\n//刷新sharetoken\\nif (shareiid != shareId || (parseInt(stToken) - parseInt(new Date().getTime() / 1000)).toString() <= 3600) {\\n    var sharetk = fetch('https://api.aliyundrive.com/v2/share_link/get_share_token', {\\n        headers: {\\n            'User-Agent': PC_UA,\\n            'Content-Type': 'application/json'\\n        },\\n        body: '{\\\"share_pwd\\\":\\\"\\\",\\\"share_id\\\":\\\"' + shareId + '\\\"}',\\n        method: 'POST'\\n    });\\n    log('刷新sharetoken');\\n    sharetoken = JSON.parse(sharetk).share_token;\\n    setItem('sharetoken', JSON.parse(sharetk).share_token);\\n    putMyVar('stToken', (parseInt(JSON.parse(sharetk).expires_in) + parseInt(new Date().getTime() / 1000)).toString());\\n    putMyVar('shareiid', shareId);\\n}\\n//log(zimu);\\nconst transcoding = {\\n    UHD: \\\"4K 超清\\\",\\n    QHD: \\\"2K 超清\\\",\\n    FHD: \\\"1080 全高清\\\",\\n    HD: \\\"720 高清\\\",\\n    SD: \\\"540 标清\\\",\\n    LD: \\\"360 流畅\\\"\\n};\\nif (!fileExist(\\\"hiker://files/rules/icy/icy-ali-OpenToken.json\\\")) {\\n    var OpenToken = {\\n        'RefreshTokenOpen': '',\\n        'AccessTokenOpen': ''\\n    };\\n} else {\\n    var OpenToken = JSON.parse(fetch('hiker://files/rules/icy/icy-ali-OpenToken.json', {}));\\n}\\n//var reftoken = JSON.parse(fetch('hiker://files/rules/icy/icy-ali-token.json', {}))[0].refresh_token;\\nfunction getsub(zmfid, zmext) {\\n    try {\\n        var json = fetch('https://api.aliyundrive.com/v2/file/get_share_link_download_url', {\\n            headers: {\\n                'Content-Type': 'application/json',\\n                'Authorization': reaccessTk,\\n                'X-Share-Token': sharetoken\\n            },\\n            body: '{\\\"share_id\\\":\\\"' + shareId + '\\\",\\\"file_id\\\":\\\"' + zmfid + '\\\"}',\\n            method: 'POST'\\n        });\\n        //log(json);\\n        let zimul = JSON.parse(json).download_url;\\n        downloadFile(zimul, 'hiker://files/download/subtitling.' + zmext, {\\n            'Referer': 'https://www.aliyundrive.com/'\\n        });\\n        return getPath('hiker://files/download/subtitling.' + zmext)\\n        //return zimul\\n    } catch (e) {\\n        return \\\"\\\";\\n    }\\n}\\n\\nfunction aliSharePlayUrl(share_id, file_id, alitoken) {\\n    try {\\n        function getNowTime() {\\n            const yy = new Date().getFullYear()\\n            const MM = (new Date().getMonth() + 1) < 10 ? '0' + (new Date().getMonth() + 1) : (new Date().getMonth() + 1)\\n            const dd = new Date().getDate() < 10 ? '0' + new Date().getDate() : new Date().getDate()\\n            const HH = new Date().getHours() < 10 ? '0' + new Date().getHours() : new Date().getHours()\\n            const mm = new Date().getMinutes() < 10 ? '0' + new Date().getMinutes() : new Date().getMinutes()\\n            return yy + '' + dd + '' + HH + '' + MM + '' + mm\\n        }\\n\\n        let sharetoken = JSON.parse(request('https://api.aliyundrive.com/v2/share_link/get_share_token', {\\n            body: {\\n                \\\"share_pwd\\\": \\\"\\\",\\n                \\\"share_id\\\": share_id\\n            },\\n            method: 'POST',\\n            timeout: 3000\\n        })).share_token;\\n\\n        let headers = {\\n            'content-type': 'application/json;charset=UTF-8',\\n            \\\"origin\\\": \\\"https://www.aliyundrive.com\\\",\\n            \\\"referer\\\": \\\"https://www.aliyundrive.com/\\\",\\n            //\\\"user-agent\\\": \\\"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/110.0.0.0 Safari/537.36\\\",\\n            \\\"user-agent\\\": PC_UA,\\n            \\\"x-canary\\\": \\\"client=web,app=adrive,version=v3.1.0\\\"\\n        };\\n        let nowtime = Date.now();\\n        let oldtime = parseInt(getMyVar('userinfoChecktime', '0').replace('time', ''));\\n        let userinfo;\\n        let aliuserinfo = storage0.getMyVar('aliuserinfo');\\n        if (aliuserinfo && aliuserinfo.user_id && nowtime < (oldtime + 1 * 60 * 60 * 1000)) {\\n            userinfo = aliuserinfo;\\n        } else {\\n            userinfo = JSON.parse(request('https://auth.aliyundrive.com/v2/account/token', {\\n                headers: headers,\\n                body: {\\n                    \\\"refresh_token\\\": alitoken,\\n                    \\\"grant_type\\\": \\\"refresh_token\\\"\\n                },\\n                method: 'POST',\\n                timeout: 3000\\n            }));\\n            storage0.putMyVar('aliuserinfo', userinfo);\\n            putMyVar('userinfoChecktime', nowtime + 'time');\\n        }\\n        let authorization = 'Bearer ' + userinfo.access_token;\\n        let deviceId = userinfo.device_id;\\n        let userId = userinfo.user_id;\\n        let signature;\\n\\n        let as = justTestSign(\\\"5dde4e1bdf9e4966b387ba58f4b3fdc3\\\", deviceId, userId);\\n        //log(a);\\n        let bp = as.split(\\\"##\\\");\\n        var sign = bp[0];\\n        var pubKey = bp[bp.length - 1];\\n\\n        let i = 0;\\n        do {\\n\\n            let sess = fetch('https://api.aliyundrive.com/users/v1/users/device/create_session', {\\n                headers: {\\n                    'Content-Type': 'application/json',\\n                    'User-Agent': PC_UA,\\n                    'Referer': 'https://www.aliyundrive.com/',\\n                    'Authorization': authorization,\\n                    'X-Share-Token': sharetoken,\\n                    'x-device-id': deviceId,\\n                    'x-signature': sign\\n                },\\n                body: '{\\\"deviceName\\\":\\\"Chrome浏览器\\\",\\\"modelName\\\":\\\"Windows网页版\\\",\\\"nonce\\\":0,\\\"pubKey\\\":\\\"' + pubKey + '\\\",\\\"refreshToken\\\":\\\"' + alitoken + '\\\"}',\\n                method: 'POST'\\n            });\\n            if (sess.includes('success')) {\\n                break;\\n            }\\n            log('create_session ' + sess);\\n            as = justTestSign(\\\"5dde4e1bdf9e4966b387ba58f4b3fdc3\\\", deviceId, userId);\\n            //log(a);\\n            bp = as.split(\\\"##\\\");\\n            sign = bp[0];\\n            pubKey = bp[bp.length - 1];\\n            i++;\\n        } while (i < 5);\\n\\n        signature = sign;\\n        headers['authorization'] = authorization;\\n        headers['x-device-id'] = deviceId;\\n        headers['x-signature'] = signature;\\n        let aliyunUrl = [];\\n        headers['x-share-token'] = sharetoken;\\n        headers['fileid'] = userId;\\n        let data = {\\n            \\\"category\\\": \\\"live_transcoding\\\",\\n            \\\"file_id\\\": file_id,\\n            \\\"get_preview_url\\\": true,\\n            \\\"share_id\\\": share_id,\\n            \\\"template_id\\\": \\\"\\\",\\n            \\\"get_subtitle_info\\\": true\\n        }\\n        //log(data);\\n        let json = JSON.parse(request('https://api.aliyundrive.com/v2/file/get_share_link_video_preview_play_info', {\\n            headers: headers,\\n            body: data,\\n            method: 'POST',\\n            timeout: 3000\\n        }));\\n        aliyunUrl = json.video_preview_play_info.live_transcoding_task_list;\\n        aliyunUrl.reverse();\\n\\n        return aliyunUrl;\\n    } catch (e) {\\n        log('根据共享链接获取播放地址失败>' + e.message);\\n        return \\\"\\\";\\n    }\\n}\\n\\nfunction getAliUrl(share_id, file_id, alitoken) {\\n    try {\\n        let urls = [];\\n        let names = [];\\n        let heads = [];\\n        let u = startProxyServer($.toString((aliSharePlayUrl, file_id, share_id, alitoken) => {\\n            function geturl(fileid, line) {\\n                //预加载时会变file_id,所以ts过期更新时还取原来的id\\n                let playUrlList = aliSharePlayUrl(share_id, fileid, alitoken) || [];\\n                let aliurl;\\n                playUrlList.forEach((item) => {\\n                    if (item.template_id == line) {\\n                        aliurl = item.url;\\n                        /*aliurl = JSON.parse(request(item.url, {\\n                            headers: {\\n                                'User-Agent': PC_UA,\\n                                'Referer': 'https://www.aliyundrive.com/'\\n                            },\\n                            onlyHeaders: true,\\n                            redirect: false,\\n                            timeout: 3000\\n                        })).headers.location[0];*/\\n                    }\\n                })\\n                //上面是获取阿里的播放地址\\n                //log(\\\"我在代理\\\" + aliurl);\\n                let home = aliurl.split('media.m3u8')[0];\\n                let f = fetch(aliurl, {\\n                    headers: {\\n                        'User-Agent': PC_UA,\\n                        'Referer': 'https://www.aliyundrive.com/'\\n                    },\\n                    timeout: 3000\\n                }).split(\\\"\\\\n\\\");\\n                let ff = f.map(it => {\\n                    if (it.startsWith(\\\"media-\\\")) {\\n                        return \\\"/proxy?url=\\\" + base64Encode(home + it);\\n                    }\\n                    return it;\\n                }).join(\\\"\\\\n\\\");\\n                //log('ufid-'+fileid);\\n                writeFile('hiker://files/cache/_fileSelect_' + fileid + '.m3u8', ff);\\n                return ff;\\n            }\\n            let url = base64Decode(MY_PARAMS.url);\\n            if (url.includes(\\\".ts\\\")) {\\n                let fid = url.split('&f=')[1].split('&')[0];\\n                //log('sfid-'+fid);\\n                let f = fetch('hiker://files/cache/_fileSelect_' + fid + '.m3u8').split(\\\"\\\\n\\\");\\n                f.forEach(it => {\\n                    if (it && it.startsWith('/proxy?url=')) {\\n                        let furl = base64Decode(it.replace('/proxy?url=', ''));\\n                        if (url.substr(url.indexOf('/media-'), url.indexOf('.ts')) == furl.substr(furl.indexOf('/media-'), furl.indexOf('.ts'))) {\\n                            url = furl;\\n                        }\\n                    }\\n                })\\n                let expires = url.split('x-oss-expires=')[1].split('&')[0];\\n                const lasttime = parseInt(expires) - Date.now() / 1000;\\n                if (lasttime < 60) {\\n                    //log('过期更新')\\n                    let line = url.split('/media')[0]; //取之前播放的ts段线路\\n                    line = line.substring(line.lastIndexOf('/') + 1);\\n                    let f = geturl(fid, line).split(\\\"\\\\n\\\");\\n                    f.forEach(it => {\\n                        if (it && it.startsWith('/proxy?url=')) {\\n                            let furl = base64Decode(it.replace('/proxy?url=', ''));\\n                            if (url.substr(url.indexOf('/media-'), url.indexOf('.ts')) == furl.substr(furl.indexOf('/media-'), furl.indexOf('.ts'))) {\\n                                url = furl;\\n                            }\\n                        }\\n                    })\\n\\n                } else {\\n                    //log('未过期')\\n                    //log(\\\"代理ts：\\\" + url);\\n                }\\n                return JSON.stringify({\\n                    statusCode: 302,\\n                    headers: {\\n                        \\\"Location\\\": url,\\n                        \\\"User-Agent\\\": PC_UA,\\n                        'Referer': 'https://www.aliyundrive.com/'\\n                    }\\n                });\\n            } else {\\n                //log('首次更新')\\n                let line = url.split('|')[1];\\n                let ff = geturl(file_id, line);\\n                return ff;\\n            }\\n        }, aliSharePlayUrl, file_id, share_id, alitoken));\\n\\n        let playUrlList = aliSharePlayUrl(share_id, file_id, alitoken) || [];\\n\\n        if (playUrlList.length > 0) {\\n            playUrlList.forEach((item) => {\\n                urls.push(u + \\\"?url=\\\" + base64Encode(item.url + \\\"|\\\" + item.template_id) + \\\"#.m3u8\\\");\\n                names.push(transcoding[item.template_id] ? transcoding[item.template_id] : item.template_height);\\n                heads.push({\\n                    'User-Agent': PC_UA,\\n                    'Referer': 'https://www.aliyundrive.com/'\\n                });\\n            })\\n            var mult = {\\n                urls: urls,\\n                names: names,\\n                headers: heads\\n            };\\n            if (zimu.length > 0) {\\n                for (let i in zimu) {\\n                    var zimut = zimu[i].tit;\\n                    if (fname.includes(zimut) || zimut.includes(fname.substring(0, fname.lastIndexOf('.')))) {\\n                        mult['subtitle'] = getsub(zimu[i].fid, zimu[i].ext);\\n                        break;\\n                    }\\n                }\\n            }\\n\\n            return mult;\\n        } else {\\n            log('未获取阿里播放地址，建议重进软件再试一次')\\n            return {};\\n        }\\n    } catch (e) {\\n        log('获取共享链接播放地址失败>' + e.message);\\n        return {};\\n    }\\n}\\n\\nif (cate == 'video') {\\n    //log(reaccessTk); \\n    if (getItem('quality', '') == '1') {\\n        //原画\\n        //accessTk();\\n\\n        function oauthRedirect(code) {\\n            //log(code);\\n            try {\\n                if (getMyVar('ored', '1') != '0') {\\n                    let json = fetch('https://api.xhofe.top/alist/ali_open/code', {\\n                        headers: {\\n                            'User-Agent': PC_UA,\\n                            'Referer': 'https://www.aliyundrive.com/'\\n\\n                        },\\n                        body: {\\n                            \\\"code\\\": code,\\n                            \\\"grant_type\\\": \\\"authorization_code\\\"\\n                        },\\n                        method: 'POST'\\n                    });\\n                    if (json == \\\"\\\" || !JSON.parse(json)) {\\n                        json = fetch('https://api-cf.nn.ci/alist/ali_open/code', {\\n                            headers: {\\n                                'User-Agent': PC_UA,\\n                                'Referer': 'https://www.aliyundrive.com/'\\n\\n                            },\\n                            body: {\\n                                \\\"code\\\": code,\\n                                \\\"grant_type\\\": \\\"authorization_code\\\"\\n                            },\\n                            method: 'POST'\\n                        });\\n                    }\\n                    log('获取RefreshTokenOpen');\\n                    if (json.includes('Too Many Requests')) {\\n                        putMyVar('ored', '0');\\n                        toast('请求太频繁，被封限制了');\\n                        //log('请求太频繁，被封IP了');\\n                        return '';\\n                    } else {\\n                        putMyVar('ored', '1');\\n                        if (JSON.parse(json).refresh_token) {\\n                            let getRefreshTokenOpen = JSON.parse(json).refresh_token;\\n                            OpenToken.RefreshTokenOpen = getRefreshTokenOpen;\\n                            let getAccessTokenOpen = JSON.parse(json).token_type + ' ' + JSON.parse(json).access_token;\\n                            OpenToken.AccessTokenOpen = getAccessTokenOpen;\\n                            writeFile(\\\"hiker://files/rules/icy/icy-ali-OpenToken.json\\\", JSON.stringify(OpenToken));\\n                            putMyVar('redirect', '1');\\n                        }\\n                    }\\n                }\\n            } catch (e) {}\\n        };\\n\\n        function oauthRequest() {\\n            try {\\n                let json = fetch('https://open.aliyundrive.com/oauth/users/authorize?client_id=' + '76917ccccd4441c39457a04f6084fb2f' + '&redirect_uri=https://alist.nn.ci/tool/aliyundrive/callback&scope=user:base,file:all:read,file:all:write&state=', {\\n                    headers: {\\n                        'User-Agent': PC_UA,\\n                        'Referer': 'https://www.aliyundrive.com/',\\n                        'authorization': reaccessTk, //getAccessToken\\n                        'x-canary': 'client=web,app=share,version=v2.3.1',\\n                        'x-share-token': sharetoken\\n\\n                    },\\n                    body: {\\n                        \\\"authorize\\\": 1,\\n                        \\\"scope\\\": \\\"user:base,file:all:read,file:all:write\\\"\\n                    },\\n                    method: 'POST'\\n                });\\n                //log('oauthreq\\\\n' + json);\\n                if (json.includes('AccessTokenExpired')) {\\n                    reaccessTk = '';\\n                    accessTok();\\n                }\\n                let code = JSON.parse(json).redirectUri.split(\\\"code=\\\")[1];\\n                //log(code);\\n                oauthRedirect(code);\\n            } catch (e) {\\n                reaccessTk = '';\\n                accessTk();\\n            }\\n        };\\n\\n        function refreshOpenToken() {\\n            try {\\n                if (getMyVar('rot', '1') != '0') {\\n                    let json = fetch('https://api.xhofe.top/alist/ali_open/token', {\\n                        headers: {\\n                            'User-Agent': PC_UA,\\n                            'Referer': 'https://www.aliyundrive.com/'\\n                        },\\n                        body: {\\n                            'grant_type': 'refresh_token',\\n                            'refresh_token': OpenToken.RefreshTokenOpen\\n                        },\\n                        method: 'POST'\\n                    });\\n                    if (json == \\\"\\\" || !JSON.parse(json)) {\\n                        json = fetch('https://api-cf.nn.ci/alist/ali_open/code', {\\n                            headers: {\\n                                'User-Agent': PC_UA,\\n                                'Referer': 'https://www.aliyundrive.com/'\\n                            },\\n                            body: {\\n                                'grant_type': 'refresh_token',\\n                                'refresh_token': OpenToken.RefreshTokenOpen\\n                            },\\n                            method: 'POST'\\n                        });\\n                    }\\n                    log('获取AccessTokenOpen');\\n                    if (json.includes('Too Many Requests')) {\\n                        putMyVar('rot', '0');\\n                        toast('请求太频繁，被封限制了');\\n                        //log('请求太频繁，被封IP了');\\n                        return '';\\n                    } else {\\n                        putMyVar('rot', '1');\\n                        if (JSON.parse(json).refresh_token) {\\n                            let getRefreshTokenOpen = JSON.parse(json).refresh_token;\\n                            OpenToken.RefreshTokenOpen = getRefreshTokenOpen;\\n                            let getAccessTokenOpen = JSON.parse(json).token_type + ' ' + JSON.parse(json).access_token;\\n                            OpenToken.AccessTokenOpen = getAccessTokenOpen;\\n                            writeFile(\\\"hiker://files/rules/icy/icy-ali-OpenToken.json\\\", JSON.stringify(OpenToken));\\n                        }\\n                    }\\n                }\\n            } catch (e) {}\\n        };\\n\\n        function copy(fileId) {\\n            try {\\n                let json = fetch('https://api.aliyundrive.com/adrive/v2/batch', {\\n                    headers: {\\n                        'User-Agent': PC_UA,\\n                        'Referer': 'https://www.aliyundrive.com/',\\n                        'authorization': reaccessTk,\\n                        //getAccessToken\\n                        'x-canary': 'client=web,app=share,version=v2.3.1',\\n                        'x-share-token': sharetoken\\n\\n                    },\\n                    body: {\\n                        \\\"requests\\\": [{\\n                            \\\"body\\\": {\\n                                \\\"file_id\\\": fileId,\\n                                \\\"share_id\\\": shareId,\\n                                \\\"auto_rename\\\": true,\\n                                \\\"to_parent_file_id\\\": \\\"root\\\",\\n                                \\\"to_drive_id\\\": defdriveid\\n                            },\\n                            \\\"headers\\\": {\\n                                \\\"Content-Type\\\": \\\"application/json\\\"\\n                            },\\n                            \\\"id\\\": \\\"0\\\",\\n                            \\\"method\\\": \\\"POST\\\",\\n                            \\\"url\\\": \\\"/file/copy\\\"\\n                        }],\\n                        \\\"resource\\\": \\\"file\\\"\\n                    },\\n                    method: 'POST'\\n                });\\n                //log('copy\\\\n' + json);\\n                if (json.includes('AccessTokenExpired')) {\\n                    reaccessTk = '';\\n                    accessTok();\\n                }\\n                return JSON.parse(json).responses[0].body.file_id;\\n            } catch (e) {\\n                return \\\"\\\";\\n            }\\n        };\\n\\n        function open(fileId) {\\n            try {\\n                let json = \\\"\\\";\\n                let number = 0;\\n                do {\\n                    json = fetch('https://open.aliyundrive.com/adrive/v1.0/openFile/getDownloadUrl', {\\n                        headers: {\\n                            'User-Agent': PC_UA,\\n                            'Referer': 'https://www.aliyundrive.com/',\\n                            'authorization': OpenToken.AccessTokenOpen\\n                            //getAccessTokenOpen\\n\\n                        },\\n                        body: {\\n                            'file_id': fileId,\\n                            'drive_id': defdriveid\\n                        },\\n                        method: 'POST'\\n                    });\\n                    //log('open\\\\n' + json);\\n                    if (json.includes('\\\"url\\\":\\\"http')) {\\n                        break;\\n                    }\\n                    if (json.includes(\\\"TooManyRequests\\\")) {\\n                        //deletee(fileId);\\n                        toast('Too Many Requests');\\n                    }\\n                    if (getMyVar('redirect', '0') == '0') {\\n                        oauthRequest();\\n                    } else {\\n                        refreshOpenToken();\\n                    }\\n                    number++\\n                } while (number < 2);\\n                //deletee(fileId);\\n                if (json.includes('http')) {\\n                    return JSON.parse(json).url + '#isVideo=true#;{Referer@https://www.aliyundrive.com/}';\\n                } else {\\n                    log(json);\\n                    return \\\"hiker://empty\\\";\\n                }\\n            } catch (e) {\\n                return \\\"hiker://empty\\\";\\n            }\\n        };\\n\\n        function deletee(fileId) {\\n\\n            fetch('https://api.aliyundrive.com/adrive/v2/batch', {\\n                headers: {\\n                    'User-Agent': PC_UA,\\n                    'Referer': 'https://www.aliyundrive.com/',\\n                    'authorization': reaccessTk,\\n                    'x-canary': 'client=web,app=share,version=v2.3.1',\\n                    'x-share-token': sharetoken\\n\\n                },\\n                body: {\\n                    \\\"requests\\\": [{\\n                        \\\"body\\\": {\\n                            \\\"drive_id\\\": defdriveid,\\n                            \\\"file_id\\\": fileId\\n                        },\\n                        \\\"headers\\\": {\\n                            \\\"Content-Type\\\": \\\"application/json\\\"\\n                        },\\n                        \\\"id\\\": fileId,\\n                        \\\"method\\\": \\\"POST\\\",\\n                        \\\"url\\\": \\\"/file/delete\\\"\\n                    }],\\n                    \\\"resource\\\": \\\"file\\\"\\n                },\\n                method: 'POST'\\n            });\\n            //log('删除 ' + del);\\n            /*\\n            fetch('https://open.aliyundrive.com/adrive/v1.0/openFile/delete', {\\n                headers: {\\n                    'User-Agent': PC_UA,\\n                    'Referer': 'https://www.aliyundrive.com/',\\n                    'authorization': getItem('getAccessTokenOpen', ''),\\n                    'x-share-token': sharetoken\\n\\n\\n                },\\n                body: {\\n                    \\\"drive_id\\\": defdriveid,\\n                    \\\"file_id\\\": fileId\\n                },\\n                method: 'POST'\\n            });\\n            */\\n            //log('dele\\\\n' + json);\\n        };\\n\\n        //处理视频  \\n        var dsid = shareId;\\n        var dfid = input;\\n        if (resdriveid != null && resdriveid != \\\"\\\") {\\n            defdriveid = resdriveid;\\n        }\\n        let fileId = copy(dfid);\\n        var play = open(fileId);\\n        if (fileId.length > 0) {\\n            deletee(fileId);\\n        }\\n        if (zimu.length > 0) {\\n            for (let i in zimu) {\\n                var zimut = zimu[i].tit;\\n                if (fname.includes(zimut) || zimut.includes(fname.substring(0, fname.lastIndexOf('.')))) {\\n                    play = JSON.stringify({\\n                        urls: [play.split(';{')[0]],\\n                        headers: [{\\n                            'Referer': 'https://www.aliyundrive.com/'\\n                        }],\\n                        subtitle: getsub(zimu[i].fid, zimu[i].ext)\\n                    })\\n                    break;\\n                }\\n            }\\n        }\\n    } else {\\n        //普画  \\n        var dsid = shareId;\\n        var dfid = input;\\n\\n        if (cate == 'video') {\\n            var play = JSON.stringify(getAliUrl(\\n                shareId,\\n                input,\\n                reftoken\\n            ));\\n        }\\n    }\\n} else if (cate == 'image') {\\n    //处理文档\\n    //accessTk();\\n\\n    var json = fetch('https://api.aliyundrive.com/v2/file/get_share_link_download_url', {\\n        headers: {\\n            'Content-Type': 'application/json',\\n            'Authorization': reaccessTk,\\n            'X-Share-Token': sharetoken\\n        },\\n        body: '{\\\"share_id\\\":\\\"' + shareId + '\\\",\\\"expire_sec\\\": 600,\\\"file_id\\\":\\\"' + input + '\\\"}',\\n        method: 'POST'\\n    });\\n\\n    //log(json);\\n    /*\\n        var loclink = JSON.parse(fetch(JSON.parse(json).download_url, {\\n            headers: {\\n                'User-Agent': MOBILE_UA,\\n                'Content-Type': 'application/x-www-form-urlencoded',\\n                'Referer': 'https://www.aliyundrive.com/'\\n            },\\n            redirect: false,\\n            withStatusCode: true\\n        })).headers.location[0];\\n        */\\n    var loclink = JSON.parse(json).download_url;\\n    //log(loclink);\\n    if (cate == 'image') {\\n        var play = 'pics://' + loclink + '@Referer=https://www.aliyundrive.com/';\\n    } else {\\n        var play = loclink + ';{Referer@https://www.aliyundrive.com/}';\\n    }\\n} else if (cate == 'audio') {\\n    var json = fetch('https://api.aliyundrive.com/v2/file/get_share_link_download_url', {\\n        headers: {\\n            'Content-Type': 'application/json',\\n            'Authorization': reaccessTk,\\n            'X-Share-Token': sharetoken\\n        },\\n        body: '{\\\"share_id\\\":\\\"' + shareId + '\\\",\\\"get_audio_play_info\\\": true,\\\"file_id\\\":\\\"' + input + '\\\"}',\\n        method: 'POST'\\n    });\\n    //log(json);\\n    var play = JSON.parse(json).download_url + '#isMusic=true#;{Referer@https://www.aliyundrive.com/}';\\n} else if (ftype.endsWith('.srt') || ftype.endsWith('.vtt') || ftype.endsWith('.ass')) {\\n    var json = fetch('https://api.aliyundrive.com/v2/file/get_share_link_download_url', {\\n        headers: {\\n            'Content-Type': 'application/json',\\n            'Authorization': reaccessTk,\\n            'X-Share-Token': sharetoken\\n        },\\n        body: '{\\\"share_id\\\":\\\"' + shareId + '\\\",\\\"file_id\\\":\\\"' + input + '\\\"}',\\n        method: 'POST'\\n    });\\n    //log(json);\\n    var zimul = JSON.parse(json).download_url;\\n    downloadFile(zimul, 'hiker://files/download/XYQ_subtitling' + fname.substring(fname.lastIndexOf(\\\".\\\")), {\\n        'Referer': 'https://www.aliyundrive.com/'\\n    });\\n    var play = 'toast://字幕文件已下载到hiker://files/download/XYQ_subtitling' + fname.substring(fname.lastIndexOf(\\\".\\\"))\\n    // + ';{Referer@https://www.aliyundrive.com/}';\\n} else {\\n    var play = 'toast://该格式暂未支持，目前只支持视频。'\\n}\"},{\"col_type\":\"movie_3\",\"name\":\"登入账号\",\"path\":\"Login\",\"rule\":\"d.push({\\n    title: \\\"⛅️点我网页登录\\\",\\n    url: $(\\\"hiker://empty###noRecordHistory##noHistory#\\\").rule(() => {\\n        let d = [];\\n        let ntoken = [];\\n        if (fileExist(\\\"hiker://files/rules/icy/icy-ali-token.json\\\")) {\\n            ntoken = JSON.parse(fetch('hiker://files/rules/icy/icy-ali-token.json', {}));\\n        }\\n        let url = 'https://www.aliyundrive.com/sign'\\n        let js = $.toString((ntoken) => {\\n            const tokenFunction = function() {\\n                var stor = \\\"\\\";\\n                if (localStorage.getItem('token') != null) {\\n                    stor = localStorage.getItem(\\\"token\\\");\\n                } else {\\n                    stor = sessionStorage.getItem(\\\"token\\\");\\n                }\\n                var token = JSON.parse(stor);\\n                if (token && token.user_id) {\\n                    let alistfile = \\\"hiker://files/rules/icy/icy-ali-token.json\\\";\\n                    ntoken[0] = token;\\n                    fy_bridge_app.writeFile(alistfile, JSON.stringify(ntoken));\\n                    localStorage.clear();\\n                    alert('TOKEN获取成功，返回后刷新页面！');\\n                    fy_bridge_app.parseLazyRule(`hiker://empty@lazyRule=.js:refreshX5WebView('');`);\\n                    fy_bridge_app.back();\\n                    return;\\n                } else {\\n                    token_timer();\\n                }\\n            }\\n            var token_timer = function() {\\n                setTimeout(tokenFunction, 500)\\n            };\\n            tokenFunction();\\n        }, ntoken)\\n        d.push({\\n            url: url,\\n            col_type: 'x5_webview_single',\\n            desc: '100%&&float',\\n            extra: {\\n                canBack: true,\\n                ua: PC_UA,\\n                js: js\\n            }\\n        })\\n        setResult(d);\\n    }),\\n    col_type: 'text_2'\\n});\\nd.push({\\n    title: \\\"⛅️点我Token登录\\\",\\n    url: $(\\\"\\\", \\\"输入32位阿里Token\\\").input(() => {\\n        let reftoken = input.trim();\\n        let ntoken = [];\\n        if (reftoken.length == 32) {\\n            var refresh = fetch('https://auth.aliyundrive.com/v2/account/token', {\\n                headers: {\\n                    'Content-Type': 'application/json',\\n                    'User-Agent': PC_UA,\\n                    'Referer': 'https://www.aliyundrive.com/'\\n                },\\n                body: '{\\\"refresh_token\\\":\\\"' + reftoken + '\\\",\\\"grant_type\\\":\\\"refresh_token\\\"}',\\n                method: 'POST'\\n            });\\n            //log(refresh);\\n            if (refresh.includes('\\\"refresh_token\\\"')) {\\n                ntoken[0] = JSON.parse(refresh);\\n                writeFile(\\\"hiker://files/rules/icy/icy-ali-token.json\\\", JSON.stringify(ntoken));\\n                refreshPage();\\n                return 'hiker://empty'\\n            }\\n        }\\n        return 'toast://登入失败，可能Token是无效的。'\\n    }),\\n    col_type: 'text_2'\\n});\"}]","proxy":"","icon":""}